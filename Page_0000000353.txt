OBJECT Page 353 Item Availability Lines
{
  OBJECT-PROPERTIES
  {
    Date=25.10.16;
    Time=12:00:00;
    Version List=NAVW110.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Lines;
               RUS=Строки];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table2000000007;
    PageType=ListPart;
    ShowFilter=No;
    OnInit=BEGIN
             SetItemFilter;
           END;

    OnOpenPage=BEGIN
                 RESET;
               END;

    OnFindRecord=BEGIN
                   EXIT(PeriodFormMgt.FindDate(Which,Rec,PeriodType));
                 END;

    OnNextRecord=BEGIN
                   EXIT(PeriodFormMgt.NextDate(Steps,Rec,PeriodType));
                 END;

    OnAfterGetRecord=BEGIN
                       CalcAvailQuantities(
                         Item,GrossRequirement,PlannedOrderRcpt,ScheduledRcpt,
                         PlannedOrderReleases,ProjAvailableBalance,ExpectedInventory,QtyAvailable);
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                CaptionML=[ENU=Period Start;
                           RUS=Начало периода];
                ToolTipML=[ENU=Specifies the first period that item availability is shown for.;
                           RUS=Определяет первый период, для которого показывается наличие товара.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Period Start" }

    { 12  ;2   ;Field     ;
                CaptionML=[ENU=Period Name;
                           RUS=Название периода];
                ToolTipML=[ENU=Specifies the type of period that item availability is shown for.;
                           RUS=Определяет тип периода, для которого показывается наличие товара.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Period Name" }

    { 22  ;2   ;Field     ;
                CaptionML=[ENU=Gross Requirement;
                           RUS=Полная потребность];
                DecimalPlaces=0:5;
                SourceExpr=GrossRequirement;
                OnDrillDown=BEGIN
                              ShowItemAvailLineList(0)
                            END;
                             }

    { 24  ;2   ;Field     ;
                CaptionML=[ENU=Scheduled Receipt;
                           RUS=Запланиров. поступление];
                DecimalPlaces=0:5;
                SourceExpr=ScheduledRcpt;
                OnDrillDown=BEGIN
                              ShowItemAvailLineList(2);
                            END;
                             }

    { 26  ;2   ;Field     ;
                CaptionML=[ENU=Planned Order Receipt;
                           RUS=План. поступл. по произв. заказам];
                DecimalPlaces=0:5;
                SourceExpr=PlannedOrderRcpt;
                OnDrillDown=BEGIN
                              ShowItemAvailLineList(1);
                            END;
                             }

    { 28  ;2   ;Field     ;
                CaptionML=[ENU=Projected Available Balance;
                           RUS=Прогнозное доступное сальдо];
                ToolTipML=[ENU=Specifies the total availability of the item.;
                           RUS=Определяет общее наличие товара.];
                ApplicationArea=#Basic,#Suite;
                DecimalPlaces=0:5;
                SourceExpr=ProjAvailableBalance;
                OnDrillDown=BEGIN
                              ShowItemAvailLineList(4);
                            END;
                             }

    { 14  ;2   ;Field     ;
                CaptionML=[ENU=Inventory;
                           RUS=Запасы];
                DecimalPlaces=0:5;
                SourceExpr=Item.Inventory;
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ItemAvailFormsMgt.ShowItemLedgerEntries(Item,FALSE);
                            END;
                             }

    { 4   ;2   ;Field     ;
                DrillDown=Yes;
                CaptionML=[ENU=Qty. on Purch. Order;
                           RUS=Кол-во в заказах на покупку];
                DecimalPlaces=0:5;
                SourceExpr=Item."Qty. on Purch. Order";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ItemAvailFormsMgt.ShowPurchLines(Item);
                            END;
                             }

    { 6   ;2   ;Field     ;
                DrillDown=Yes;
                CaptionML=[ENU=Qty. on Sales Order;
                           RUS=Кол-во в заказах на продажу];
                DecimalPlaces=0:5;
                SourceExpr=Item."Qty. on Sales Order";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ItemAvailFormsMgt.ShowSalesLines(Item);
                            END;
                             }

    { 36  ;2   ;Field     ;
                CaptionML=[ENU=Qty. on Service Order;
                           RUS=Кол-во в серв. заказах];
                DecimalPlaces=0:5;
                SourceExpr=Item."Qty. on Service Order";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ItemAvailFormsMgt.ShowServLines(Item);
                            END;
                             }

    { 40  ;2   ;Field     ;
                CaptionML=[ENU=Qty. on Job Order;
                           RUS=Кол-во в рабочем заказе];
                DecimalPlaces=0:5;
                SourceExpr=Item."Qty. on Job Order";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ItemAvailFormsMgt.ShowJobPlanningLines(Item);
                            END;
                             }

    { 30  ;2   ;Field     ;
                CaptionML=[ENU=Trans. Ord. Shipment (Qty.);
                           RUS=Остат. кол-во для отгрузки по заказу на перемещ.];
                DecimalPlaces=0:5;
                SourceExpr=Item."Trans. Ord. Shipment (Qty.)";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ItemAvailFormsMgt.ShowTransLines(Item,Item.FIELDNO("Trans. Ord. Shipment (Qty.)"));
                            END;
                             }

    { 32  ;2   ;Field     ;
                CaptionML=[ENU=Qty. in Transit;
                           RUS=Кол-во в пути];
                DecimalPlaces=0:5;
                SourceExpr=Item."Qty. in Transit";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ItemAvailFormsMgt.ShowTransLines(Item,Item.FIELDNO("Qty. in Transit"));
                            END;
                             }

    { 34  ;2   ;Field     ;
                CaptionML=[ENU=Trans. Ord. Receipt (Qty.);
                           RUS=Остат. кол-во для получ. по заказу на перемещ.];
                DecimalPlaces=0:5;
                SourceExpr=Item."Trans. Ord. Receipt (Qty.)";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ItemAvailFormsMgt.ShowTransLines(Item,Item.FIELDNO("Trans. Ord. Receipt (Qty.)"));
                            END;
                             }

    { 3   ;2   ;Field     ;
                CaptionML=[ENU=Qty. on Asm. Comp. Lines;
                           RUS=Кол-во в строках компонентов сборки];
                SourceExpr=Item."Qty. on Asm. Component";
                Visible=false;
                OnDrillDown=VAR
                              ItemAvailFormsMgt@1001 : Codeunit 353;
                            BEGIN
                              ItemAvailFormsMgt.ShowAsmCompLines(Item);
                            END;
                             }

    { 5   ;2   ;Field     ;
                CaptionML=[ENU=Qty. on Assembly Order;
                           RUS=Кол-во в заказе на сборку];
                SourceExpr=Item."Qty. on Assembly Order";
                Visible=False;
                OnDrillDown=VAR
                              ItemAvailFormsMgt@1001 : Codeunit 353;
                            BEGIN
                              ItemAvailFormsMgt.ShowAsmOrders(Item);
                            END;
                             }

    { 8   ;2   ;Field     ;
                CaptionML=[ENU=Expected Inventory;
                           RUS=Ожидаемые запасы];
                DecimalPlaces=0:5;
                SourceExpr=ExpectedInventory;
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                CaptionML=[ENU=Available Inventory;
                           RUS=Доступные запасы];
                DecimalPlaces=0:5;
                SourceExpr=QtyAvailable;
                Visible=FALSE }

    { 16  ;2   ;Field     ;
                DrillDown=Yes;
                CaptionML=[ENU=Scheduled Receipt (Qty.);
                           RUS=Запланир. поступление (кол-во)];
                DecimalPlaces=0:5;
                SourceExpr=Item."Scheduled Receipt (Qty.)";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ItemAvailFormsMgt.ShowSchedReceipt(Item);
                            END;
                             }

    { 18  ;2   ;Field     ;
                DrillDown=Yes;
                CaptionML=[ENU=Scheduled Issue (Qty.);
                           RUS=Плановая выдача (кол-во)];
                DecimalPlaces=0:5;
                SourceExpr=Item."Scheduled Need (Qty.)";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ItemAvailFormsMgt.ShowSchedNeed(Item);
                            END;
                             }

    { 20  ;2   ;Field     ;
                CaptionML=[ENU=Planned Order Releases;
                           RUS=Запланир. в произв. заказах];
                DecimalPlaces=0:5;
                SourceExpr=PlannedOrderReleases;
                Visible=TRUE;
                OnDrillDown=BEGIN
                              ShowItemAvailLineList(3);
                            END;
                             }

    { 38  ;2   ;Field     ;
                DrillDown=Yes;
                CaptionML=[ENU=Net Change;
                           RUS=Оборот];
                DecimalPlaces=0:5;
                SourceExpr=Item."Net Change";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ItemAvailFormsMgt.ShowItemLedgerEntries(Item,TRUE);
                            END;
                             }

  }
  CODE
  {
    VAR
      Item@1000 : Record 27;
      ItemAvailFormsMgt@1001 : Codeunit 353;
      PeriodFormMgt@1006 : Codeunit 359;
      PeriodType@1009 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      AmountType@1010 : 'Net Change,Balance at Date';
      ExpectedInventory@1013 : Decimal;
      QtyAvailable@1014 : Decimal;
      PlannedOrderReleases@1015 : Decimal;
      GrossRequirement@1016 : Decimal;
      PlannedOrderRcpt@1017 : Decimal;
      ScheduledRcpt@1018 : Decimal;
      ProjAvailableBalance@1019 : Decimal;

    PROCEDURE Set@1(VAR NewItem@1000 : Record 27;NewPeriodType@1001 : Integer;NewAmountType@1002 : 'Net Change,Balance at Date');
    BEGIN
      Item.COPY(NewItem);
      PeriodType := NewPeriodType;
      AmountType := NewAmountType;
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE SetItemFilter@4();
    BEGIN
      IF AmountType = AmountType::"Net Change" THEN
        Item.SETRANGE("Date Filter","Period Start","Period End")
      ELSE
        Item.SETRANGE("Date Filter",0D,"Period End");
    END;

    LOCAL PROCEDURE ShowItemAvailLineList@2(What@1000 : Integer);
    BEGIN
      SetItemFilter;
      ItemAvailFormsMgt.ShowItemAvailLineList(Item,What);
    END;

    LOCAL PROCEDURE CalcAvailQuantities@3(VAR Item@1001 : Record 27;VAR GrossRequirement@1002 : Decimal;VAR PlannedOrderRcpt@1003 : Decimal;VAR ScheduledRcpt@1004 : Decimal;VAR PlannedOrderReleases@1005 : Decimal;VAR ProjAvailableBalance@1006 : Decimal;VAR ExpectedInventory@1007 : Decimal;VAR QtyAvailable@1008 : Decimal);
    BEGIN
      SetItemFilter;
      ItemAvailFormsMgt.CalcAvailQuantities(
        Item,AmountType = AmountType::"Balance at Date",
        GrossRequirement,PlannedOrderRcpt,ScheduledRcpt,
        PlannedOrderReleases,ProjAvailableBalance,ExpectedInventory,QtyAvailable);
    END;

    BEGIN
    END.
  }
}

