OBJECT Page 35663 Payroll Analysis by Dim Matrix
{
  OBJECT-PROPERTIES
  {
    Date=25.10.16;
    Time=12:00:00;
    Version List=NAVRU10.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Payroll Analysis by Dim Matrix;
               RUS=Анализ зарплаты по матрице измерений];
    LinksAllowed=No;
    SourceTable=Table367;
    PageType=List;
    OnInit=BEGIN
             Field32Visible := TRUE;
             Field31Visible := TRUE;
             Field30Visible := TRUE;
             Field29Visible := TRUE;
             Field28Visible := TRUE;
             Field27Visible := TRUE;
             Field26Visible := TRUE;
             Field25Visible := TRUE;
             Field24Visible := TRUE;
             Field23Visible := TRUE;
             Field22Visible := TRUE;
             Field21Visible := TRUE;
             Field20Visible := TRUE;
             Field19Visible := TRUE;
             Field18Visible := TRUE;
             Field17Visible := TRUE;
             Field16Visible := TRUE;
             Field15Visible := TRUE;
             Field14Visible := TRUE;
             Field13Visible := TRUE;
             Field12Visible := TRUE;
             Field11Visible := TRUE;
             Field10Visible := TRUE;
             Field9Visible := TRUE;
             Field8Visible := TRUE;
             Field7Visible := TRUE;
             Field6Visible := TRUE;
             Field5Visible := TRUE;
             Field4Visible := TRUE;
             Field3Visible := TRUE;
             Field2Visible := TRUE;
             Field1Visible := TRUE;
           END;

    OnOpenPage=BEGIN
                 ApplyColumnFilter;

                 Field1Visible := 1 <= NoOfRecords;
                 Field2Visible := 2 <= NoOfRecords;
                 Field3Visible := 3 <= NoOfRecords;
                 Field4Visible := 4 <= NoOfRecords;
                 Field5Visible := 5 <= NoOfRecords;
                 Field6Visible := 6 <= NoOfRecords;
                 Field7Visible := 7 <= NoOfRecords;
                 Field8Visible := 8 <= NoOfRecords;
                 Field9Visible := 9 <= NoOfRecords;
                 Field10Visible := 10 <= NoOfRecords;
                 Field11Visible := 11 <= NoOfRecords;
                 Field12Visible := 12 <= NoOfRecords;
                 Field13Visible := 13 <= NoOfRecords;
                 Field14Visible := 14 <= NoOfRecords;
                 Field15Visible := 15 <= NoOfRecords;
                 Field16Visible := 16 <= NoOfRecords;
                 Field17Visible := 17 <= NoOfRecords;
                 Field18Visible := 18 <= NoOfRecords;
                 Field19Visible := 19 <= NoOfRecords;
                 Field20Visible := 20 <= NoOfRecords;
                 Field21Visible := 21 <= NoOfRecords;
                 Field22Visible := 22 <= NoOfRecords;
                 Field23Visible := 23 <= NoOfRecords;
                 Field24Visible := 24 <= NoOfRecords;
                 Field25Visible := 25 <= NoOfRecords;
                 Field26Visible := 26 <= NoOfRecords;
                 Field27Visible := 27 <= NoOfRecords;
                 Field28Visible := 28 <= NoOfRecords;
                 Field29Visible := 29 <= NoOfRecords;
                 Field30Visible := 30 <= NoOfRecords;
                 Field31Visible := 31 <= NoOfRecords;
                 Field32Visible := 32 <= NoOfRecords;

                 GLSetup.GET;
                 NormalFormatString := STRSUBSTNO(Text001,GLSetup."Amount Decimal Places");
               END;

    OnFindRecord=BEGIN
                   EXIT(
                     PayrollAnalysisMgt.FindRec(
                       PayrollAnalysisView,LineDimOption,Rec,Which,
                       ElementFilter,ElementGroupFilter,EmployeeFilter,OrgUnitFilter,
                       PeriodType,DateFilter,PeriodInitialized,InternalDateFilter,
                       Dim1Filter,Dim2Filter,Dim3Filter,Dim4Filter));
                 END;

    OnNextRecord=BEGIN
                   EXIT(
                     PayrollAnalysisMgt.NextRec(
                       PayrollAnalysisView,LineDimOption,Rec,Steps,
                       ElementFilter,ElementGroupFilter,EmployeeFilter,OrgUnitFilter,
                       PeriodType,DateFilter,
                       Dim1Filter,Dim2Filter,Dim3Filter,Dim4Filter));
                 END;

    OnAfterGetRecord=BEGIN
                       Steps := 1;
                       ApplyColumnFilter;
                       Which := '-';

                       PayrollAnalysisMgt.FindRec(
                         PayrollAnalysisView,ColumnDimOption,DimCodeBufferColumn3,Which,
                         ElementFilter1,ElementGroupFilter1,EmployeeFilter1,OrgUnitFilter1,
                         PeriodType,DateFilter1,PeriodInitialized,InternalDateFilter,
                         Dim1Filter1,Dim2Filter1,Dim3Filter1,Dim4Filter1);

                       i := 1;
                       WHILE (i <= NoOfRecords) AND (i <= ARRAYLEN(MatrixColumnCaptions)) DO BEGIN
                         MatrixData[i] := CalcAmt(DimCodeBufferColumn3,ValueType,TRUE);
                         PayrollAnalysisMgt.NextRec(
                           PayrollAnalysisView,ColumnDimOption,DimCodeBufferColumn3,Steps,
                           ElementFilter1,ElementGroupFilter1,EmployeeFilter1,OrgUnitFilter1,
                           PeriodType,DateFilter1,
                           Dim1Filter1,Dim2Filter1,Dim3Filter1,Dim4Filter1);
                         i := i + 1;
                       END;
                       MatrixData1OnFormat(FORMAT(MatrixData[1]));
                       MatrixData2OnFormat(FORMAT(MatrixData[2]));
                       MatrixData3OnFormat(FORMAT(MatrixData[3]));
                       MatrixData4OnFormat(FORMAT(MatrixData[4]));
                       MatrixData5OnFormat(FORMAT(MatrixData[5]));
                       MatrixData6OnFormat(FORMAT(MatrixData[6]));
                       MatrixData7OnFormat(FORMAT(MatrixData[7]));
                       MatrixData8OnFormat(FORMAT(MatrixData[8]));
                       MatrixData9OnFormat(FORMAT(MatrixData[9]));
                       MatrixData10OnFormat(FORMAT(MatrixData[10]));
                       MatrixData11OnFormat(FORMAT(MatrixData[11]));
                       MatrixData12OnFormat(FORMAT(MatrixData[12]));
                       MatrixData13OnFormat(FORMAT(MatrixData[13]));
                       MatrixData14OnFormat(FORMAT(MatrixData[14]));
                       MatrixData15OnFormat(FORMAT(MatrixData[15]));
                       MatrixData16OnFormat(FORMAT(MatrixData[16]));
                       MatrixData17OnFormat(FORMAT(MatrixData[17]));
                       MatrixData18OnFormat(FORMAT(MatrixData[18]));
                       MatrixData19OnFormat(FORMAT(MatrixData[19]));
                       MatrixData20OnFormat(FORMAT(MatrixData[20]));
                       MatrixData21OnFormat(FORMAT(MatrixData[21]));
                       MatrixData22OnFormat(FORMAT(MatrixData[22]));
                       MatrixData23OnFormat(FORMAT(MatrixData[23]));
                       MatrixData24OnFormat(FORMAT(MatrixData[24]));
                       MatrixData25OnFormat(FORMAT(MatrixData[25]));
                       MatrixData26OnFormat(FORMAT(MatrixData[26]));
                       MatrixData27OnFormat(FORMAT(MatrixData[27]));
                       MatrixData28OnFormat(FORMAT(MatrixData[28]));
                       MatrixData29OnFormat(FORMAT(MatrixData[29]));
                       MatrixData30OnFormat(FORMAT(MatrixData[30]));
                       MatrixData31OnFormat(FORMAT(MatrixData[31]));
                       MatrixData32OnFormat(FORMAT(MatrixData[32]));
                     END;

    OnAfterGetCurrRecord=BEGIN
                           Steps := 1;
                           ApplyColumnFilter;
                           Which := '-';

                           PayrollAnalysisMgt.FindRec(
                             PayrollAnalysisView,ColumnDimOption,DimCodeBufferColumn3,Which,
                             ElementFilter1,ElementGroupFilter1,EmployeeFilter1,OrgUnitFilter1,
                             PeriodType,DateFilter1,PeriodInitialized,InternalDateFilter,
                             Dim1Filter1,Dim2Filter1,Dim3Filter1,Dim4Filter1);

                           i := 1;
                           WHILE (i <= NoOfRecords) AND (i <= ARRAYLEN(MatrixColumnCaptions)) DO BEGIN
                             MatrixData[i] := CalcAmt(DimCodeBufferColumn3,ValueType,TRUE);
                             PayrollAnalysisMgt.NextRec(
                               PayrollAnalysisView,ColumnDimOption,DimCodeBufferColumn3,Steps,
                               ElementFilter1,ElementGroupFilter1,EmployeeFilter1,OrgUnitFilter1,
                               PeriodType,DateFilter1,
                               Dim1Filter1,Dim2Filter1,Dim3Filter1,Dim4Filter1);
                             i := i + 1;
                           END;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 77      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Actions;
                                 RUS=&Действия];
                      Image=Action }
      { 79      ;2   ;Action    ;
                      CaptionML=[ENU=Export to Excel;
                                 RUS=Экспорт в Excel];
                      ApplicationArea=#Basic,#Suite;
                      Image=ExportToExcel;
                      OnAction=VAR
                                 PayrollAnalysisViewEntry@1210002 : Record 14966;
                                 PayrollAnalysisViewToExcel@1210001 : Codeunit 14965;
                               BEGIN
                                 PayrollAnalysisViewToExcel.SetCommonFilters(
                                   CurrentPayrollAnalysisViewCode,
                                   PayrollAnalysisViewEntry,
                                   ElementTypeFilter,ElementFilter,ElementGroupFilter,EmployeeFilter,OrgUnitFilter,
                                   DateFilter,Dim1Filter,Dim2Filter,Dim3Filter,Dim4Filter);
                                 PayrollAnalysisViewEntry.FINDFIRST;
                                 PayrollAnalysisViewToExcel.ExportData(
                                   PayrollAnalysisViewEntry,LineDimCode,ColumnDimCode,ValueType,
                                   PeriodType,ShowColumnName,
                                   ElementTypeFilter,ElementFilter,ElementGroupFilter,EmployeeFilter,OrgUnitFilter,
                                   DateFilter,Dim1Filter,Dim2Filter,Dim3Filter,Dim4Filter,ShowOppositeSign);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Name }

    { 13  ;2   ;Field     ;
                Name=Field1;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[1];
                CaptionClass='3,' + MatrixColumnCaptions[1];
                Visible=Field1Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(1);
                            END;
                             }

    { 15  ;2   ;Field     ;
                Name=Field2;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[2];
                CaptionClass='3,' + MatrixColumnCaptions[2];
                Visible=Field2Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(2);
                            END;
                             }

    { 17  ;2   ;Field     ;
                Name=Field3;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[3];
                CaptionClass='3,' + MatrixColumnCaptions[3];
                Visible=Field3Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(3);
                            END;
                             }

    { 25  ;2   ;Field     ;
                Name=Field4;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[4];
                CaptionClass='3,' + MatrixColumnCaptions[4];
                Visible=Field4Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(4);
                            END;
                             }

    { 23  ;2   ;Field     ;
                Name=Field5;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[5];
                CaptionClass='3,' + MatrixColumnCaptions[5];
                Visible=Field5Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(5);
                            END;
                             }

    { 21  ;2   ;Field     ;
                Name=Field6;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[6];
                CaptionClass='3,' + MatrixColumnCaptions[6];
                Visible=Field6Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(6);
                            END;
                             }

    { 19  ;2   ;Field     ;
                Name=Field7;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[7];
                CaptionClass='3,' + MatrixColumnCaptions[7];
                Visible=Field7Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(7);
                            END;
                             }

    { 31  ;2   ;Field     ;
                Name=Field8;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[8];
                CaptionClass='3,' + MatrixColumnCaptions[8];
                Visible=Field8Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(8);
                            END;
                             }

    { 39  ;2   ;Field     ;
                Name=Field9;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[9];
                CaptionClass='3,' + MatrixColumnCaptions[9];
                Visible=Field9Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(9);
                            END;
                             }

    { 41  ;2   ;Field     ;
                Name=Field10;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[10];
                CaptionClass='3,' + MatrixColumnCaptions[10];
                Visible=Field10Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(10);
                            END;
                             }

    { 45  ;2   ;Field     ;
                Name=Field11;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[11];
                CaptionClass='3,' + MatrixColumnCaptions[11];
                Visible=Field11Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(11);
                            END;
                             }

    { 27  ;2   ;Field     ;
                Name=Field12;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[12];
                CaptionClass='3,' + MatrixColumnCaptions[12];
                Visible=Field12Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(12);
                            END;
                             }

    { 29  ;2   ;Field     ;
                Name=Field13;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[13];
                CaptionClass='3,' + MatrixColumnCaptions[13];
                Visible=Field13Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(13);
                            END;
                             }

    { 33  ;2   ;Field     ;
                Name=Field14;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[14];
                CaptionClass='3,' + MatrixColumnCaptions[14];
                Visible=Field14Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(14);
                            END;
                             }

    { 35  ;2   ;Field     ;
                Name=Field15;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[15];
                CaptionClass='3,' + MatrixColumnCaptions[15];
                Visible=Field15Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(15);
                            END;
                             }

    { 37  ;2   ;Field     ;
                Name=Field16;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[16];
                CaptionClass='3,' + MatrixColumnCaptions[16];
                Visible=Field16Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(16);
                            END;
                             }

    { 43  ;2   ;Field     ;
                Name=Field17;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[17];
                CaptionClass='3,' + MatrixColumnCaptions[17];
                Visible=Field17Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(17);
                            END;
                             }

    { 47  ;2   ;Field     ;
                Name=Field18;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[18];
                CaptionClass='3,' + MatrixColumnCaptions[18];
                Visible=Field18Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(18);
                            END;
                             }

    { 49  ;2   ;Field     ;
                Name=Field19;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[19];
                CaptionClass='3,' + MatrixColumnCaptions[19];
                Visible=Field19Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(19);
                            END;
                             }

    { 51  ;2   ;Field     ;
                Name=Field20;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[20];
                CaptionClass='3,' + MatrixColumnCaptions[20];
                Visible=Field20Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(20);
                            END;
                             }

    { 53  ;2   ;Field     ;
                Name=Field21;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[21];
                CaptionClass='3,' + MatrixColumnCaptions[21];
                Visible=Field21Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(21);
                            END;
                             }

    { 55  ;2   ;Field     ;
                Name=Field22;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[22];
                CaptionClass='3,' + MatrixColumnCaptions[22];
                Visible=Field22Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(22);
                            END;
                             }

    { 57  ;2   ;Field     ;
                Name=Field23;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[23];
                CaptionClass='3,' + MatrixColumnCaptions[23];
                Visible=Field23Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(23);
                            END;
                             }

    { 59  ;2   ;Field     ;
                Name=Field24;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[24];
                CaptionClass='3,' + MatrixColumnCaptions[24];
                Visible=Field24Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(24);
                            END;
                             }

    { 61  ;2   ;Field     ;
                Name=Field25;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[25];
                CaptionClass='3,' + MatrixColumnCaptions[25];
                Visible=Field25Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(25);
                            END;
                             }

    { 63  ;2   ;Field     ;
                Name=Field26;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[26];
                CaptionClass='3,' + MatrixColumnCaptions[26];
                Visible=Field26Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(26);
                            END;
                             }

    { 65  ;2   ;Field     ;
                Name=Field27;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[27];
                CaptionClass='3,' + MatrixColumnCaptions[27];
                Visible=Field27Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(27);
                            END;
                             }

    { 67  ;2   ;Field     ;
                Name=Field28;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[28];
                CaptionClass='3,' + MatrixColumnCaptions[28];
                Visible=Field28Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(28);
                            END;
                             }

    { 69  ;2   ;Field     ;
                Name=Field29;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[29];
                CaptionClass='3,' + MatrixColumnCaptions[29];
                Visible=Field29Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(29);
                            END;
                             }

    { 71  ;2   ;Field     ;
                Name=Field30;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[30];
                CaptionClass='3,' + MatrixColumnCaptions[30];
                Visible=Field30Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(30);
                            END;
                             }

    { 73  ;2   ;Field     ;
                Name=Field31;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[31];
                CaptionClass='3,' + MatrixColumnCaptions[31];
                Visible=Field31Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(31);
                            END;
                             }

    { 75  ;2   ;Field     ;
                Name=Field32;
                ApplicationArea=#All;
                BlankZero=Yes;
                SourceExpr=MatrixData[32];
                CaptionClass='3,' + MatrixColumnCaptions[32];
                Visible=Field32Visible;
                OnDrillDown=BEGIN
                              FieldDrillDown(32);
                            END;
                             }

  }
  CODE
  {
    VAR
      PayrollAnalysisView@1011 : Record 14965;
      AVBreakdownBuffer@1013 : TEMPORARY Record 375;
      DimCodeBufferColumn@1014 : Record 367;
      DimCodeBufferColumn3@1034 : Record 367;
      PayrollStatisticsBuffer@1019 : Record 14969;
      GLSetup@1029 : Record 98;
      PayrollAnalysisMgt@1012 : Codeunit 14964;
      RoundingFactor@1033 : 'None,1,1000,1000000';
      ValueType@1003 : 'Payroll Amount,Taxable Amount';
      LineDimOption@1002 : 'Element,Element Group,Employee,Org. Unit,Period,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      ColumnDimOption@1001 : 'Element,Element Group,Employee,Org. Unit,Period,Dimension 1,Dimension 2,Dimension 3,Dimension 4';
      LineDimCode@1036 : Text[30];
      ColumnDimCode@1035 : Text[30];
      PeriodType@1008 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      UsePFAccumSystemFilter@1210012 : ' ,Yes,No';
      CurrentPayrollAnalysisViewCode@1017 : Code[10];
      ElementTypeFilter@1210004 : Text;
      ElementFilter@1210003 : Text;
      ElementGroupFilter@1210002 : Text;
      EmployeeFilter@1210001 : Text;
      OrgUnitFilter@1210000 : Text;
      Dim1Filter@1007 : Text;
      Dim2Filter@1006 : Text;
      Dim3Filter@1005 : Text;
      Dim4Filter@1210005 : Text;
      DateFilter@1004 : Text;
      MatrixColumnCaptions@1024 : ARRAY [32] OF Text[1024];
      InternalDateFilter@1025 : Text;
      Which@1026 : Text[1024];
      NormalFormatString@1030 : Text[80];
      ShowOppositeSign@1020 : Boolean;
      PeriodInitialized@1021 : Boolean;
      i@1022 : Integer;
      Steps@1023 : Integer;
      NoOfRecords@1028 : Integer;
      MatrixData@1000 : ARRAY [32] OF Decimal;
      Text001@1032 : TextConst 'ENU=<Precision,%1><Standard Format,0>;RUS=<Precision,%1><Standard Format,0>';
      ElementTypeFilter1@1210011 : Text;
      ElementFilter1@1210010 : Text;
      ElementGroupFilter1@1210009 : Text;
      EmployeeFilter1@1210008 : Text;
      OrgUnitFilter1@1210007 : Text;
      Dim1Filter1@1041 : Text;
      Dim2Filter1@1040 : Text;
      Dim3Filter1@1039 : Text;
      Dim4Filter1@1210006 : Text;
      DateFilter1@1038 : Text;
      FirstColumn@1044 : Text[50];
      LastColumn@1045 : Text[50];
      ShowColumnName@1027 : Boolean;
      Field1Visible@19069335 : Boolean INDATASET;
      Field2Visible@19014807 : Boolean INDATASET;
      Field3Visible@19062679 : Boolean INDATASET;
      Field4Visible@19074839 : Boolean INDATASET;
      Field5Visible@19043543 : Boolean INDATASET;
      Field6Visible@19067287 : Boolean INDATASET;
      Field7Visible@19067863 : Boolean INDATASET;
      Field8Visible@19039959 : Boolean INDATASET;
      Field9Visible@19008663 : Boolean INDATASET;
      Field10Visible@19006501 : Boolean INDATASET;
      Field11Visible@19052468 : Boolean INDATASET;
      Field12Visible@19013039 : Boolean INDATASET;
      Field13Visible@19079726 : Boolean INDATASET;
      Field14Visible@19077225 : Boolean INDATASET;
      Field15Visible@19035896 : Boolean INDATASET;
      Field16Visible@19003763 : Boolean INDATASET;
      Field17Visible@19049730 : Boolean INDATASET;
      Field18Visible@19007213 : Boolean INDATASET;
      Field19Visible@19053180 : Boolean INDATASET;
      Field20Visible@19014629 : Boolean INDATASET;
      Field21Visible@19060596 : Boolean INDATASET;
      Field22Visible@19021167 : Boolean INDATASET;
      Field23Visible@19047854 : Boolean INDATASET;
      Field24Visible@19045353 : Boolean INDATASET;
      Field25Visible@19004024 : Boolean INDATASET;
      Field26Visible@19011891 : Boolean INDATASET;
      Field27Visible@19057858 : Boolean INDATASET;
      Field28Visible@19015341 : Boolean INDATASET;
      Field29Visible@19061308 : Boolean INDATASET;
      Field30Visible@19010597 : Boolean INDATASET;
      Field31Visible@19056564 : Boolean INDATASET;
      Field32Visible@19017135 : Boolean INDATASET;

    PROCEDURE LoadVariables@1(PayrollAnalysisView1@1000 : Record 14965;LineDimOption1@1010 : 'Element,Element Group,Employee,Org. Unit,Period,Dimension 1,Dimension 2,Dimension 3,Dimension 4';ColumnDimOption1@1002 : 'Element,Element Group,Employee,Org. Unit,Period,Dimension 1,Dimension 2,Dimension 3,Dimension 4';LineDimCode1@1016 : Text[30];ColumnDimCode1@1015 : Text[30];PeriodType1@1007 : 'Day,Week,Month,Quarter,Year,Accounting Period';ValueType1@1009 : 'Sales Amount,Inventory Value,Sales Quantity';RoundingFactor1@1011 : 'None,1,1000,1000000';MatrixColumnCaptions1@1001 : ARRAY [32] OF Text[1024];ShowOppositeSign1@1006 : Boolean;PeriodInitialized1@1008 : Boolean;FirstColumn1@1014 : Text[50];LastColumn1@1013 : Text[50];ShowColumnName1@1017 : Boolean;NoOfRecordsLocal@1018 : Integer);
    BEGIN
      CLEAR(MatrixColumnCaptions);
      PayrollAnalysisView.COPY(PayrollAnalysisView1);

      CurrentPayrollAnalysisViewCode := PayrollAnalysisView.Code;

      LineDimOption := LineDimOption1;
      ColumnDimOption := ColumnDimOption1;

      LineDimCode := LineDimCode1;
      ColumnDimCode := ColumnDimCode1;

      PeriodType := PeriodType1;
      ShowOppositeSign := ShowOppositeSign1;

      COPYARRAY(MatrixColumnCaptions,MatrixColumnCaptions1,1);

      PeriodInitialized := PeriodInitialized1;
      PeriodType := PeriodType1;
      ValueType := ValueType1;
      RoundingFactor := RoundingFactor1;

      FirstColumn := FirstColumn1;
      LastColumn := LastColumn1;

      ShowColumnName := ShowColumnName1;

      NoOfRecords := NoOfRecordsLocal;
    END;

    PROCEDURE LoadFilters@2(ElementTypeFilter1@1210004 : Text[250];ElementFilter1@1210003 : Code[250];ElementGroupFilter1@1210002 : Code[250];EmployeeFilter1@1210001 : Code[250];OrgUnitFilter1@1210000 : Code[250];UsePFAccumSystemFilter1@1210006 : ' ,Yes,No';Dim1Filter1@1004 : Code[250];Dim2Filter1@1003 : Code[250];Dim3Filter1@1002 : Code[250];Dim4Filter1@1210005 : Code[250];DateFilter2@1001 : Text[30];InternalDateFilter1@1007 : Text[30]);
    BEGIN
      ElementTypeFilter := ElementTypeFilter1;
      ElementFilter := ElementFilter1;
      ElementGroupFilter := ElementGroupFilter1;
      EmployeeFilter := EmployeeFilter1;
      OrgUnitFilter := OrgUnitFilter1;
      UsePFAccumSystemFilter := UsePFAccumSystemFilter1;
      Dim1Filter := Dim1Filter1;
      Dim2Filter := Dim2Filter1;
      Dim3Filter := Dim3Filter1;
      Dim4Filter := Dim4Filter1;
      DateFilter := DateFilter2;
      InternalDateFilter := InternalDateFilter1;
    END;

    LOCAL PROCEDURE CalcAmt@3(DimCodeBufferColumn1@1004 : Record 367;ValueType@1001 : Integer;SetColFilter@1000 : Boolean) : Decimal;
    VAR
      Amt@1002 : Decimal;
      AmtFromBuffer@1003 : Boolean;
    BEGIN
      IF SetColFilter THEN
        IF AVBreakdownBuffer.GET(Code,DimCodeBufferColumn1.Code) THEN BEGIN
          Amt := AVBreakdownBuffer.Amount;
          AmtFromBuffer := TRUE;
        END;

      IF NOT AmtFromBuffer THEN BEGIN
        PayrollAnalysisMgt.SetCalcAmountParameters(
          CurrentPayrollAnalysisViewCode,
          LineDimOption,
          Rec,
          ColumnDimOption,
          DimCodeBufferColumn1);

        Amt := PayrollAnalysisMgt.CalcAmount(
            SetColFilter,ValueType,
            PayrollStatisticsBuffer,
            ElementTypeFilter,ElementFilter,ElementGroupFilter,EmployeeFilter,OrgUnitFilter,UsePFAccumSystemFilter,
            DateFilter,Dim1Filter,Dim2Filter,Dim3Filter,Dim3Filter);

        IF SetColFilter THEN BEGIN
          AVBreakdownBuffer."Line Code" := Code;
          AVBreakdownBuffer."Column Code" := DimCodeBufferColumn1.Code;
          AVBreakdownBuffer.Amount := Amt;
          AVBreakdownBuffer.INSERT;
        END;
      END;

      IF ShowOppositeSign THEN
        Amt := -Amt;
      EXIT(Amt);
    END;

    LOCAL PROCEDURE FieldDrillDown@4(Ordinal@1000 : Integer);
    BEGIN
      CLEAR(DimCodeBufferColumn3);
      Which := '-';

      PayrollAnalysisMgt.FindRec(
        PayrollAnalysisView,ColumnDimOption,DimCodeBufferColumn3,Which,
        ElementFilter,ElementGroupFilter,EmployeeFilter,OrgUnitFilter,
        PeriodType,DateFilter1,PeriodInitialized,InternalDateFilter,
        Dim1Filter1,Dim2Filter1,Dim3Filter1,Dim4Filter);

      Steps := Ordinal - 1;
      PayrollAnalysisMgt.NextRec(
        PayrollAnalysisView,ColumnDimOption,DimCodeBufferColumn3,Steps,
        ElementFilter1,ElementGroupFilter1,EmployeeFilter1,OrgUnitFilter1,
        PeriodType,DateFilter1,
        Dim1Filter1,Dim2Filter1,Dim3Filter1,Dim4Filter);

      PayrollAnalysisMgt.DrillDown(
        PayrollStatisticsBuffer,CurrentPayrollAnalysisViewCode,
        ElementTypeFilter1,ElementFilter1,ElementGroupFilter1,EmployeeFilter1,OrgUnitFilter1,UsePFAccumSystemFilter,
        DateFilter1,Dim1Filter1,Dim2Filter1,Dim3Filter1,Dim4Filter1,
        LineDimOption,Rec,
        ColumnDimOption,DimCodeBufferColumn3,
        TRUE,ValueType);
    END;

    PROCEDURE ApplyColumnFilter@13();
    BEGIN
      CLEAR(ElementTypeFilter1);
      CLEAR(ElementFilter1);
      CLEAR(ElementGroupFilter1);
      CLEAR(EmployeeFilter1);
      CLEAR(OrgUnitFilter1);
      CLEAR(DateFilter1);
      CLEAR(Dim1Filter1);
      CLEAR(Dim2Filter1);
      CLEAR(Dim3Filter1);
      CLEAR(Dim4Filter1);

      CASE ColumnDimOption OF
        ColumnDimOption::Element:
          BEGIN
            ElementTypeFilter1 := ElementTypeFilter;
            IF ElementFilter <> '' THEN
              ElementFilter1 := ElementFilter + '&';
            ElementFilter1 := ElementFilter1 + FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
            ElementGroupFilter1 := ElementGroupFilter;
            EmployeeFilter1 := EmployeeFilter;
            OrgUnitFilter1 := OrgUnitFilter;
            DateFilter1 := DateFilter;
            Dim1Filter1 := Dim1Filter;
            Dim2Filter1 := Dim2Filter;
            Dim3Filter1 := Dim3Filter;
            Dim4Filter1 := Dim4Filter;
          END;
        ColumnDimOption::"Element Group":
          BEGIN
            ElementTypeFilter1 := ElementTypeFilter;
            ElementFilter1 := ElementFilter;
            IF ElementGroupFilter <> '' THEN
              ElementGroupFilter1 := ElementGroupFilter + '&';
            ElementGroupFilter1 := ElementGroupFilter1 + FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
            EmployeeFilter1 := EmployeeFilter;
            OrgUnitFilter1 := OrgUnitFilter;
            DateFilter1 := DateFilter;
            Dim1Filter1 := Dim1Filter;
            Dim2Filter1 := Dim2Filter;
            Dim3Filter1 := Dim3Filter;
            Dim4Filter1 := Dim4Filter;
          END;
        ColumnDimOption::Employee:
          BEGIN
            ElementTypeFilter1 := ElementTypeFilter;
            ElementFilter1 := ElementFilter;
            ElementGroupFilter1 := ElementGroupFilter;
            IF EmployeeFilter <> '' THEN
              EmployeeFilter1 := EmployeeFilter + '&';
            EmployeeFilter1 := EmployeeFilter1 + FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
            OrgUnitFilter1 := OrgUnitFilter;
            DateFilter1 := DateFilter;
            Dim1Filter1 := Dim1Filter;
            Dim2Filter1 := Dim2Filter;
            Dim3Filter1 := Dim3Filter;
            Dim4Filter1 := Dim4Filter;
          END;
        ColumnDimOption::"Org. Unit":
          BEGIN
            ElementTypeFilter1 := ElementTypeFilter;
            ElementFilter1 := ElementFilter;
            ElementGroupFilter1 := ElementGroupFilter;
            EmployeeFilter1 := EmployeeFilter;
            IF OrgUnitFilter <> '' THEN
              OrgUnitFilter1 := OrgUnitFilter + '&';
            OrgUnitFilter1 := OrgUnitFilter1 + FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
            DateFilter1 := DateFilter;
            Dim1Filter1 := Dim1Filter;
            Dim2Filter1 := Dim2Filter;
            Dim3Filter1 := Dim3Filter;
            Dim4Filter1 := Dim4Filter;
          END;
        ColumnDimOption::Period:
          BEGIN
            ElementTypeFilter1 := ElementTypeFilter;
            ElementFilter1 := ElementFilter;
            ElementGroupFilter1 := ElementGroupFilter;
            EmployeeFilter1 := EmployeeFilter;
            OrgUnitFilter1 := OrgUnitFilter;
            IF DateFilter <> '' THEN
              DateFilter1 := DateFilter
            ELSE
              DateFilter1 := FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
            Dim1Filter1 := Dim1Filter;
            Dim2Filter1 := Dim2Filter;
            Dim3Filter1 := Dim3Filter;
            Dim4Filter1 := Dim4Filter;
          END;
        ColumnDimOption::"Dimension 1":
          BEGIN
            ElementTypeFilter1 := ElementTypeFilter;
            ElementFilter1 := ElementFilter;
            ElementGroupFilter1 := ElementGroupFilter;
            EmployeeFilter1 := EmployeeFilter;
            OrgUnitFilter1 := OrgUnitFilter;
            DateFilter1 := DateFilter;
            IF Dim1Filter <> '' THEN
              Dim1Filter1 := Dim1Filter + '&';
            Dim1Filter1 := Dim1Filter1 + FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
            Dim2Filter1 := Dim2Filter;
            Dim3Filter1 := Dim3Filter;
            Dim4Filter1 := Dim4Filter;
          END;
        ColumnDimOption::"Dimension 2":
          BEGIN
            ElementTypeFilter1 := ElementTypeFilter;
            ElementFilter1 := ElementFilter;
            ElementGroupFilter1 := ElementGroupFilter;
            EmployeeFilter1 := EmployeeFilter;
            OrgUnitFilter1 := OrgUnitFilter;
            DateFilter1 := DateFilter;
            Dim1Filter1 := Dim1Filter;
            IF Dim2Filter <> '' THEN
              Dim2Filter1 := Dim2Filter + '&';
            Dim2Filter1 := Dim2Filter1 + FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
            Dim3Filter1 := Dim3Filter;
            Dim4Filter1 := Dim4Filter;
          END;
        ColumnDimOption::"Dimension 3":
          BEGIN
            ElementTypeFilter1 := ElementTypeFilter;
            ElementFilter1 := ElementFilter;
            ElementGroupFilter1 := ElementGroupFilter;
            EmployeeFilter1 := EmployeeFilter;
            OrgUnitFilter1 := OrgUnitFilter;
            DateFilter1 := DateFilter;
            Dim1Filter1 := Dim1Filter;
            Dim2Filter1 := Dim2Filter;
            IF Dim3Filter <> '' THEN
              Dim3Filter1 := Dim3Filter + '&';
            Dim3Filter1 := Dim3Filter1 + FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
            Dim4Filter1 := Dim4Filter;
          END;
        ColumnDimOption::"Dimension 4":
          BEGIN
            ElementTypeFilter1 := ElementTypeFilter;
            ElementFilter1 := ElementFilter;
            ElementGroupFilter1 := ElementGroupFilter;
            EmployeeFilter1 := EmployeeFilter;
            OrgUnitFilter1 := OrgUnitFilter;
            DateFilter1 := DateFilter;
            Dim1Filter1 := Dim1Filter;
            Dim2Filter1 := Dim2Filter;
            Dim3Filter1 := Dim3Filter;
            IF Dim4Filter <> '' THEN
              Dim4Filter1 := Dim4Filter + '&';
            Dim4Filter1 := Dim4Filter1 + FORMAT(FirstColumn) + '..' + FORMAT(LastColumn);
          END;
      END;
    END;

    LOCAL PROCEDURE MatrixData1OnFormat@19069692(Text@19028438 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData2OnFormat@19026465(Text@19036635 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData3OnFormat@19060166(Text@19071760 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData4OnFormat@19009051(Text@19069349 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData5OnFormat@19059552(Text@19051658 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData6OnFormat@19053253(Text@19066063 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData7OnFormat@19050026(Text@19015060 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData8OnFormat@19034111(Text@19046185 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData9OnFormat@19067812(Text@19060590 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData10OnFormat@19054039(Text@19007565 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData11OnFormat@19009431(Text@19015585 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData12OnFormat@19079383(Text@19064572 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData13OnFormat@19000855(Text@19020092 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData14OnFormat@19018071(Text@19025983 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData15OnFormat@19060759(Text@19026243 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData16OnFormat@19003415(Text@19016414 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData17OnFormat@19052183(Text@19028126 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData18OnFormat@19001303(Text@19062689 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData19OnFormat@19065175(Text@19042469 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData20OnFormat@19031868(Text@19076488 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData21OnFormat@19074556(Text@19047132 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData22OnFormat@19017212(Text@19068835 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData23OnFormat@19065980(Text@19040547 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData24OnFormat@19043196(Text@19007610 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData25OnFormat@19038588(Text@19055166 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData26OnFormat@19068540(Text@19046509 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData27OnFormat@19030012(Text@19018221 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData28OnFormat@19066428(Text@19044316 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData29OnFormat@19003004(Text@19004832 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData30OnFormat@19044513(Text@19064831 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData31OnFormat@19079905(Text@19006275 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    LOCAL PROCEDURE MatrixData32OnFormat@19069857(Text@19039070 : Text[1024]);
    BEGIN
      PayrollAnalysisMgt.FormatAmount(Text,RoundingFactor);
    END;

    BEGIN
    END.
  }
}

