OBJECT Page 2113 O365 Posted Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=25.10.16;
    Time=12:00:00;
    Version List=NAVW110.00,NAVRU10.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Sent Invoice;
               RUS=Отправленный счет];
    SourceTable=Table112;
    PageType=Document;
    OnAfterGetRecord=VAR
                       DummyCustLedgerEntry@1002 : Record 21;
                       O365SalesInvoicePayment@1001 : Codeunit 2105;
                     BEGIN
                       IsFullyPaid := O365SalesInvoicePayment.GetPaymentCustLedgerEntry(DummyCustLedgerEntry,"No.");
                       WorkDescription := GetWorkDescription;
                     END;

    ActionList=ACTIONS
    {
      { 22      ;    ;ActionContainer;
                      CaptionML=[ENU=Invoice;
                                 RUS=Счет];
                      ActionContainerType=ActionItems }
      { 23      ;1   ;Action    ;
                      Name=Send;
                      CaptionML=[ENU=Resend by email;
                                 RUS=Снова отправить по эл. почте];
                      ToolTipML=[ENU=Sends the invoice as pdf by email.;
                                 RUS=Отправляет счет по электронной почте в формате PDF.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Email;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SETRECFILTER;
                                 LOCKTABLE;
                                 FIND;
                                 EmailRecords(FALSE);
                                 FIND;
                               END;
                                }
      { 24      ;1   ;Action    ;
                      Name=ViewPdf;
                      CaptionML=[ENU=View Invoice;
                                 RUS=Просмотр счета];
                      ToolTipML=[ENU=View the final invoice as pdf.;
                                 RUS=Просмотр окончательного счета в формате PDF.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=View;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReportSelections@1001 : Record 77;
                                 ReportViewer@1000 : Page 2115;
                               BEGIN
                                 SETRECFILTER;
                                 LOCKTABLE;
                                 FIND;
                                 ReportViewer.SetDocument(Rec,ReportSelections.Usage::SI,"Sell-to Customer No.");
                                 ReportViewer.RUN;
                                 FIND;
                               END;
                                }
      { 27      ;1   ;Action    ;
                      Name=ShowPayments;
                      CaptionML=[ENU=Show Payments;
                                 RUS=Показать платежи];
                      ToolTipML=[ENU=Show a list of payments made for this invoice.;
                                 RUS=Отображение списка платежей, совершенных по этому счету.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Payment;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 O365SalesInvoicePayment.ShowHistory("No.");
                               END;
                                }
      { 26      ;1   ;Action    ;
                      Name=MarkAsPaid;
                      CaptionML=[ENU=Mark as paid;
                                 RUS=Пометить как оплаченный];
                      ToolTipML=[ENU=Pay the invoice as specified in the default Payment Registration Setup.;
                                 RUS=Оплата счета, как указано в параметрах регистрации платежей по умолчанию.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsFullyPaid;
                      Image=Payment;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 O365SalesInvoicePayment.MarkAsPaid("No.");
                               END;
                                }
      { 25      ;1   ;Action    ;
                      Name=MarkAsUnpaid;
                      CaptionML=[ENU=Mark as unpaid;
                                 RUS=Пометить как неоплаченный];
                      ToolTipML=[ENU=Mark the invoice as unpaid.;
                                 RUS=Отметка счета как неоплаченного.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=IsFullyPaid;
                      Image=Cancel;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 O365SalesInvoicePayment.CancelSalesInvoicePayment("No.");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                GroupType=Group }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the record.;
                           RUS=Определяет номер записи.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No.";
                Importance=Additional }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the customer who will receive the products and be billed by default. When you fill this field, most of the other fields on the document are filled from the customer card.;
                           RUS=Определяет номер клиента, который получит продукты и которому по умолчанию будет выставлен счет. При заполнении этого поля большинство других полей в документе заполняется на основании карточки клиента.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Customer No.";
                Importance=Additional;
                Visible=FALSE }

    { 9   ;2   ;Field     ;
                CaptionML=[ENU=Customer Name;
                           RUS=Название клиента];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Customer Name";
                Importance=Promoted }

    { 10  ;2   ;Field     ;
                CaptionML=[ENU=Address;
                           RUS=Адрес];
                ToolTipML=[ENU=Specifies the customer's sell-to address.;
                           RUS=Определяет адрес клиента.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address";
                Importance=Additional }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies an additional part of the address of the customer that the items were sold to.;
                           RUS=Определяет дополнительную часть адреса клиента, которому были проданы товары.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address 2";
                Importance=Additional;
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                CaptionML=[ENU=City;
                           RUS=Город];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to City";
                Importance=Additional }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person to contact at the customer that the items were sold to.;
                           RUS=Определяет имя контактного лица у клиента, которому были проданы товары.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                CaptionML=[ENU=" Post Code";
                           RUS=" Почтовый индекс"];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Post Code";
                Importance=Additional }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the county of the customer that the items were sold to.;
                           RUS=Определяет район клиента, которому были проданы товары.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to County";
                Importance=Additional;
                Visible=FALSE }

    { 16  ;2   ;Field     ;
                CaptionML=[ENU=Country/Region Code;
                           RUS=Код страны/региона];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Country/Region Code" }

    { 17  ;2   ;Field     ;
                CaptionML=[ENU=Invoice Date;
                           RUS=Дата счета];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date" }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posting date of the record.;
                           RUS=Определяет дату учета записи.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Importance=Additional;
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=Due Date;
                           RUS=Срок выполнения];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date" }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the tax area code that is used to calculate and post sales tax.;
                           RUS=Определяет код налоговой области, который используется для расчета и учета налога.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Tax Area Code";
                Importance=Additional }

    { 19  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the sales invoice contains sales tax.;
                           RUS=Указывает, содержит ли счет продажи налог.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Tax Liable";
                Importance=Additional }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the sales quote that the sales order was created from. You can track the number to sales quote documents that you have printed, saved, or emailed.;
                           RUS=Определяет номер предложения по продаже, из которого был создан заказ на продажу. Вы можете отслеживать номер по документам предложения по продаже, которые вы распечатали, сохранили или отправили по электронной почте.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Quote No.";
                Importance=Additional;
                Visible=FALSE }

    { 30  ;2   ;Group     ;
                CaptionML=[ENU=Work Description;
                           RUS=Описание работы];
                GroupType=Group }

    { 29  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the products or service being offered;
                           RUS=Определяет предлагаемые товары или услуги.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=WorkDescription;
                Importance=Additional;
                Editable=FALSE;
                MultiLine=Yes;
                ShowCaption=No }

    { 21  ;1   ;Part      ;
                CaptionML=[ENU=Lines;
                           RUS=Строки];
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page2114;
                PartType=Page }

    { 7   ;1   ;Field     ;
                CaptionML=[ENU=Net Total;
                           RUS=Чистый итог];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Amount;
                Importance=Promoted;
                Enabled=FALSE }

    { 8   ;1   ;Field     ;
                CaptionML=[ENU=Total Including Tax;
                           RUS=Итого с учетом налога];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Amount Including VAT";
                Importance=Promoted;
                Enabled=FALSE }

  }
  CODE
  {
    VAR
      O365SalesInvoicePayment@1002 : Codeunit 2105;
      IsFullyPaid@1000 : Boolean;
      WorkDescription@1001 : Text;

    BEGIN
    END.
  }
}

