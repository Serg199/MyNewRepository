OBJECT Page 1027 Job WIP Cockpit
{
  OBJECT-PROPERTIES
  {
    Date=25.10.16;
    Time=12:00:00;
    Version List=NAVW110.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Job WIP Cockpit;
               RUS=Панель задач НЗП];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table167;
    SourceTableView=WHERE(Status=FILTER(Open|Completed),
                          WIP Completion Posted=CONST(No));
    PageType=List;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Define,Analyze;
                                RUS=Создать, Обработать, Отчет, Определить, Анализ];
    ActionList=ACTIONS
    {
      { 15      ;    ;ActionContainer;
                      Name=<Action15>;
                      CaptionML=[ENU=<Action15>;
                                 RUS=<Действие15>];
                      ActionContainerType=RelatedInformation }
      { 31      ;1   ;ActionGroup;
                      Name=<Action34>;
                      CaptionML=[ENU=Job;
                                 RUS=Работа];
                      Image=Job }
      { 40      ;2   ;Action    ;
                      CaptionML=[ENU=Job;
                                 RUS=Работа];
                      ToolTipML=[ENU=View or edit detailed information about the job.;
                                 RUS=Просмотр или изменение подробных сведений о работе.];
                      ApplicationArea=#Jobs;
                      RunObject=Page 88;
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      Image=JobLedger;
                      PromotedCategory=Category4 }
      { 41      ;2   ;Action    ;
                      CaptionML=[ENU=Job Task Lines;
                                 RUS=Строки рабочего задания];
                      ToolTipML=[ENU=Plan how you want to set up your planning information. In this window you can specify the tasks involved in a job. To start planning a job or to post usage for a job, you must set up at least one job task.;
                                 RUS=Планирование настройки сведений о планировании. В этом окне можно указать задания, включенные в состав работы. Чтобы начать планирование работы или учесть потребление для работы, необходимо настроить по крайней мере одно рабочее задание.];
                      ApplicationArea=#Jobs;
                      RunObject=Page 1002;
                      RunPageLink=Job No.=FIELD(No.);
                      Promoted=Yes;
                      Image=TaskList;
                      PromotedCategory=Category4 }
      { 30      ;2   ;Action    ;
                      Name=<Action31>;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 RUS=&Книга операций];
                      ToolTipML=[ENU=View the history of transactions that have been posted for the selected record.;
                                 RUS=Просмотр истории транзакций, которые были учтены для выбранной записи.];
                      ApplicationArea=#Jobs;
                      RunObject=Page 92;
                      RunPageView=SORTING(Job No.,Job Task No.,Entry Type,Posting Date);
                      RunPageLink=Job No.=FIELD(No.);
                      Promoted=Yes;
                      Image=JobLedger;
                      PromotedCategory=Category5 }
      { 27      ;2   ;Action    ;
                      Name=<Action30>;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 RUS=Статистика];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 RUS=Просмотр статистических сведений, например суммы учтенных операций для записи.];
                      ApplicationArea=#Jobs;
                      RunObject=Page 1025;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 33      ;1   ;ActionGroup;
                      CaptionML=[ENU=W&IP;
                                 RUS=Н&ЗП];
                      Image=WIP }
      { 39      ;2   ;Action    ;
                      CaptionML=[ENU=Show Warnings;
                                 RUS=Показать предупреждения];
                      ToolTipML=[ENU=View the warning message for lines where the WIP Warnings check box is selected.;
                                 RUS=Просмотр предупреждения для строк, в которых установлен флажок "Предупреждения НЗП".];
                      ApplicationArea=#Jobs;
                      Promoted=Yes;
                      Image=Find;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Job@1000 : Record 167;
                                 JobWIPWarning@1001 : Record 1007;
                                 TempJobWIPWarning@1002 : TEMPORARY Record 1007;
                               BEGIN
                                 Job.COPY(Rec);
                                 CurrPage.SETSELECTIONFILTER(Job);
                                 IF Job.FINDSET THEN
                                   REPEAT
                                     JobWIPWarning.SETRANGE("Job No.",Job."No.");
                                     IF JobWIPWarning.FINDSET THEN
                                       REPEAT
                                         TempJobWIPWarning := JobWIPWarning;
                                         TempJobWIPWarning.INSERT;
                                       UNTIL JobWIPWarning.NEXT = 0;
                                   UNTIL Job.NEXT = 0;
                                 PAGE.RUNMODAL(PAGE::"Job WIP Warnings",TempJobWIPWarning);
                               END;
                                }
      { 24      ;2   ;Action    ;
                      CaptionML=[ENU=WIP Entries;
                                 RUS=Операции НЗП];
                      ToolTipML=[ENU=View the job's WIP entries.;
                                 RUS=Просмотр операций НЗП для работы.];
                      ApplicationArea=#Jobs;
                      RunObject=Page 1008;
                      RunPageView=SORTING(Job No.,Job Posting Group,WIP Posting Date);
                      RunPageLink=Job No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=WIPEntries;
                      PromotedCategory=Category5 }
      { 17      ;2   ;Action    ;
                      CaptionML=[ENU=WIP G/L Entries;
                                 RUS=Операции НЗП в ГК];
                      ToolTipML=[ENU=View the job's WIP G/L entries.;
                                 RUS=Просмотр операций ГК НЗП для работы.];
                      ApplicationArea=#Jobs;
                      RunObject=Page 1009;
                      RunPageView=SORTING(Job No.);
                      RunPageLink=Job No.=FIELD(No.),
                                  Reversed=CONST(No);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=WIPLedger;
                      PromotedCategory=Category5 }
      { 25      ;0   ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 26      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 RUS=Ф&ункции];
                      ActionContainerType=NewDocumentItems;
                      Image=Action }
      { 45      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Calculate WIP;
                                 RUS=Рассчитать НЗП];
                      ToolTipML=[ENU=Use a batch job to help you calculate the value of work in process (WIP) on your jobs.;
                                 RUS=Пакетное задание помогает рассчитать стоимость незавершенного производства (НЗП) по вашим работам.];
                      ApplicationArea=#Jobs;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CalculateWIP;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Job@1001 : Record 167;
                               BEGIN
                                 TESTFIELD("No.");
                                 Job.COPY(Rec);
                                 Job.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::"Job Calculate WIP",TRUE,FALSE,Job);
                               END;
                                }
      { 44      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post WIP to G/L;
                                 RUS=Учет НЗП в ГК];
                      ToolTipML=[ENU=Post the job WIP totals to the general ledger.;
                                 RUS=Учет общих сумм НЗП по работе в главной книге.];
                      ApplicationArea=#Jobs;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Job@1001 : Record 167;
                               BEGIN
                                 TESTFIELD("No.");
                                 Job.COPY(Rec);
                                 Job.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::"Job Post WIP to G/L",TRUE,FALSE,Job);
                               END;
                                }
      { 38      ;2   ;Action    ;
                      Name=<Action37>;
                      CaptionML=[ENU=Delete WIP Entries;
                                 RUS=Удалить записи НЗП];
                      ToolTipML=[ENU=Delete all WIP entries for the selected jobs.;
                                 RUS=Удалить все операции НЗП по выбранным работам?];
                      ApplicationArea=#Jobs;
                      Promoted=Yes;
                      Image=Delete;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Job@1000 : Record 167;
                                 JobCalculateWIP@1001 : Codeunit 1000;
                               BEGIN
                                 IF CONFIRM(Text001) THEN BEGIN
                                   Job.COPY(Rec);
                                   CurrPage.SETSELECTIONFILTER(Job);
                                   IF Job.FINDSET THEN
                                     REPEAT
                                       JobCalculateWIP.DeleteWIP(Job);
                                     UNTIL Job.NEXT = 0;

                                   MESSAGE(Text002);
                                 END;
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=<Action38>;
                      CaptionML=[ENU=Recalculate WIP;
                                 RUS=Пересчитать НЗП];
                      ToolTipML=[ENU=Calculate the work in process again. Every time WIP is calculated, an entry is created in the Job WIP Entries window.;
                                 RUS=Повторный расчет НЗП. При каждом расчете незавершенного производства в окне "Операции работ НЗП" создается операция.];
                      ApplicationArea=#Jobs;
                      Promoted=Yes;
                      Image=CalculateWIP;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Job@1001 : Record 167;
                                 JobWIPEntry@1003 : Record 1004;
                                 JobCalculateWIP@1000 : Codeunit 1000;
                                 FailedJobs@1004 : Text[1024];
                               BEGIN
                                 IF CONFIRM(Text003) THEN BEGIN
                                   Job.COPY(Rec);
                                   CurrPage.SETSELECTIONFILTER(Job);
                                   IF Job.FINDSET THEN
                                     REPEAT
                                       JobWIPEntry.SETRANGE("Job No.",Job."No.");
                                       IF NOT JobWIPEntry.FINDFIRST THEN
                                         FailedJobs := FailedJobs + Job."No." + ', '
                                       ELSE
                                         JobCalculateWIP.JobCalcWIP(Job,Job."WIP Posting Date",JobWIPEntry."Document No.");
                                     UNTIL Job.NEXT = 0;

                                   IF FailedJobs = '' THEN
                                     MESSAGE(Text004)
                                   ELSE
                                     MESSAGE(Text005,DELSTR(FailedJobs,STRLEN(FailedJobs) - 1,STRLEN(FailedJobs)));
                                 END;
                               END;
                                }
      { 35      ;0   ;ActionContainer;
                      ActionContainerType=Reports }
      { 32      ;1   ;Action    ;
                      Name=<Action32>;
                      CaptionML=[ENU=Job WIP To G/L;
                                 RUS=Работа НЗП в ГК];
                      ToolTipML=[ENU=View the value of work in process on the jobs that you select compared to the amount that has been posted in the general ledger.;
                                 RUS=Просмотр стоимости НЗП по выбранным работам в сравнении с суммой, которая была учтена в главной книге.];
                      ApplicationArea=#Jobs;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 Job@1000 : Record 167;
                               BEGIN
                                 TESTFIELD("No.");
                                 Job.COPY(Rec);
                                 Job.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::"Job WIP To G/L",TRUE,FALSE,Job);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Jobs;
                GroupType=Repeater;
                FreezeColumnID=Description }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number for the job. You can use one of the following methods to fill in the number:;
                           RUS=Определяет номер работы. Для ввода номера можно использовать один из следующих методов:];
                ApplicationArea=#Jobs;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a short description of the job.;
                           RUS=Определяет краткое описание работы.];
                ApplicationArea=#Jobs;
                SourceExpr=Description }

    { 29  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether or not there are WIP warnings associated with a job.;
                           RUS=Определяет, существуют ли связанные с работой предупреждения НЗП.];
                ApplicationArea=#Jobs;
                SourceExpr="WIP Warnings" }

    { 43  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the Recognized Cost amount that was last calculated for the job. The Recognized Cost Amount for the job is the sum of the Recognized Cost Job WIP Entries.;
                           RUS=Определяет сумму признанных затрат, вычисленную для этой работы при последнем расчете. Сумма признанных затрат для этой работы является суммой операций НЗП работы признанных затрат.];
                ApplicationArea=#Jobs;
                SourceExpr="Recog. Costs Amount" }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total Recognized Cost amount that was last posted to the general ledger for the job. The Recognized Cost G/L amount for the job is the sum of the Recognized Cost Job WIP G/L Entries.;
                           RUS=Определяет общую сумму признанных затрат, учтенную в главной книге для этой работы при последней операции учета. Значение "Сумма признанных затрат ГК" для работы представляет собой сумму операций ГК НЗП работы признанных затрат.];
                ApplicationArea=#Jobs;
                SourceExpr="Recog. Costs G/L Amount" }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the recognized sales amount that was last calculated for the job. The Recog. Sales Amount for the job is the sum of the Recognized Sales Job WIP Entries.;
                           RUS=Определяет сумму признанных продаж, вычисленную для этой работы при последнем расчете. Значение "Призн. сумма продаж" для работы является суммой операций НЗП работы признанных продаж.];
                ApplicationArea=#Jobs;
                SourceExpr="Recog. Sales Amount" }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total Recognized Sales amount that was last posted to the general ledger for the job. The Recognized Sales G/L amount for the job is the sum of the Recognized Sales Job WIP G/L Entries.;
                           RUS=Определяет общую сумму признанных продаж, учтенную в главной книге для этой работы при последней операции учета. Значение "Сумма признанных продаж ГК" для работы представляет собой сумму операций ГК НЗП работы признанных продаж.];
                ApplicationArea=#Jobs;
                SourceExpr="Recog. Sales G/L Amount" }

    { 22  ;2   ;Field     ;
                Name=Recog. Costs Amount Difference;
                CaptionML=[ENU=Recog. Costs Amount Difference;
                           RUS=Призн. разница сумм затрат];
                ToolTipML=[ENU=Specifies the difference in recognized costs for the job.;
                           RUS=Определяет разницу признанной себестоимости для работы.];
                ApplicationArea=#Jobs;
                SourceExpr="Recog. Costs Amount" - "Recog. Costs G/L Amount" }

    { 18  ;2   ;Field     ;
                Name=Recog. Sales Amount Difference;
                CaptionML=[ENU=Recog. Sales Amount Difference;
                           RUS=Призн. разница сумм продаж];
                ToolTipML=[ENU=Specifies the difference in recognized sales for the job.;
                           RUS=Определяет разницу признанных продаж для работы.];
                ApplicationArea=#Jobs;
                SourceExpr="Recog. Sales Amount" - "Recog. Sales G/L Amount" }

    { 16  ;2   ;Field     ;
                Name=Recog. Profit Amount;
                CaptionML=[ENU=Recog. Profit Amount;
                           RUS=Сумма призн. дохода];
                ToolTipML=[ENU=Specifies the recognized profit amount for the job.;
                           RUS=Определяет сумму признанной прибыли для работы.];
                ApplicationArea=#Jobs;
                SourceExpr=CalcRecognizedProfitAmount }

    { 14  ;2   ;Field     ;
                Name=Recog. Profit G/L Amount;
                CaptionML=[ENU=Recog. Profit G/L Amount;
                           RUS=Сумма ГК призн. дохода];
                ToolTipML=[ENU=Specifies the total recognized profit G/L amount for this job.;
                           RUS=Определяет общую сумму признанной прибыли ГК для этой работы.];
                ApplicationArea=#Jobs;
                SourceExpr=CalcRecognizedProfitGLAmount }

    { 13  ;2   ;Field     ;
                Name=Recog. Profit Amount Difference;
                CaptionML=[ENU=Recog. Profit Amount Difference;
                           RUS=Призн. разница сумм доходов];
                ToolTipML=[ENU=Specifies the difference in recognized profit for the job.;
                           RUS=Определяет разницу признанной прибыли для работы.];
                ApplicationArea=#Jobs;
                SourceExpr=CalcRecognizedProfitAmount - CalcRecognizedProfitGLAmount }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posting date that was entered when the Job Calculate WIP batch job was last run.;
                           RUS=Определяет дату учета, введенную при последнем выполнении пакетного задания "Расчет НЗП по работам".];
                ApplicationArea=#Jobs;
                SourceExpr="WIP Posting Date" }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posting date that was entered when the Job Post WIP to general ledger batch job was last run.;
                           RUS=Определяет дату учета, введенную при последнем выполнении пакетного задания "Работа - учет НЗП в ГК".];
                ApplicationArea=#Jobs;
                SourceExpr="WIP G/L Posting Date" }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total WIP cost amount that was last calculated for the job. The WIP Cost Amount for the job is the value WIP Cost Job WIP Entries less the value of the Recognized Cost Job WIP Entries. For jobs with WIP Methods of Sales Value or Percentage of Completion, the WIP Cost Amount is normally 0.;
                           RUS=Определяет общую сумму себестоимости НЗП, вычисленную для этой работы при выполнении последнего расчета. Значением суммы себестоимости НЗП для этой работы является сумма операций НЗП по НЗП работы затрат, уменьшенная на сумму операций НЗП работы признанных затрат. Для работ, где используется метод НЗП "Стоимость продаж" или "Процент завершения", затраты НЗП обычно равны 0.];
                ApplicationArea=#Jobs;
                SourceExpr="Total WIP Cost Amount" }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total WIP Cost amount that was last posted to the G/L for the job. The WIP Cost Amount for the job is the value WIP Cost Job WIP G/L Entries less the value of the Recognized Cost Job WIP G/L Entries. For jobs with WIP Methods of Sales Value or Percentage of Completion, the WIP Cost Amount is normally 0.;
                           RUS=Определяет общую сумму затрат НЗП, учтенную в ГК для этой работы при последней операции учета. Значением суммы затрат НЗП для этой работы является сумма операций ГК НЗП работы затрат НЗП, уменьшенная на сумму операций ГК НЗП работы признанных затрат. Для работ, где используется метод НЗП "Стоимость продаж" или "Процент завершения", затраты НЗП обычно равны 0.];
                ApplicationArea=#Jobs;
                SourceExpr="Total WIP Cost G/L Amount" }

    { 19  ;2   ;Field     ;
                Name=Total WIP Cost Difference;
                CaptionML=[ENU=Total WIP Cost Difference;
                           RUS=Разница общих затрат НЗП];
                ToolTipML=[ENU=Specifies the difference in total WIP costs.;
                           RUS=Определяет разницу в общей сумме себестоимости НЗП.];
                ApplicationArea=#Jobs;
                SourceExpr="Total WIP Cost Amount" - "Total WIP Cost G/L Amount" }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total WIP Sales amount that was last calculated for the job. The WIP Sales Amount for the job is the value WIP Sales Job WIP Entries less the value of the Recognized Sales Job WIP Entries. For jobs with WIP Methods of Cost Value or Cost of Sales, the WIP Sales Amount is normally 0.;
                           RUS=Определяет общую сумму продаж НЗП, вычисленную для этой работы при последнем расчете. Значением суммы продаж НЗП для данной работы является значение операций НЗП работы продаж НЗП, уменьшенное на величину операций НЗП работы признанных продаж. Для работ, где используется метод НЗП "Себестоимость" или "Себестоимость проданных товаров", сумма продаж НЗП обычно равна 0.];
                ApplicationArea=#Jobs;
                SourceExpr="Total WIP Sales Amount" }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total WIP Sales amount that was last posted to the general ledger for the job. The WIP Sales Amount for the job is the value WIP Sales Job WIP G/L Entries less the value of the Recognized Sales Job WIP G/L Entries. For jobs with WIP Methods of Cost Value or Cost of Sales, the WIP Sales Amount is normally 0.;
                           RUS=Определяет общую сумму продаж НЗП, учтенную в главной книге для этой работы при последней операции учета. Значением суммы продаж НЗП для этой работы является значение операций главной книги НЗП работы продаж НЗП, уменьшенное на величину операций НЗП работы признанных продаж. Для работ, где используется метод НЗП "Себестоимость" или "Себестоимость проданных товаров", сумма продаж НЗП обычно равна 0.];
                ApplicationArea=#Jobs;
                SourceExpr="Total WIP Sales G/L Amount" }

    { 20  ;2   ;Field     ;
                Name=Total WIP Sales Difference;
                CaptionML=[ENU=Total WIP Sales Difference;
                           RUS=Разница общих продаж НЗП];
                ToolTipML=[ENU=Specifies the difference in total WIP sales.;
                           RUS=Определяет разницу в общей сумме продаж НЗП.];
                ApplicationArea=#Jobs;
                SourceExpr="Total WIP Sales Amount" - "Total WIP Sales G/L Amount" }

    { 28  ;1   ;Part      ;
                ApplicationArea=#Jobs;
                SubPageLink=Job No.=FIELD(No.),
                            Posted to G/L=CONST(No);
                PagePartID=Page1028;
                PartType=Page }

    { 36  ;0   ;Container ;
                ContainerType=FactBoxArea }

    { 34  ;1   ;Part      ;
                ApplicationArea=#Jobs;
                SubPageLink=No.=FIELD(No.),
                            Planning Date Filter=FIELD(Planning Date Filter),
                            Resource Filter=FIELD(Resource Filter),
                            Posting Date Filter=FIELD(Posting Date Filter),
                            Resource Gr. Filter=FIELD(Resource Gr. Filter);
                PagePartID=Page9099;
                Visible=TRUE;
                PartType=Page }

    { 6   ;1   ;Part      ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 5   ;1   ;Part      ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text001@1001 : TextConst 'ENU=Are you sure that you want to delete the WIP entries for all selected jobs?;RUS=Вы действительно хотите удалить операции НЗП для всех выбранных заданий?';
      Text002@1000 : TextConst 'ENU=WIP Entries were deleted successfully.;RUS=Операции НЗП успешно удалены.';
      Text003@1002 : TextConst 'ENU=Are you sure that you want to recalculate the WIP entries for all selected jobs?;RUS=Вы действительно хотите перерассчитать операции НЗП для всех выбранных заданий?';
      Text004@1003 : TextConst 'ENU=WIP Entries were recalculated successfully.;RUS=Операции НЗП успешно перерассчитаны.';
      Text005@1004 : TextConst 'ENU=The recalculation for the following jobs failed because no WIP entries were found: %1.;RUS=Не удалось выполнить перерасчет для следующих заданий, так как операции НЗП не найдены: %1.';

    BEGIN
    END.
  }
}

