OBJECT Table 14901 Vendor Agreement
{
  OBJECT-PROPERTIES
  {
    Date=14.08.17;
    Time=13:16:06;
    Modified=Yes;
    Version List=NAVRU10.00,NOS-26;
  }
  PROPERTIES
  {
    DataCaptionFields=Vendor No.,No.;
    OnInsert=BEGIN
               Vend.GET("Vendor No.");
               Vend.TESTFIELD("Agreement Posting",Vend."Agreement Posting"::Mandatory);
               IF "No." = '' THEN BEGIN
                 Vend.TESTFIELD("Agreement Nos.");
                 NoSeriesMgt.InitSeries(Vend."Agreement Nos.",xRec."No. Series",WORKDATE,"No.","No. Series");
                 Description := STRSUBSTNO('%1 %2',Text12400,"No.");
               END;

               //NC MTD02 > AIG
               {
               VendAgrmt.RESET;
               VendAgrmt.SETCURRENTKEY("No.");
               VendAgrmt.SETRANGE("No.","No.");
               IF VendAgrmt.FINDSET THEN
                 REPEAT
                   IF VendAgrmt."Vendor No." <> "Vendor No." THEN
                     ERROR(Text12403,FIELDCAPTION("No."),VendAgrmt."Vendor No.");
                 UNTIL VendAgrmt.NEXT = 0;

               }
               //NC MTD02 < AIG

               VendTransferFields;
               VendTransferDimensions;

               PurchSetup.GET;
               IF PurchSetup."Synch. Agreement Dimension" THEN BEGIN
                 //NC OMCP02 > DP
                 IF "Agreement Type"= "Agreement Type"::Trade THEN
                   PurchSetup.TESTFIELD("Vend. Trade Agrmnt. Dim. Code")
                 ELSE
                 //NC OMCP02 > DP
                 PurchSetup.TESTFIELD("Vendor Agreement Dim. Code");

                 DimValue.INIT;
                 //NC OMCP02 > DP
                 IF "Agreement Type"= "Agreement Type"::Trade THEN BEGIN
                    DimValue."Dimension Code" := PurchSetup."Vend. Trade Agrmnt. Dim. Code";
                    //NC OAM45 > RD
                    DimValue.Marked := FALSE;
                    //NC OAM45 < RD
                 END ELSE BEGIN
                   //NC OMCP02 > DP
                   DimValue."Dimension Code" := PurchSetup."Vendor Agreement Dim. Code";
                   //NC OAM45 > RD
                   DimValue.Marked := TRUE;
                 END;
                 //NC OAM45 < RD
                 DimValue.Code := "No.";
                 //NC MLN17 > DP
                 IF "External Agreement No."<>'' THEN
                   DimValue.Name := COPYSTR("External Agreement No.",1,MAXSTRLEN(DimValue.Name))
                 ELSE
                 //NC MLN17 < DP
                 DimValue.Name := COPYSTR("No.",1,MAXSTRLEN(DimValue.Name));
                 //NC NOS-26 > ENK
                 DimValue."Company Name" := COMPANYNAME;
                 {
                 IF DimValue.INSERT THEN;
                 }
                 IF DimValue.INSERT(TRUE) THEN;
                 //NC NOS-26 < ENK

                 //NC OAM31 > PCH
                 {
                 DefaultDim2.INIT;
                 DefaultDim2."Table ID" := DATABASE::"Vendor Agreement";
                 DefaultDim2."No." := "No.";

                 //NC OMCP02 > DP
                 IF "Agreement Type"= "Agreement Type"::Trade THEN
                    DefaultDim2."Dimension Code" := PurchSetup."Vend. Trade Agrmnt. Dim. Code"
                 ELSE
                 //NC OMCP02 > DP

                 DefaultDim2."Dimension Code" := PurchSetup."Vendor Agreement Dim. Code";
                 DefaultDim2."Dimension Value Code" := "No.";
                 DefaultDim2."Value Posting" := DefaultDim2."Value Posting"::"Same Code";
                 IF DefaultDim2.INSERT THEN;
                 }
                 IF (CurrCompany = '') OR (CurrCompany = COMPANYNAME) THEN
                   DefaultDim2Adv.CHANGECOMPANY
                 ELSE
                   DefaultDim2Adv.CHANGECOMPANY(CurrCompany);

                 DefaultDim2Adv.INIT;
                 DefaultDim2Adv."Table ID" := DATABASE::"Vendor Agreement";
                 DefaultDim2Adv."Source No." := "Vendor No.";
                 DefaultDim2Adv."No." := "No.";

                 IF "Agreement Type"= "Agreement Type"::Trade THEN
                    DefaultDim2Adv."Dimension Code" := PurchSetup."Vend. Trade Agrmnt. Dim. Code"
                 ELSE

                 DefaultDim2Adv."Dimension Code" := PurchSetup."Vendor Agreement Dim. Code";
                 DefaultDim2Adv."Dimension Value Code" := "No.";
                 DefaultDim2Adv."Value Posting" := DefaultDim2Adv."Value Posting"::"Same Code";

                 IF DefaultDim2Adv.INSERT THEN;
                 //NC OAM31 < PCH
               END;

               //TDRANCS-1207>
               IF "Type Deal" = '' THEN
                 IF g_recDealType.GET('UNKNOWN') THEN
                   "Type Deal" := g_recDealType.Code;
               //TDRANCS-1207<
             END;

    OnModify=VAR
               l_RecRef@1101495000 : RecordRef;
             BEGIN
               PurchSetup.GET;
               //NC OMCP02 > DP
               IF "Agreement Type"= "Agreement Type"::Trade THEN BEGIN
                 IF DimValue.GET(PurchSetup."Vend. Trade Agrmnt. Dim. Code","No.") THEN BEGIN
                   DimValue.Name := COPYSTR("No.",1,MAXSTRLEN(DimValue.Name));
                   IF Blocked > 0 THEN
                     DimValue.Blocked := TRUE
                   ELSE
                     DimValue.Blocked := FALSE;
                   //NC OAM45 > RD
                   DimValue.Marked := FALSE;
                   //NC OAM45 < RD
                   DimValue.MODIFY;
                 END;
               END ELSE
               //NC OMCP02 > DP

               IF DimValue.GET(PurchSetup."Vendor Agreement Dim. Code","No.") THEN BEGIN

                 //NC MLN17 > DP
                 IF "External Agreement No."<>'' THEN
                   DimValue.Name := COPYSTR("External Agreement No.",1,MAXSTRLEN(DimValue.Name))
                 ELSE
                 //NC MLN17 < DP

                 DimValue.Name := COPYSTR("No.",1,MAXSTRLEN(DimValue.Name));
                 IF Blocked > 0 THEN
                   DimValue.Blocked := TRUE
                 ELSE
                   DimValue.Blocked := FALSE;
                 //NC OAM45 > RD
                 DimValue.Marked := TRUE;
                 //NC OAM45 < RD
                 //NC NOS-26 > ENK
                 {
                 DimValue.MODIFY;
                 }
                 DimValue.MODIFY(TRUE);
                 //NC NOS-26 < ENK
               END;

               SynchroniseIt(1); // TD BMN 23.11.2012 NCS-712
               //TDRANCS-1405>
               GLSetup.GET;
               IF GLSetup."Create Deal for Agreement" THEN BEGIN
                 l_RecRef.GETTABLE(Rec);
                 IF Deal.fn_DealFromAgrCreate(l_RecRef) THEN "Deal No." := "No.";
               END;
               //TDRANCS-1405<
             END;

    OnDelete=VAR
               LaborContract@1210000 : Record 17360;
               CustAgreement@1101495002 : Record 14902;
               VendAgreement@1101495001 : Record 14901;
               IsDimDelete@1101495000 : Boolean;
             BEGIN
               VendLedgEntry.RESET;
               VendLedgEntry.SETRANGE("Vendor No.","Vendor No.");
               VendLedgEntry.SETRANGE("Agreement No.","No.");
               IF NOT VendLedgEntry.ISEMPTY THEN
                 ERROR(Text001);

               LaborContract.SETRANGE("Vendor No.","Vendor No.");
               LaborContract.SETRANGE("Vendor Agreement No.","No.");
               IF NOT LaborContract.ISEMPTY THEN
                 ERROR(Text17360);

               //NC OMCP02.1 > DP
               CustAgreement.SETRANGE("No.","No.");
               VendAgreement.SETFILTER("Vendor No.",'<>%1',"Vendor No.");
               VendAgreement.SETRANGE("No.","No.");
               IsDimDelete := CustAgreement.ISEMPTY AND VendAgreement.ISEMPTY;
               IF IsDimDelete THEN BEGIN
               //NC OMCP02.1 < DP
                 PurchSetup.GET;
                 //NC OMCP02 > DP
                 IF "Agreement Type"= "Agreement Type"::Trade THEN BEGIN
                   IF DimValue.GET(PurchSetup."Vend. Trade Agrmnt. Dim. Code","No.") THEN
                     DimValue.DELETE;
                 END ELSE
                 //NC OMCP02 < DP
                 IF DimValue.GET(PurchSetup."Vendor Agreement Dim. Code","No.") THEN
                   DimValue.DELETE;
               //NC OMCP02.1 > DP
               END;
               //NC OMCP02.1 < DP

               //NC MLN18 > DP
               AgreementDetail.RESET;
               AgreementDetail.SETRANGE("Source Type",AgreementDetail."Source Type"::Vendor);
               AgreementDetail.SETRANGE("Source No.","Vendor No.");
               AgreementDetail.SETRANGE("Agreement No.","No.");
               AgreementDetail.DELETEALL(TRUE);
               //NC MLN18 < DP

               //NC OAM31 > PCH
               DefaultDim2Adv.RESET;
               DefaultDim2Adv.SETRANGE("Table ID",DATABASE::"Vendor Agreement");
               DefaultDim2Adv.SETRANGE("Source No.","Vendor No.");
               DefaultDim2Adv.SETRANGE("No.","No.");
               DefaultDim2Adv.DELETEALL;
               //NC OAM31 < PCH
             END;

    OnRename=BEGIN
               ERROR(Text003,TABLECAPTION);
             END;

    CaptionML=[ENU=Vendor Agreement;
               RUS=Договор поставщика];
    LookupPageID=Page14913;
    DrillDownPageID=Page14913;
  }
  FIELDS
  {
    { 1   ;   ;Vendor No.          ;Code20        ;TableRelation=Vendor;
                                                   CaptionML=[ENU=Vendor No.;
                                                              RUS=Код поставщика] }
    { 2   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  Vend.GET("Vendor No.");
                                                                  NoSeriesMgt.TestManual(Vend."Agreement Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              RUS=Номер] }
    { 3   ;   ;Description         ;Text250       ;CaptionML=[ENU=Description;
                                                              RUS=Описание] }
    { 4   ;   ;External Agreement No.;Text30      ;CaptionML=[ENU=External Agreement No.;
                                                              RUS=Номер внешнего договора] }
    { 5   ;   ;Agreement Date      ;Date          ;CaptionML=[ENU=Agreement Date;
                                                              RUS=Дата договора] }
    { 6   ;   ;Active              ;Boolean       ;CaptionML=[ENU=Active;
                                                              RUS=Активно] }
    { 7   ;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                CheckDates;
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              RUS=Дата начала] }
    { 8   ;   ;Expire Date         ;Date          ;OnValidate=VAR
                                                                l_RecRef@1101495000 : RecordRef;
                                                              BEGIN
                                                                CheckDates;
                                                                //TDRANCS-1479>
                                                                GLSetup.GET;
                                                                IF GLSetup."Create Deal for Agreement" THEN BEGIN
                                                                  l_RecRef.GETTABLE(Rec);
                                                                  IF Deal.fn_DealFromAgrUpdate(l_RecRef) THEN "Deal No." := "No.";
                                                                END;
                                                                //TDRANCS-1479<
                                                              END;

                                                   CaptionML=[ENU=Expire Date;
                                                              RUS=Дата окончания];
                                                   Description=TDRANCS-1479 }
    { 9   ;   ;Agreement Group     ;Code20        ;TableRelation="Agreement Group".Code WHERE (Type=CONST(Purchases));
                                                   CaptionML=[ENU=Agreement Group;
                                                              RUS=Группа договоров] }
    { 12  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Purch. Comment Line" WHERE (Document Type=CONST(Agreement),
                                                                                                  No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              RUS=Комментарий] }
    { 14  ;   ;Contact             ;Text50        ;CaptionML=[ENU=Contact;
                                                              RUS=Контакт] }
    { 15  ;   ;Phone No.           ;Text30        ;CaptionML=[ENU=Phone No.;
                                                              RUS=Телефон] }
    { 16  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=VAR
                                                                DefDim@1101495001 : Record 50128;
                                                                GLSetUp@1101495000 : Record 98;
                                                              BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");

                                                                //NCS-2406 > AAP
                                                                GLSetUp.GET;
                                                                DefDim.SETRANGE("Table ID",DATABASE::"Vendor Agreement");
                                                                DefDim.SETRANGE("Source No.","Vendor No.");
                                                                DefDim.SETRANGE("No.","No.");
                                                                DefDim.SETRANGE("Dimension Code",GLSetUp."Global Dimension 1 Code");
                                                                DefDim.MODIFYALL("Value Posting",DefDim."Value Posting"::"Same Code");
                                                                //NCS-2406 < AAP
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              RUS=Код глобального измерения 1];
                                                   CaptionClass='1,1,1' }
    { 17  ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              RUS=Код глобального измерения 2];
                                                   CaptionClass='1,1,2' }
    { 21  ;   ;Vendor Posting Group;Code10        ;TableRelation="Vendor Posting Group";
                                                   OnValidate=BEGIN
                                                                IF ("Vendor Posting Group" <> xRec."Vendor Posting Group")

                                                                //NC NCS-1559 > DP
                                                                AND (xRec."Vendor Posting Group"<>'')
                                                                //NC NCS-1559 < DP

                                                                THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  IF NOT PurchSetup."Allow Alter Posting Groups" THEN
                                                                    ERROR(Text12401,FIELDCAPTION("Vendor Posting Group"),
                                                                      PurchSetup.FIELDCAPTION("Allow Alter Posting Groups"),PurchSetup.TABLECAPTION);
                                                                END;

                                                                //NC MLN09.5 > DP
                                                                IF ("Agreement Type"="Agreement Type"::Loans) THEN BEGIN
                                                                  VendPostingGroup.RESET;
                                                                  VendPostingGroup.SETRANGE("Loan Princ/Int. Posting Group","Vendor Posting Group");
                                                                  VendPostingGroup.SETRANGE("Loan Interest",TRUE);
                                                                  IF VendPostingGroup.FINDFIRST THEN
                                                                    "Interest Posting Group" := VendPostingGroup.Code;
                                                                END;
                                                                //NC MLN09.5 > DP
                                                              END;

                                                   CaptionML=[ENU=Vendor Posting Group;
                                                              RUS=Учетная группа поставщика];
                                                   Description=[ MLN09.5] }
    { 22  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Code;
                                                              RUS=Код валюты] }
    { 24  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[ENU=Language Code;
                                                              RUS=Код языка] }
    { 27  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   CaptionML=[ENU=Payment Terms Code;
                                                              RUS=Код условий платежа] }
    { 29  ;   ;Purchaser Code      ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Purchaser Code;
                                                              RUS=Код менеджера] }
    { 35  ;   ;Prices Including VAT;Boolean       ;CaptionML=[ENU=Prices Including VAT;
                                                              RUS=Цены с учетом НДС] }
    { 39  ;   ;Blocked             ;Option        ;CaptionML=[ENU=Blocked;
                                                              RUS=Заблокировано];
                                                   OptionCaptionML=[ENU=" ,Payment,All";
                                                                    RUS=" ,Платеж,Все"];
                                                   OptionString=[ ,Payment,All] }
    { 46  ;   ;Priority            ;Integer       ;CaptionML=[ENU=Priority;
                                                              RUS=Приоритет] }
    { 47  ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   CaptionML=[ENU=Payment Method Code;
                                                              RUS=Код способа оплаты] }
    { 55  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              RUS=Фильтр по дате] }
    { 56  ;   ;Global Dimension 1 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Filter;
                                                              RUS=Фильтр глобального измерения 1];
                                                   CaptionClass='1,3,1' }
    { 57  ;   ;Global Dimension 2 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Global Dimension 2 Filter;
                                                              RUS=Фильтр глобального измерения 2];
                                                   CaptionClass='1,3,2' }
    { 58  ;   ;Balance             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(Vendor No.),
                                                                                                                Agreement No.=FIELD(No.),
                                                                                                                Vendor Posting Group=FIELD(Posting Group Filter)));
                                                   CaptionML=[ENU=Balance;
                                                              RUS=Сальдо];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 59  ;   ;Balance (LCY)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(Vendor No.),
                                                                                                                        Agreement No.=FIELD(No.),
                                                                                                                        Vendor Posting Group=FIELD(Posting Group Filter)));
                                                   CaptionML=[ENU=Balance (LCY);
                                                              RUS=Сальдо (руб.)];
                                                   Description=NOS-26;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   CaptionClass=['1,11,1,14901,59' ] }
    { 60  ;   ;Net Change          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(Vendor No.),
                                                                                                               Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                               Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                               Posting Date=FIELD(Date Filter),
                                                                                                               Agreement No.=FIELD(No.)));
                                                   CaptionML=[ENU=Net Change;
                                                              RUS=Оборот];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Net Change (LCY)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(Vendor No.),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Agreement No.=FIELD(No.)));
                                                   CaptionML=[ENU=Net Change (LCY);
                                                              RUS=Оборот (руб.)];
                                                   Description=NOS-26;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   CaptionClass=['1,11,1,14901,61' ] }
    { 88  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    VALIDATE("VAT Bus. Posting Group",GenBusPostingGrp."Def. VAT Bus. Posting Group");
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              RUS=Общая бизнес-группа] }
    { 95  ;   ;Order Address Code  ;Code10        ;TableRelation="Order Address".Code WHERE (Vendor No.=FIELD(Vendor No.));
                                                   CaptionML=[ENU=Order Address Code;
                                                              RUS=Код адреса заказа] }
    { 97  ;   ;Debit Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Debit Amount" WHERE (Vendor No.=FIELD(Vendor No.),
                                                                                                                       Entry Type=FILTER(<>Application),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Agreement No.=FIELD(No.)));
                                                   CaptionML=[ENU=Debit Amount;
                                                              RUS=Сумма по дебету];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 98  ;   ;Credit Amount       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Credit Amount" WHERE (Vendor No.=FIELD(Vendor No.),
                                                                                                                        Entry Type=FILTER(<>Application),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Agreement No.=FIELD(No.)));
                                                   CaptionML=[ENU=Credit Amount;
                                                              RUS=Сумма по кредиту];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 99  ;   ;Debit Amount (LCY)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Debit Amount (LCY)" WHERE (Vendor No.=FIELD(Vendor No.),
                                                                                                                             Entry Type=FILTER(<>Application),
                                                                                                                             Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                             Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                             Posting Date=FIELD(Date Filter),
                                                                                                                             Agreement No.=FIELD(No.)));
                                                   CaptionML=[ENU=Debit Amount (LCY);
                                                              RUS=Сумма по дебету (руб.)];
                                                   BlankZero=Yes;
                                                   Description=NOS-26;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   CaptionClass=['1,11,1,14901,99' ] }
    { 100 ;   ;Credit Amount (LCY) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Vendor Ledg. Entry"."Credit Amount (LCY)" WHERE (Vendor No.=FIELD(Vendor No.),
                                                                                                                              Entry Type=FILTER(<>Application),
                                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                                              Agreement No.=FIELD(No.)));
                                                   CaptionML=[ENU=Credit Amount (LCY);
                                                              RUS=Сумма по кредиту (руб.)];
                                                   BlankZero=Yes;
                                                   Description=NOS-26;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   CaptionClass=['1,11,1,14901,100' ] }
    { 102 ;   ;E-Mail              ;Text80        ;CaptionML=[ENU=Email;
                                                              RUS=Эл. почта] }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              RUS=Серия номеров] }
    { 110 ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              RUS=НДС бизнес-группа] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Responsibility Center;
                                                              RUS=Центр ответственности] }
    { 5701;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[ENU=Location Code;
                                                              RUS=Код склада] }
    { 12400;  ;Default Bank Code   ;Code10        ;TableRelation="Vendor Bank Account".Code WHERE (Vendor No.=FIELD(Vendor No.));
                                                   CaptionML=[ENU=Default Bank Code;
                                                              RUS=Код банка по умолчанию] }
    { 12411;  ;VAT Agent Prod. Posting Group;Code10;
                                                   TableRelation="VAT Product Posting Group";
                                                   CaptionML=[ENU=VAT Agent Prod. Posting Group;
                                                              RUS=НДС товарная группа налогового агента] }
    { 12412;  ;VAT Payment Source Type;Option     ;CaptionML=[ENU=VAT Payment Source Type;
                                                              RUS=Тип источника оплаты НДС];
                                                   OptionCaptionML=[ENU=Vendor Funds,Internal Funds;
                                                                    RUS=Фонды поставщика,Внутренние фонды];
                                                   OptionString=Vendor Funds,Internal Funds }
    { 12414;  ;Tax Authority No.   ;Code20        ;TableRelation=Vendor WHERE (Vendor Type=CONST(Tax Authority));
                                                   CaptionML=[ENU=Tax Authority No.;
                                                              RUS=Код налог. органа] }
    { 12425;  ;G/L Account Filter  ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="G/L Account";
                                                   CaptionML=[ENU=G/L Account Filter;
                                                              RUS=Фильтр по счету ГК] }
    { 12426;  ;G/L Starting Date Filter;Date      ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=G/L Starting Date Filter;
                                                              RUS=ГК - фильтр по дате начала] }
    { 12427;  ;G/L Starting Balance;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("G/L Entry".Amount WHERE (Source Type=CONST(Vendor),
                                                                                             Source No.=FIELD(Vendor No.),
                                                                                             Agreement No.=FIELD(No.),
                                                                                             G/L Account No.=FIELD(G/L Account Filter),
                                                                                             Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                             Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                             Posting Date=FIELD(UPPERLIMIT(G/L Starting Date Filter))));
                                                   CaptionML=[ENU=G/L Starting Balance;
                                                              RUS=ГК - начальное сальдо];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 12428;  ;G/L Net Change      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("G/L Entry".Amount WHERE (Source Type=CONST(Vendor),
                                                                                             Source No.=FIELD(Vendor No.),
                                                                                             Agreement No.=FIELD(No.),
                                                                                             G/L Account No.=FIELD(G/L Account Filter),
                                                                                             Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                             Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                             Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=G/L Net Change;
                                                              RUS=Оборот по ГК];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 12429;  ;G/L Debit Amount    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("G/L Entry"."Debit Amount" WHERE (Source Type=CONST(Vendor),
                                                                                                     Source No.=FIELD(Vendor No.),
                                                                                                     G/L Account No.=FIELD(G/L Account Filter),
                                                                                                     Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                     Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                     Agreement No.=FIELD(No.),
                                                                                                     Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=G/L Debit Amount;
                                                              RUS=ГК - сумма по дебету];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 12430;  ;G/L Credit Amount   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("G/L Entry"."Credit Amount" WHERE (Source Type=CONST(Vendor),
                                                                                                      Source No.=FIELD(Vendor No.),
                                                                                                      G/L Account No.=FIELD(G/L Account Filter),
                                                                                                      Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                      Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                      Agreement No.=FIELD(No.),
                                                                                                      Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=G/L Credit Amount;
                                                              RUS=ГК - сумма по кредиту];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 12431;  ;G/L Balance to Date ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("G/L Entry".Amount WHERE (Source Type=CONST(Vendor),
                                                                                             Source No.=FIELD(Vendor No.),
                                                                                             G/L Account No.=FIELD(G/L Account Filter),
                                                                                             Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                             Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                             Agreement No.=FIELD(No.),
                                                                                             Posting Date=FIELD(UPPERLIMIT(Date Filter))));
                                                   CaptionML=[ENU=G/L Balance to Date;
                                                              RUS=ГК - сальдо на данное число];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 50000;  ;Agreement Type      ;Option        ;OnValidate=BEGIN
                                                                //TD BMN 03.07.2013 NCS-1048 >
                                                                CASE "Agreement Type" OF
                                                                 "Agreement Type"::Loans: BEGIN
                                                                                            "Type Deal" := 'LOAN';
                                                                                            //TDRANCS-1405>
                                                                                            //"Deal No." := '';
                                                                                            //TDRANCS-1405>
                                                                                          END;
                                                                 "Agreement Type"::Standard: BEGIN
                                                                                              "Type Deal" := '';
                                                                                              //TDRANCS-1405>
                                                                                              //"Deal No." := '';
                                                                                              //TDRANCS-1405<
                                                                                             END;
                                                                END;
                                                                //TD BMN 03.07.2013 NCS-1048 <

                                                                //TDRANCS-1207>
                                                                IF "Type Deal" = '' THEN
                                                                  IF g_recDealType.GET('UNKNOWN') THEN
                                                                    "Type Deal" := g_recDealType.Code;
                                                                //TDRANCS-1207<
                                                              END;

                                                   CaptionML=[ENU=Agreement Type;
                                                              RUS=Договор Тип];
                                                   OptionCaptionML=[ENU=Standard,Trade,Loans,FX MM Loan;
                                                                    RUS=Стандартный,Торговый,Кредиты и Займы,FX MM Займ];
                                                   OptionString=Standard,Trade,Loans,FX MM Loan;
                                                   Description=NC TR198 DP,TDRANCS-1515 }
    { 50001;  ;Agreement Amount    ;Decimal       ;CaptionML=[ENU=Agreement Amount;
                                                              RUS=Договор Сумма];
                                                   Description=NC TR198 DP }
    { 50003;  ;Text 1              ;Text80        ;OnValidate=BEGIN
                                                                "Text 1"  := GetNewText("Text 1");
                                                              END;

                                                   OnLookup=VAR
                                                              StdText@1000000000 : Record 7;
                                                            BEGIN
                                                              //NC NOS-26 > ENK
                                                              {
                                                              IF FORM.RUNMODAL(0,StdText) = ACTION::LookupOK THEN
                                                              }
                                                              IF PAGE.RUNMODAL(0,StdText) = ACTION::LookupOK THEN
                                                              //NC NOS-26 < ENK
                                                                "Text 1" := GetNewText(StdText.Description);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Purpose of Payment;
                                                              RUS=Назначение Платежа] }
    { 50005;  ;Interest Posting Group;Code10      ;TableRelation="Vendor Posting Group" WHERE (Loan Interest=CONST(Yes));
                                                   CaptionML=[ENU=Interest Posting Group;
                                                              RUS=Проценты Учетная Группа];
                                                   Description=NC MLN09.5 DP }
    { 50009;  ;Type Deal           ;Code20        ;TableRelation="Deal Type";
                                                   CaptionML=[ENU=Type Deal;
                                                              RUS=Тип Сделки];
                                                   Description=NCS-1048;
                                                   Editable=No }
    { 50010;  ;Deal No.            ;Code20        ;TableRelation=Deal."Deal ID";
                                                   OnValidate=BEGIN
                                                                //TD BMN 03.07.2013 NCS-1048 >
                                                                IF Deal.GET("Deal No.") THEN
                                                                  "Type Deal" := Deal."Type Deal"
                                                                ELSE
                                                                  "Type Deal" := '';
                                                                //TD BMN 03.07.2013 NCS-1048 <

                                                                //TDRANCS-1207>
                                                                IF "Type Deal" = '' THEN
                                                                  IF g_recDealType.GET('UNKNOWN') THEN
                                                                    "Type Deal" := g_recDealType.Code;
                                                                //TDRANCS-1207<
                                                              END;

                                                   CaptionML=[ENU=Deal No.;
                                                              RUS=Сделка Но.];
                                                   Description=NC MTD01 RD }
    { 50011;  ;Interest Rate       ;Decimal       ;CaptionML=[ENU=Interest Rate;
                                                              RUS=Процентная Ставка];
                                                   DecimalPlaces=2:7;
                                                   Description=TD NCS-712 }
    { 50012;  ;Interest Rate Type  ;Option        ;CaptionML=[ENU=Interest Rate Type;
                                                              RUS=Тип Процентной Ставки];
                                                   OptionCaptionML=[ENU=Simple,Fix.Ext.+Simple,Variable Ext.,Complex;
                                                                    RUS=Простой %,Фикс.Внеш.%+Простой%,Перемен.Внеш.%,Сложный %];
                                                   OptionString=Simple,Fix.Ext.+Simple,Variable Ext.,Complex;
                                                   Description=TD NCS-712 }
    { 50013;  ;Agreement Detail Finish Date;Date  ;FieldClass=FlowField;
                                                   CalcFormula=Max("Agreement Detail"."Finish Date" WHERE (Source Type=CONST(Vendor),
                                                                                                           Source No.=FIELD(Vendor No.),
                                                                                                           Agreement No.=FIELD(No.),
                                                                                                           Condition Type=CONST(New),
                                                                                                           Blocked=CONST(No)));
                                                   CaptionML=[ENU=Agreement Detail Finish Date;
                                                              RUS=Дата Окончания По Условию Договора];
                                                   Description=NCS-1050 }
    { 50015;  ;Reserve             ;Boolean       ;CaptionML=[ENU=Reserve Accrual;
                                                              RUS=Начислять Резерв];
                                                   Description=NC NCS-1268 DP }
    { 50020;  ;Reserve %           ;Decimal       ;CaptionML=[ENU=Reserve %;
                                                              RUS=Резерв %];
                                                   Description=NC NCS-1268 DP }
    { 50025;  ;Reserve Posting Group;Code10       ;TableRelation="Vendor Posting Group" WHERE (Loan Reserve=CONST(Yes));
                                                   CaptionML=[ENU=Reserve Posting Group;
                                                              RUS=Резерв Учетная Группа];
                                                   Description=NC NCS-1268 DP }
    { 50030;  ;Reserve % Posting Group;Code10     ;TableRelation="Vendor Posting Group" WHERE (Loan Reserve=CONST(Yes));
                                                   CaptionML=[ENU=Reserve % Posting Group;
                                                              RUS=Резерв Проценты Учетная Группа];
                                                   Description=NC NCS-1268 DP }
    { 50050;  ;Posting Group Filter;Code20        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Posting Group Filter;
                                                              RUS=Учетная Группа Фильтр];
                                                   Description=NC NCS 1597 }
  }
  KEYS
  {
    {    ;Vendor No.,No.                          ;Clustered=Yes }
    {    ;Agreement Group,No.                      }
    {    ;No.                                      }
    {    ;Agreement Type,Currency Code,Vendor Posting Group,Vendor No.,No. }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1210001 : TextConst 'ENU=You cannot delete agreement if you already have ledger entries.;RUS=Невозможно удалить договор, если уже имеются операции ГК.';
      PurchSetup@1210002 : Record 312;
      Vend@1210004 : Record 23;
      VendLedgEntry@1470002 : Record 25;
      DimValue@1210006 : Record 349;
      GenBusPostingGrp@1210009 : Record 250;
      DefaultDim@1210011 : Record 352;
      DefaultDim2@1210012 : Record 352;
      VendAgrmt@1210015 : Record 14901;
      NoSeriesMgt@1470000 : Codeunit 396;
      DimMgt@1210003 : Codeunit 408;
      Text003@1210014 : TextConst 'ENU=You cannot rename %1.;RUS=Переименование %1 невозможно.';
      Text005@1210008 : TextConst 'ENU=post;RUS=учесть';
      Text006@1210007 : TextConst 'ENU=create;RUS=создать';
      Text007@1210005 : TextConst 'ENU=You cannot %1 this type of document when Vendor %2 is blocked with type %3.;RUS=Нельзя %1 этот тип документа, пока поставщик %2 заблокирован с типом %3';
      Text12400@1210013 : TextConst 'ENU=Agreement;RUS=Договор';
      Text12401@1210010 : TextConst 'ENU=You cannot change %1 until you check %2 in %3.;RUS=Невозможно изменить %1 до проверки %2 в %3.';
      Text12402@1210000 : TextConst 'ENU=%1 should be later than %2.;RUS=%1 должно следовать за %2.';
      Text12403@1210016 : TextConst 'ENU=This %1 already used for vendor %2.;RUS=Этот %1 уже используется для поставщика %2.';
      Text17360@1210017 : TextConst 'ENU=You cannot delete agreement if you already have labor contracts.;RUS=Невозможно удалить договор, если уже имеются трудовые договоры.';
      ">>>NOS-26"@1101495007 : Integer;
      "NCV>"@1101495006 : Integer;
      VendPostingGroup@1101495005 : Record 93;
      GLSetup@1101495004 : Record 98;
      "NCV<"@1101495003 : Integer;
      CurrCompany@1101495002 : Text[30];
      Deal@1101495001 : Record 50037;
      g_recDealType@1101495000 : Record 50038;
      DefaultDim2Adv@1101495009 : Record 50128;
      AgreementDetail@1101495010 : Record 50096;
      "<<<NOS-26"@1101495008 : Integer;

    PROCEDURE AssistEdit@2(OldVendAgreement@1000 : Record 14901) : Boolean;
    BEGIN
      Vend.GET("Vendor No.");
      Vend.TESTFIELD("Agreement Nos.");
      IF NoSeriesMgt.SelectSeries(Vend."Agreement Nos.",OldVendAgreement."No. Series","No. Series") THEN BEGIN
        NoSeriesMgt.SetSeries("No.");
        EXIT(TRUE);
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      //NC DP 270912 >
      {
      DimMgt.SaveDefaultDim(DATABASE::"Vendor Agreement","No.",FieldNumber,ShortcutDimCode);
      }
      DefaultDim2Adv.INIT;
      DefaultDim2Adv."Table ID" := DATABASE::"Vendor Agreement";
      DefaultDim2Adv."Source No." := "Vendor No.";
      DefaultDim2Adv."No." := "No.";
      GLSetup.GET;
      IF FieldNumber=1 THEN
      DefaultDim2Adv."Dimension Code" := GLSetup."Global Dimension 1 Code";
      IF  FieldNumber=2 THEN
      DefaultDim2Adv."Dimension Code" := GLSetup."Global Dimension 2 Code";
      DefaultDim2Adv."Dimension Value Code" := ShortcutDimCode;

      //TD BMN 27.06.2013 NCS-1065 >
      //IF NOT DefaultDim2Adv.INSERT THEN ;
      IF NOT DefaultDim2Adv.INSERT THEN
        DefaultDim2Adv.MODIFY;
      //TD BMN 27.06.2013 NCS-1065 <

      //NC DP 270912 <
      MODIFY;
    END;

    PROCEDURE LookupShortcutDimCode@28(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::"Vendor Agreement","No.",FieldNumber,ShortcutDimCode);
    END;

    PROCEDURE CheckBlockedVendOnDocs@4(Vend2@1003 : Record 23;Transaction@1000 : Boolean);
    BEGIN
      IF Vend2.Blocked = Vend2.Blocked::All THEN
        VendBlockedErrorMessage(Vend2,Transaction);
    END;

    PROCEDURE CheckBlockedVendOnJnls@5(Vend2@1005 : Record 23;DocType@1004 : ' ,Payment,Invoice,Credit Memo,Finance Charge,Reminder,Refund';Transaction@1003 : Boolean);
    BEGIN
      IF (Vend2.Blocked = Vend2.Blocked::All) OR
         (Vend2.Blocked = Vend2.Blocked::Payment) AND (DocType = DocType::Payment)
      THEN
        VendBlockedErrorMessage(Vend2,Transaction);
    END;

    PROCEDURE VendBlockedErrorMessage@6(Vend2@1001 : Record 23;Transaction@1002 : Boolean);
    VAR
      Action@1000 : Text[30];
    BEGIN
      IF Transaction THEN
        Action := Text005
      ELSE
        Action := Text006;
      ERROR(Text007,Action,Vend2."No.",Vend2.Blocked);
    END;

    PROCEDURE VendTransferFields@1210000();
    BEGIN
      Contact := Vend.Contact;
      "Phone No." := Vend."Phone No.";
      "E-Mail" := Vend."E-Mail";
      Blocked := Vend.Blocked;

      //NC NCS-1131 > DP
      IF (Vend."Vendor Posting Group"<>'') AND ("Vendor Posting Group"='') THEN
      //NC NCS-1131 < DP

      "Vendor Posting Group" := Vend."Vendor Posting Group";
      "Gen. Bus. Posting Group" := Vend."Gen. Bus. Posting Group";
      "VAT Bus. Posting Group" := Vend."VAT Bus. Posting Group";
      "Global Dimension 1 Code" := Vend."Global Dimension 1 Code";
      "Global Dimension 2 Code" := Vend."Global Dimension 2 Code";
      "Currency Code" := Vend."Currency Code";
      "Prices Including VAT" := Vend."Prices Including VAT";
      "Language Code" := Vend."Language Code";
      "Payment Terms Code" := Vend."Payment Terms Code";
      "Payment Method Code" := Vend."Payment Method Code";
      "Purchaser Code" := Vend."Purchaser Code";
      "Location Code" := Vend."Location Code";
      "Responsibility Center" := Vend."Responsibility Center";
      "Default Bank Code" := Vend."Default Bank Code";
    END;

    PROCEDURE VendTransferDimensions@1210003();
    BEGIN
      DefaultDim.RESET;
      DefaultDim.SETRANGE("Table ID",DATABASE::Vendor);
      DefaultDim.SETRANGE("No.","Vendor No.");
      IF DefaultDim.FINDSET THEN
        REPEAT
          //NC OAM31 > PCH
          {
          DefaultDim2.INIT;
          DefaultDim2."Table ID" := DATABASE::"Vendor Agreement";
          DefaultDim2."No." := "No.";
          DefaultDim2."Dimension Code" := DefaultDim."Dimension Code";
          DefaultDim2."Dimension Value Code" := DefaultDim."Dimension Value Code";
          DefaultDim2."Value Posting" := DefaultDim."Value Posting";
          // NC MTD02 > AIG
          {
          DefaultDim2.INSERT;
           }
          IF DefaultDim2.INSERT THEN;
          // NC MTD02 < AIG
          }
          //NC OAM31 > PCH
          DefaultDim2Adv.INIT;
          DefaultDim2Adv."Table ID" := DATABASE::"Vendor Agreement";
          DefaultDim2Adv."Source No." := "Vendor No.";
          DefaultDim2Adv."No." := "No.";
          DefaultDim2Adv."Dimension Code" := DefaultDim."Dimension Code";
          DefaultDim2Adv."Dimension Value Code" := DefaultDim."Dimension Value Code";
          DefaultDim2Adv."Value Posting" := DefaultDim."Value Posting";
          IF DefaultDim2Adv.INSERT THEN;
          //NC OAM31 < PCH
        UNTIL DefaultDim.NEXT = 0;
    END;

    PROCEDURE CheckDates@1210001();
    BEGIN
      IF ("Expire Date" <> 0D) AND ("Starting Date" <> 0D) AND ("Expire Date" < "Starting Date") THEN
        ERROR(Text12402,FIELDCAPTION("Expire Date"),FIELDCAPTION("Starting Date"));
    END;

    PROCEDURE GetDefaultDimSetID@1210005(DimSetID@1210003 : Integer;VAR ShortcutDim1Code@1210002 : Code[20];VAR ShortcutDim2Code@1210001 : Code[20]) : Integer;
    VAR
      AgrmtMgt@1210000 : Codeunit 12421;
      DimSetIDArr@1210004 : ARRAY [10] OF Integer;
    BEGIN
      DimSetIDArr[1] := DimSetID;
      DimSetIDArr[2] := AgrmtMgt.GetAgrmtDefaultDimSetID(DATABASE::"Vendor Agreement","No.");
      EXIT(
        DimMgt.GetCombinedDimensionSetID(
          DimSetIDArr,ShortcutDim1Code,ShortcutDim2Code));
    END;

    PROCEDURE GetDefaultAdvDimSetID@1101495000(DimSetID@1210001 : Integer;VAR ShortcutDim1Code@1210002 : Code[20];VAR ShortcutDim2Code@1210003 : Code[20]) : Integer;
    VAR
      AgrmtMgt@1210000 : Codeunit 12421;
      DimSetIDArr@1210004 : ARRAY [10] OF Integer;
    BEGIN
      //NC NOS-26 > ENK
      DimSetIDArr[1] := DimSetID;
      DimSetIDArr[2] := AgrmtMgt.GetAgrmtDefaultAdvDimSetID(DATABASE::"Vendor Agreement", "Vendor No.", "No.");
      EXIT(
        DimMgt.GetCombinedDimensionSetID(
          DimSetIDArr,ShortcutDim1Code,ShortcutDim2Code));
      //NC NOS-26 < ENK
    END;

    LOCAL PROCEDURE ">NOS-26"@1101495003();
    BEGIN
    END;

    PROCEDURE "NCF>"@1000000000();
    BEGIN
    END;

    PROCEDURE GetNewText@1000000001(TextStr@1210012 : Text[1024]) : Text[80];
    VAR
      CashAccount@1210007 : Record 270;
      StdRepMgt@1210006 : Codeunit 12401;
      MaxDecPoints@1210005 : Integer;
      VATAmount@1210003 : Decimal;
      Result@1210002 : Text[1024];
      GLEntry@1210001 : Record 17;
      Date@1210000 : Date;
    BEGIN
      Result := STRSUBSTNO(TextStr, "External Agreement No.","Agreement Date");
      EXIT(COPYSTR(Result,1,80));
    END;

    PROCEDURE "NCF<"@1000000002();
    BEGIN
    END;

    PROCEDURE SetCurrCompany@1101495001(NewCurrCompany@1101495000 : Text[30]);
    BEGIN
      //NC OAM31 > PCH
      CurrCompany := NewCurrCompany;
      //NC OAM31 < PCH
    END;

    PROCEDURE SynchroniseIt@1000000003(Mode@1000000000 : 'Insert,Modify,Delete,Rename');
    VAR
      SyncLog@1000000005 : Record 50121;
      Recref@1000000006 : RecordRef;
      xRecref@1000000004 : RecordRef;
      isDone@1000000007 : Boolean;
      AgreementDetail@1000000001 : Record 50096;
    BEGIN
      // TD BMN 23.11.2012 NCS-712
      xRecref.GETTABLE(xRec);
      xRecref.SETRECFILTER;
      Recref.GETTABLE(Rec);
      Recref.SETRECFILTER;

      SyncLog.Synchronise(Mode, xRecref, Recref);
    END;

    LOCAL PROCEDURE "<NOS-26"@1101495004();
    BEGIN
    END;

    BEGIN
    {
      NC TR198 DP Добавлены поля "Agreement Type", "Agreement Amount"
      NC MTD01 RD Добавлено поле "Deal No."
      NC MTD02 AIG Изменения в коде
      NC OMCP02 DP Добавление аналитики по договор в зависимости от его типа
      NC MLN17 DP Наименование аналитики указывается по внеш. номеру договора
      NC MLN18 DP Удаление деталей договора при удалении последнего
      NC MLN09.5 DP Добавлено поле "Interest Posting Group"
      NC OAM22 DP Изменено свойство Caption Class полей ..(LCY)
      NC OAM31 PCH Перевод измерений по умолчанию на таблицу Default Dimension Advanced
      NC OAM45 RD Установка флага Marked для Dimension Value для неторговых договоров
      TD BMN 23.11.2012 NCS-712 "Интеграция данных из договоров OFF - IFRS"
      TD BMN 27.06.2013 NCS-1065 "Пакетное задание по начислению %% некорректно проставляет измерение СС в строках фин. журнала"
                        Синхронизировал изменение костцентра в карточке с обязательным измерением для договора
      TD BMN 02.07.2013 NCS-1050 "Добавить поле "Дата Окончания" в реестр кредитов выданных и полученных"
      TD BMN 03.07.2013 NCS-1048 "Изменение алгоритма синхронизации поля тип сделки OFF->MIS "
      TDRANCS-1207>
        Modified OnInsert, OnValidate - "Agreement Type", "Deal No."
      NC NCS-1131 DP Изменена функция VendTransferFields
      NC NCS-1268 DP Added Fields 50015-50030
      TDRANCS-1405>
        Modified OnModify, OnValidate for Agreement Type
      TDRANCS-1479>
        Modified OnValidate "Expire Date"
      TDRANCS-1515>
        Modified "Agreement Type" added FX MM Loan
      NC NCS-1559 DP Изменен триггер "Vendor Posting Group" - OnValidate
      --------------------------
      BLD001 DP Создан билд, включающий модификации OAM31,OAM45,S1065,S1050,S1048,S1207,S1268,S1131,S1405,1479,S1515,NCS-1559
      NC NCS 1597 DP Дабавлено поле Posting Group Filter, изменены поля: Balance, Balance (LCY)
      NCS-2406 AAP: Изменен триггер OnValidate поля "Global Dimension 1 Code"
      --------------------------
      NOS-26 ENK Copy function GetDefaultAdvDimSetID from table 14902
    }
    END.
  }
}

