OBJECT Table 17211 Tax Register FA Entry
{
  OBJECT-PROPERTIES
  {
    Date=09.09.14;
    Time=12:00:00;
    Version List=NAVRU8.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Tax Register FA Entry;
               RUS=Операция по ОС налогового регистра];
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              RUS=Номер операции] }
    { 2   ;   ;Section Code        ;Code10        ;TableRelation="Tax Register Section";
                                                   CaptionML=[ENU=Section Code;
                                                              RUS=Код секции] }
    { 3   ;   ;FA No.              ;Code20        ;TableRelation="Fixed Asset";
                                                   CaptionML=[ENU=FA No.;
                                                              RUS=Номер ОС] }
    { 4   ;   ;Starting Date       ;Date          ;CaptionML=[ENU=Starting Date;
                                                              RUS=Дата начала] }
    { 5   ;   ;Ending Date         ;Date          ;CaptionML=[ENU=Ending Date;
                                                              RUS=Дата окончания] }
    { 38  ;   ;Where Used Register IDs;Code61     ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Where Used Register IDs;
                                                              RUS=Коды регистра применимости];
                                                   Editable=No }
    { 50  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              RUS=Фильтр по дате] }
    { 60  ;   ;Depreciation Book Code;Code10      ;TableRelation="Depreciation Book".Code;
                                                   CaptionML=[ENU=Depreciation Book Code;
                                                              RUS=Код книги амортизации] }
    { 61  ;   ;Acquisition Cost    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Acquisition Cost),
                                                                                                   FA Posting Date=FIELD(UPPERLIMIT(Date Filter))));
                                                   CaptionML=[ENU=Acquisition Cost;
                                                              RUS=Стоимость приобретения];
                                                   Editable=No }
    { 62  ;   ;Valuation Changes   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=FILTER(Write-Down|Appreciation),
                                                                                                   FA Posting Date=FIELD(UPPERLIMIT(Date Filter))));
                                                   CaptionML=[ENU=Valuation Changes;
                                                              RUS=Изменение первоначальной стоимости];
                                                   Editable=No }
    { 63  ;   ;Depreciation Group  ;Code10        ;CaptionML=[ENU=Depreciation Group;
                                                              RUS=Группа амортизации];
                                                   Editable=No }
    { 64  ;   ;Depreciation Method ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("FA Depreciation Book"."Depreciation Method" WHERE (FA No.=FIELD(FA No.),
                                                                                                                          Depreciation Book Code=FIELD(Depreciation Book Code)));
                                                   CaptionML=[ENU=Depreciation Method;
                                                              RUS=Метод амортизации];
                                                   OptionCaptionML=[ENU=Straight-Line,Declining-Balance 1,Declining-Balance 2,DB1/SL,DB2/SL,User-Defined,Manual,SL-RU,DB/SL-RU,DB/SL-RU Tax Group;
                                                                    RUS=Линейный,Уменьш. остатка 1,Уменьш. остатка 2,Ум. ост. 1/линейный,Ум. ост. 2/линейный,Пользовательский,Вручную,Линейный (Россия),Ум. ост./лин. (Россия),Ум. ост./лин. (Россия) - группа нал.];
                                                   OptionString=Straight-Line,Declining-Balance 1,Declining-Balance 2,DB1/SL,DB2/SL,User-Defined,Manual,SL-RU,DB/SL-RU,DB/SL-RU Tax Group;
                                                   Editable=No }
    { 65  ;   ;No. of Depreciation Months;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("FA Depreciation Book"."No. of Depreciation Months" WHERE (FA No.=FIELD(FA No.),
                                                                                                                                 Depreciation Book Code=FIELD(Depreciation Book Code)));
                                                   CaptionML=[ENU=No. of Depreciation Months;
                                                              RUS=Число месяцев амортизации];
                                                   DecimalPlaces=2:8;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 66  ;   ;Acquisition Date    ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("FA Depreciation Book"."Acquisition Date" WHERE (FA No.=FIELD(FA No.),
                                                                                                                       Depreciation Book Code=FIELD(Depreciation Book Code)));
                                                   CaptionML=[ENU=Acquisition Date;
                                                              RUS=Дата приобретения];
                                                   Editable=No }
    { 67  ;   ;Belonging to Manufacturing;Option  ;CaptionML=[ENU=Belonging to Manufacturing;
                                                              RUS=Принадлежность к производству];
                                                   OptionCaptionML=[ENU=" ,Production,Nonproduction";
                                                                    RUS=" ,Производственное,Непроизводственное"];
                                                   OptionString=[ ,Production,Nonproduction];
                                                   Editable=No }
    { 71  ;   ;Depreciation Starting Date;Date    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("FA Depreciation Book"."Depreciation Starting Date" WHERE (FA No.=FIELD(FA No.),
                                                                                                                                 Depreciation Book Code=FIELD(Depreciation Book Code)));
                                                   CaptionML=[ENU=Depreciation Starting Date;
                                                              RUS=Дата начала амортизации];
                                                   Editable=No }
    { 72  ;   ;Depreciation Amount ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Depreciation),
                                                                                                   FA Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Depreciation Amount;
                                                              RUS=Сумма амортизации] }
    { 74  ;   ;Depreciation Ending Date;Date      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("FA Depreciation Book"."Depreciation Ending Date" WHERE (FA No.=FIELD(FA No.),
                                                                                                                               Depreciation Book Code=FIELD(Depreciation Book Code)));
                                                   CaptionML=[ENU=Depreciation Ending Date;
                                                              RUS=Дата окончания амортизации];
                                                   Editable=No }
    { 82  ;   ;Taken Off Books Date;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("FA Ledger Entry"."Posting Date" WHERE (FA No.=FIELD(FA No.),
                                                                                                              Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                              FA Posting Type=CONST(Proceeds on Disposal),
                                                                                                              FA Posting Date=FIELD(FILTER(Date Filter))));
                                                   CaptionML=[ENU=Taken Off Books Date;
                                                              RUS=Дата снятия с учета];
                                                   Editable=No }
    { 83  ;   ;Taken Off Books Reason;Text50      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("FA Ledger Entry".Description WHERE (FA No.=FIELD(FA No.),
                                                                                                           Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                           FA Posting Type=CONST(Proceeds on Disposal),
                                                                                                           Posting Date=FIELD(FILTER(Date Filter))));
                                                   CaptionML=[ENU=Taken Off Books Reason;
                                                              RUS=Причина снятия с учета];
                                                   Editable=No }
    { 84  ;   ;Book Value Amount   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   Part of Book Value=CONST(Yes),
                                                                                                   FA Posting Date=FIELD(UPPERLIMIT(Date Filter))));
                                                   CaptionML=[ENU=Book Value Amount;
                                                              RUS=Балансовая стоимость];
                                                   Editable=No }
    { 85  ;   ;Sales Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                    Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                    FA Posting Category=CONST(" "),
                                                                                                    FA Posting Type=CONST(Proceeds on Disposal),
                                                                                                    FA Posting Date=FIELD(UPPERLIMIT(Date Filter))));
                                                   CaptionML=[ENU=Sales Amount;
                                                              RUS=Сумма продаж] }
    { 86  ;   ;Sales Gain/Loss     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                    Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                    FA Posting Category=CONST(" "),
                                                                                                    FA Posting Type=CONST(Gain/Loss),
                                                                                                    FA Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                    Depr. Group Elimination=CONST(No)));
                                                   CaptionML=[ENU=Sales Gain/Loss;
                                                              RUS=Сумма дохода/убытков от продаж] }
    { 87  ;   ;Sales Original Amount;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                    Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                    FA Posting Category=CONST(Disposal),
                                                                                                    FA Posting Type=CONST(Acquisition Cost),
                                                                                                    FA Posting Date=FIELD(UPPERLIMIT(Taken Off Books Date))));
                                                   CaptionML=[ENU=Sales Original Amount;
                                                              RUS=Первоначальная стоимость на момент продажи] }
    { 88  ;   ;Sales Depreciation Amount;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(Disposal),
                                                                                                   FA Posting Type=CONST(Depreciation),
                                                                                                   FA Posting Date=FIELD(UPPERLIMIT(Taken Off Books Date))));
                                                   CaptionML=[ENU=Sales Depreciation Amount;
                                                              RUS=Сумма амортизации на момент продажи];
                                                   Editable=No }
    { 89  ;   ;Total Depreciation Amount;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Depreciation),
                                                                                                   FA Posting Date=FIELD(UPPERLIMIT(Date Filter))));
                                                   CaptionML=[ENU=Total Depreciation Amount;
                                                              RUS=Общая сумма амортизации];
                                                   DecimalPlaces=2:8;
                                                   MinValue=0 }
    { 90  ;   ;FA Type             ;Option        ;CaptionML=[ENU=FA Type;
                                                              RUS=Тип ОС];
                                                   OptionCaptionML=[ENU=Fixed Asset,Intangible Asset,Future Expense;
                                                                    RUS=ОС,НМА,РБП];
                                                   OptionString=Fixed Asset,Intangible Asset,Future Expense;
                                                   Editable=No }
    { 91  ;   ;Depr. Group Elimination;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                    Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                    FA Posting Category=CONST(" "),
                                                                                                    FA Posting Type=CONST(Gain/Loss),
                                                                                                    FA Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                    Depr. Group Elimination=CONST(Yes)));
                                                   CaptionML=[ENU=Depr. Group Elimination;
                                                              RUS=Исключение группы аморт.] }
    { 92  ;   ;Depreciation Bonus Amount;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Depreciation),
                                                                                                   FA Posting Date=FIELD(Date Filter),
                                                                                                   Depr. Bonus=CONST(Yes)));
                                                   CaptionML=[ENU=Depreciation Bonus Amount;
                                                              RUS=Сумма амортизационной премии] }
    { 93  ;   ;Depr. Bonus Recovery Amount;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Depreciation),
                                                                                                   FA Posting Date=FIELD(Date Filter),
                                                                                                   Depr. Bonus=CONST(Yes)));
                                                   CaptionML=[ENU=Depr. Bonus Recovery Amount;
                                                              RUS=Восстановленная сумма аморт. премии] }
    { 94  ;   ;Sold FA Qty         ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("FA Ledger Entry" WHERE (FA No.=FIELD(FA No.),
                                                                                              Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                              FA Posting Category=CONST(" "),
                                                                                              FA Posting Type=CONST(Proceeds on Disposal),
                                                                                              FA Posting Date=FIELD(UPPERLIMIT(Date Filter))));
                                                   CaptionML=[ENU=Sold FA Qty;
                                                              RUS=Продано ОС (кол-во)] }
    { 95  ;   ;Acquis. Cost for Released FA;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Acquisition Cost),
                                                                                                   FA Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                   Reclassification Entry=CONST(Yes),
                                                                                                   Quantity=CONST(1)));
                                                   CaptionML=[ENU=Acquis. Cost for Released FA;
                                                              RUS=Стоимость приобретения для ОС в эксплуатации];
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Section Code,Ending Date                 }
    {    ;Section Code,Starting Date               }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      TaxRegMgt@1001 : Codeunit 17201;

    PROCEDURE ObjectName@1() : Text[100];
    VAR
      FixedAsset@1004 : Record 5600;
    BEGIN
      IF FixedAsset.GET("FA No.") THEN
        EXIT(FixedAsset.Description);
    END;

    PROCEDURE CalcQtyMonthsUsefulLife@2() : Decimal;
    BEGIN
      CALCFIELDS("Depreciation Starting Date");
      IF ("Depreciation Starting Date" = 0D) OR
         ("Depreciation Starting Date" > "Ending Date")
      THEN BEGIN
        CALCFIELDS("No. of Depreciation Months");
        EXIT("No. of Depreciation Months");
      END;
      EXIT(
        ((DATE2DMY("Ending Date" + 1,3) * 12) + DATE2DMY("Ending Date" + 1,2)) -
        ((DATE2DMY("Depreciation Starting Date",3) * 12) + DATE2DMY("Depreciation Starting Date",2))
        );
    END;

    PROCEDURE GetMonthYear@4() : Text[30];
    BEGIN
      IF "Ending Date" <> 0D THEN
        EXIT(FORMAT("Ending Date",0,'<Month Text> <Year4>'));
    END;

    PROCEDURE SetFieldFilter@5(FieldNumber@1000 : Integer) FieldInList : Boolean;
    BEGIN
      FieldInList :=
        FieldNumber IN [
                        FIELDNO("Sales Gain/Loss"),
                        FIELDNO("Depreciation Amount"),
                        FIELDNO("Acquisition Cost"),
                        FIELDNO("Sales Amount"),
                        FIELDNO("Valuation Changes"),
                        FIELDNO("Depr. Group Elimination"),
                        FIELDNO("Depreciation Bonus Amount"),
                        FIELDNO("Depr. Bonus Recovery Amount"),
                        FIELDNO("Acquis. Cost for Released FA"),
                        FIELDNO("Sold FA Qty")
                        ];
    END;

    PROCEDURE FormTitle@6() : Text[250];
    VAR
      TaxRegName@1000 : Record 17200;
    BEGIN
      FILTERGROUP(2);
      TaxRegName.SETRANGE("Section Code","Section Code");
      TaxRegName.SETFILTER("Register ID",DELCHR(GETFILTER("Where Used Register IDs"),'=','~'));
      FILTERGROUP(0);
      IF TaxRegName.FIND('-') THEN
        IF TaxRegName.NEXT = 0 THEN
          EXIT(TaxRegName.Description);
    END;

    BEGIN
    END.
  }
}

