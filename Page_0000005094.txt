OBJECT Page 5094 Marketing Setup
{
  OBJECT-PROPERTIES
  {
    Date=25.10.16;
    Time=12:00:00;
    Version List=NAVW110.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Marketing Setup;
               RUS=Настройка модуля Маркетинг];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table5079;
    PageType=Card;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;

                 AttachmentStorageLocationEnabl := "Attachment Storage Type" = "Attachment Storage Type"::"Disk File";
                 GlobalSynchronizationIsEnabled := IntegrationManagement.IsIntegrationServicesEnabled;
                 ExchangeAccountPasswordTemp := '';
                 IF ("Exchange Account User Name" <> '') AND (NOT ISNULLGUID("Exchange Account Password Key")) THEN
                   ExchangeAccountPasswordTemp := '**********';
               END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 100     ;1   ;ActionGroup;
                      CaptionML=[ENU=&Setup;
                                 RUS=&Настройка];
                      Image=Setup }
      { 10      ;2   ;Action    ;
                      CaptionML=[ENU=Social Engagement Setup;
                                 RUS=Настройка Social Engagement];
                      ToolTipML=[ENU=Set up the Microsoft Social Engagement server URL, agree to the license terms, and enable the Social Listening for Customers, Vendors, and/or Items.;
                                 RUS=Настройка URL-адреса сервера Microsoft Social Engagement, принятие условий лицензионного соглашения и включение Social Listening для клиентов, поставщиков и/или товаров.];
                      RunObject=Page 870;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SocialListening;
                      PromotedCategory=Process }
      { 101     ;2   ;Action    ;
                      CaptionML=[ENU=Duplicate Search String Setup;
                                 RUS=Настройка строки поиска дубликатов];
                      ToolTipML=[ENU=View or edit the list of search strings to use when searching for duplicates.;
                                 RUS=Просмотр или изменение списка строк, используемых для поиска дубликатов.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5138;
                      Image=CompareContacts }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 50      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 RUS=Ф&ункции];
                      Image=Action }
      { 7       ;2   ;Action    ;
                      Name=Validate EmailLogging Setup;
                      CaptionML=[ENU=Validate Email Logging Setup;
                                 RUS=Проверить настройку регистрации эл. почты];
                      ToolTipML=[ENU=Test that email logging is set up correctly.;
                                 RUS=Проверка правильности настройки регистрации электронной почты.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=ValidateEmailLoggingSetup;
                      OnAction=VAR
                                 ErrorMessage@1001 : Text;
                               BEGIN
                                 IF ValidateEmailLoggingSetup(Rec,ErrorMessage) THEN
                                   MESSAGE(Text012)
                                 ELSE
                                   ERROR(ErrorMessage);
                               END;
                                }
      { 51      ;2   ;Action    ;
                      Name=Clear EmailLogging Setup;
                      CaptionML=[ENU=Clear Email Logging Setup;
                                 RUS=Очистить настройку регистрации эл. почты];
                      ToolTipML=[ENU=Clear what is currently set up for email logging.;
                                 RUS=Очистка текущих параметров регистрации электронной почты.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=ClearLog;
                      OnAction=BEGIN
                                 IF CONFIRM(Text009,TRUE) THEN
                                   ClearEmailLoggingSetup(Rec);
                               END;
                                }
      { 52      ;2   ;Action    ;
                      CaptionML=[ENU=Generate Integration IDs for Connector for Microsoft Dynamics;
                                 RUS=Создание кодов интеграции для Connector for Microsoft Dynamics];
                      ToolTipML=[ENU=Generate identifiers (GUID) for records that can be used by Microsoft Dynamics CRM and in Microsoft Dynamics NAV.;
                                 RUS=Формирование идентификаторов (GUID) для записей, которые могут использоваться в Microsoft Dynamics CRM и Microsoft Dynamics NAV.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=CreateSerialNo;
                      OnAction=VAR
                                 IntegrationManagement@1000 : Codeunit 5150;
                               BEGIN
                                 IF CONFIRM(Text004,TRUE) THEN BEGIN
                                   IntegrationManagement.SetupIntegrationTables;
                                   MESSAGE(Text005);
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           RUS=Общее] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how you want to store attachments. The following options exist:;
                           RUS=Определяет порядок хранения вложений. Возможны следующие варианты:];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Attachment Storage Type";
                OnValidate=BEGIN
                             AttachmentStorageTypeOnAfterVa;
                           END;
                            }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the drive and path to the location where you want attachments stored if you selected Disk File in the Attachment Storage Type field.;
                           RUS=Определяет диск и путь к месту хранения вложений, если в поле "Тип хранилища вложений" выбрано значение "Дисковый файл".];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Attachment Storage Location";
                Enabled=AttachmentStorageLocationEnabl;
                OnValidate=BEGIN
                             AttachmentStorageLocationOnAft;
                           END;
                            }

    { 1904626001;1;Group  ;
                CaptionML=[ENU=Inheritance;
                           RUS=Наследование] }

    { 6   ;2   ;Group     ;
                CaptionML=[ENU=Inherit;
                           RUS=Наследовать] }

    { 13  ;3   ;Field     ;
                CaptionML=[ENU=Salesperson Code;
                           RUS=Код менеджера по продажам];
                ToolTipML=[ENU=Specifies that you want to copy the salesperson code from the contact card of a company to the contact card for the individual contact person or people working for that company.;
                           RUS=Указывает, должна ли программа копировать код менеджера по продажам из карточки контакта организации в карточку отдельного контактного лица (лиц), работающего в этой организации.];
                ApplicationArea=#Suite,#RelationshipMgmt;
                SourceExpr="Inherit Salesperson Code" }

    { 14  ;3   ;Field     ;
                CaptionML=[ENU=Territory Code;
                           RUS=Код территории];
                ToolTipML=[ENU=Specifies that you want to copy the territory code from the contact card of a company to the contact card for the individual contact person or people working for that company.;
                           RUS=Указывает, должна ли программа копировать код территории из карточки контакта организации в карточку отдельного контактного лица (лиц), работающего в этой организации.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Inherit Territory Code" }

    { 15  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region Code;
                           RUS=Код страны/региона];
                ToolTipML=[ENU=Specifies that you want to copy the country/region code from the contact card of a company to the contact card for the individual contact person or people working for that company.;
                           RUS=Указывает, должна ли программа копировать код страны/региона из карточки контакта организации в карточку отдельного контактного лица (лиц), работающего в этой организации.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Inherit Country/Region Code" }

    { 16  ;3   ;Field     ;
                CaptionML=[ENU=Language Code;
                           RUS=Код языка];
                ToolTipML=[ENU=Specifies that you want to copy the language code from the contact card of a company to the contact card for the individual contact person or people working for that company.;
                           RUS=Указывает, должна ли программа копировать код языка из карточки контакта организации в карточку отдельного контактного лица (лиц), работающего в этой организации.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Inherit Language Code" }

    { 17  ;3   ;Field     ;
                CaptionML=[ENU=Address Details;
                           RUS=Подробный адрес];
                ToolTipML=[ENU=Specifies that you want to copy the address details from the contact card of a company to the contact card for the individual contact person or people working for that company.;
                           RUS=Указывает, должна ли программа копировать подробный адрес из карточки контакта организации в карточку отдельного контактного лица (лиц), работающего в этой организации.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Inherit Address Details" }

    { 79  ;3   ;Field     ;
                CaptionML=[ENU=Communication Details;
                           RUS=Подробности o связи];
                ToolTipML=[ENU=Specifies that you want to copy the communication details, such as telex and fax numbers, from the contact card of a company to the contact card for the individual contact person or people working for that company.;
                           RUS=Указывает, должна ли программа копировать сведения о связи (например, номера факса и телекса) из карточки контакта организации в карточку отдельного контактного лица (лиц), работающего в этой организации.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Inherit Communication Details" }

    { 1902985101;1;Group  ;
                CaptionML=[ENU=Defaults;
                           RUS=Значения по умолчанию] }

    { 80  ;2   ;Group     ;
                CaptionML=[ENU=Default;
                           RUS=По умолчанию] }

    { 30  ;3   ;Field     ;
                CaptionML=[ENU=Salesperson Code;
                           RUS=Код менеджера по продажам];
                ToolTipML=[ENU=Specifies the salesperson code to assign automatically to contacts when they are created.;
                           RUS=Определяет код менеджера по продажам для автоматического назначения контактам при их создании.];
                ApplicationArea=#Suite,#RelationshipMgmt;
                SourceExpr="Default Salesperson Code" }

    { 28  ;3   ;Field     ;
                CaptionML=[ENU=Territory Code;
                           RUS=Код территории];
                ToolTipML=[ENU=Specifies the territory code to automatically assign to contacts when they are created.;
                           RUS=Определяет код территории для автоматического назначения контактам при их создании.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Default Territory Code" }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=Country/Region Code;
                           RUS=Код страны/региона];
                ToolTipML=[ENU=Specifies the country/region code to assign automatically to contacts when they are created.;
                           RUS=Определяет код страны/региона для автоматического назначения контактам при их создании.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Default Country/Region Code" }

    { 24  ;3   ;Field     ;
                CaptionML=[ENU=Language Code;
                           RUS=Код языка];
                ToolTipML=[ENU=Specifies the language code to assign automatically to contacts when they are created.;
                           RUS=Определяет код языка для автоматического назначения контактам при их создании.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Default Language Code" }

    { 102 ;3   ;Field     ;
                CaptionML=[ENU=Correspondence Type;
                           RUS=Тип корреспонденции];
                ToolTipML=[ENU=Specifies the correspondence type to assign automatically to contacts when they are created.;
                           RUS=Определяет тип корреспонденции для автоматического назначения контактам при их создании.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Default Correspondence Type" }

    { 22  ;3   ;Field     ;
                CaptionML=[ENU=Company Salutation Code;
                           RUS=Код обращения для организации];
                ToolTipML=[ENU=Specifies the salutation code to assign automatically to contact companies when they are created.;
                           RUS=Определяет код обращения для автоматического назначения контактным организациям при их создании.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Def. Company Salutation Code" }

    { 86  ;3   ;Field     ;
                CaptionML=[ENU=Person Salutation Code;
                           RUS=Код обращения к сотруднику];
                ToolTipML=[ENU=Specifies the salutation code to assign automatically to contact persons when they are created.;
                           RUS=Определяет код обращения для автоматического назначения контактным лицам при их создании.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Default Person Salutation Code" }

    { 20  ;3   ;Field     ;
                CaptionML=[ENU=Sales Cycle Code;
                           RUS=Код цикла продаж];
                ToolTipML=[ENU=Specifies the sales cycle code to automatically assign to opportunities when they are created.;
                           RUS=Определяет код цикла продаж для автоматического назначения возможностям при их создании.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Default Sales Cycle Code" }

    { 124 ;3   ;Field     ;
                CaptionML=[ENU=To-do Date Calculation;
                           RUS=Расчет даты задачи];
                ToolTipML=[ENU=Specifies the to-do date calculation formula to use to calculate the ending date for to-dos in Microsoft Dynamics NAV if you haven't entered any due date in the Outlook task. If you leave the field blank, today's date is applied.;
                           RUS=Определяет формулу расчета даты выполнения задачи, используемую для расчета даты окончания для задач в Microsoft Dynamics NAV, если для задачи Outlook не указана дата выполнения. Если это поле не заполнено, применяется сегодняшняя дата.];
                SourceExpr="Default To-do Date Calculation" }

    { 1906323901;1;Group  ;
                CaptionML=[ENU=Interactions;
                           RUS=Взаимодействия] }

    { 55  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the language ID of the Windows language to use for naming the merge fields shown when editing an attachment in Microsoft Word.;
                           RUS=Определяет код языка Windows, который требуется использовать для именования полей слияния, отображаемых при редактировании вложения в Microsoft Word.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Mergefield Language ID";
                OnLookup=VAR
                           LanguageManagement@1000 : Codeunit 43;
                         BEGIN
                           LanguageManagement.LookupApplicationLanguage("Mergefield Language ID");
                         END;
                          }

    { 1903203501;1;Group  ;
                CaptionML=[ENU=Synchronization;
                           RUS=Синхронизация] }

    { 9   ;2   ;Field     ;
                Name=EnableSynchronization;
                CaptionML=[ENU=Enable Synchronization;
                           RUS=Включить синхронизацию];
                ToolTipML=[ENU=Specifies whether to synchronize the contact card with the customer, vendor, and bank account.;
                           RUS=Указывает, нужно ли синхронизировать карточку контакта с карточками клиента, поставщика и банковского счета.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=GlobalSynchronizationIsEnabled;
                OnValidate=BEGIN
                             IF GlobalSynchronizationIsEnabled = IntegrationManagement.IsIntegrationServicesEnabled THEN
                               EXIT;

                             IF GlobalSynchronizationIsEnabled THEN BEGIN
                               IF NOT CONFIRM(EnableIntegrationServicesQst) THEN
                                 ERROR('');
                               IntegrationManagement.EnableIntegrationServices;
                             END ELSE BEGIN
                               IF NOT CONFIRM(DisableIntegrationServicesQst) THEN
                                 ERROR('');
                               IntegrationManagement.DisableIntegrationServices;
                             END;
                           END;
                            }

    { 83  ;2   ;Group     ;
                CaptionML=[ENU=Bus. Relation Code for;
                           RUS=Код дел. отношения для];
                GroupType=Group }

    { 56  ;3   ;Field     ;
                CaptionML=[ENU=Customers;
                           RUS=Клиенты];
                ToolTipML=[ENU=Specifies the business relation code that identifies that a contact is also a customer.;
                           RUS=Определяет код делового отношения, который означает, что контакт является также и клиентом.];
                ApplicationArea=#Basic,#Suite,#RelationshipMgmt;
                SourceExpr="Bus. Rel. Code for Customers" }

    { 58  ;3   ;Field     ;
                CaptionML=[ENU=Vendors;
                           RUS=Поставщики];
                ToolTipML=[ENU=Specifies the business relation code that identifies that a contact is also a vendor.;
                           RUS=Определяет код делового отношения, который означает, что контакт является также и поставщиком.];
                ApplicationArea=#Basic,#Suite,#RelationshipMgmt;
                SourceExpr="Bus. Rel. Code for Vendors" }

    { 60  ;3   ;Field     ;
                CaptionML=[ENU=Bank Accounts;
                           RUS=Банковские счета];
                ToolTipML=[ENU=Specifies the business relation code that identifies that a contact is also a bank account.;
                           RUS=Определяет код делового отношения, который означает, что контакт является также и банковским счетом.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Bus. Rel. Code for Bank Accs." }

    { 1904569201;1;Group  ;
                CaptionML=[ENU=Numbering;
                           RUS=Нумерация] }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the number series to use when assigning numbers to contacts.;
                           RUS=Определяет код серии номеров, которая должна использоваться для присвоения номеров контактам.];
                ApplicationArea=#Basic,#Suite,#RelationshipMgmt;
                SourceExpr="Contact Nos." }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the number series to use when assigning numbers to campaigns.;
                           RUS=Определяет код серии номеров, которая должна использоваться для присвоения номеров кампаниям.];
                SourceExpr="Campaign Nos." }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the number series to use when assigning numbers to segments.;
                           RUS=Определяет код серии номеров, которая должна использоваться для присвоения номеров сегментам.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Segment Nos." }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the number series to use when assigning numbers to to-dos.;
                           RUS=Определяет код серии номеров, которая должна использоваться для присвоения номеров задачам.];
                SourceExpr="To-do Nos." }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the number series to use when assigning numbers to opportunities.;
                           RUS=Определяет код серии номеров, которая должна использоваться для присвоения номеров возможностям.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Opportunity Nos." }

    { 1903832701;1;Group  ;
                CaptionML=[ENU=Duplicates;
                           RUS=Дубликаты] }

    { 75  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the automatic update of search strings used to search for duplicates. You can set up search strings in the Duplicate Search String Setup table.;
                           RUS=Определяет автоматическое обновление строк поиска, используемых для поиска дубликатов. Строки поиска можно задать в таблице "Строка поиска дубликатов - настройка".];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Maintain Dupl. Search Strings" }

    { 77  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that you want to search automatically for duplicates each time a contact is created or modified.;
                           RUS=Указывает, что программа будет автоматически осуществлять поиск дубликатов при каждом создании или изменении контакта.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Autosearch for Duplicates" }

    { 73  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the level of precision to apply when searching for duplicates.;
                           RUS=Определяет уровень точности, используемый при поиске дубликатов.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Search Hit %" }

    { 1900887301;1;Group  ;
                CaptionML=[ENU=Email Logging;
                           RUS=Регистрация эл. почты];
                GroupType=Group }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the email address that you want to use in discovery of an Exchange Server. You specify a valid email address, which enables the discovery of the associated Exchange Server. You can validate the email address after you enter an address.;
                           RUS=Определяет адрес электронной почты, который должен использоваться для обнаружения сервера Exchange Server. Следует указать допустимый адрес электронной почты, который обеспечивает обнаружение связанного сервера Exchange Server. После ввода адреса электронной почты его можно проверить.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Autodiscovery E-Mail Address";
                OnValidate=BEGIN
                             IF "Autodiscovery E-Mail Address" <> xRec."Autodiscovery E-Mail Address" THEN
                               ExchangeWebServicesClient.InvalidateService;
                           END;
                            }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the address of your Exchange service. Setting this URL makes the email validation done by Validate Email Logging Setup faster.;
                           RUS=Определяет адрес службы Exchange. Настройка этого URL-адреса ускоряет проверку адреса электронной почты с помощью функции "Проверить настройку регистрации эл. почты".];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Exchange Service URL";
                OnValidate=BEGIN
                             IF "Exchange Service URL" <> xRec."Exchange Service URL" THEN
                               ExchangeWebServicesClient.InvalidateService;
                           END;
                            }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the user account that has access to Exchange.;
                           RUS=Определяет имя учетной записи пользователя, имеющей доступ к Exchange.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Exchange Account User Name";
                OnValidate=BEGIN
                             IF "Exchange Account User Name" <> xRec."Exchange Account User Name" THEN
                               ExchangeWebServicesClient.InvalidateService;
                           END;
                            }

    { 18  ;2   ;Field     ;
                ExtendedDatatype=Masked;
                CaptionML=[ENU=Exchange Account Password;
                           RUS=Пароль учетной записи Exchange];
                ToolTipML=[ENU=Specifies the password of the user account that has access to Exchange.;
                           RUS=Определяет пароль учетной записи пользователя, имеющей доступ к Exchange.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr=ExchangeAccountPasswordTemp;
                OnValidate=BEGIN
                             SetExchangeAccountPassword(ExchangeAccountPasswordTemp);
                             COMMIT;
                             ExchangeWebServicesClient.InvalidateService;
                           END;
                            }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of email messages that you want to process in one run of a job queue that has been set up to handle email logging. By default, the number of messages to process is 0, which means that email messages are not batched together. You can modify this value when you are fine tuning your process so that the execution of a job queue does not take too long. Any email message that is not logged in any particular run will be handled in a subsequent run that has been scheduled.;
                           RUS=Определяет число сообщений электронной почты, которое необходимо обработать в одной очереди работ, настроенной для обработки регистрации сообщений электронной почты. По умолчанию число сообщений для обработки равно 0, что означает, что сообщения электронной почты не объединяются в пакеты. Это значение можно изменять, если требуется, чтобы выполнение очереди работ не занимало слишком много времени. Любое сообщение электронной почты, которое не было зарегистрировано при каком-либо конкретном запуске, будет обработано при следующем запланированном запуске.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Email Batch Size" }

    { 5   ;2   ;Group     ;
                GroupType=Group }

    { 104 ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the queue folder in Microsoft Outlook.;
                           RUS=Определяет имя папки очереди в Microsoft Outlook.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Queue Folder Path";
                OnAssistEdit=VAR
                               ExchangeFolder@1002 : Record 5320;
                             BEGIN
                               IF GetExchangeFolder(ExchangeFolder,Text014) THEN
                                 SetQueueFolder(ExchangeFolder);
                             END;
                              }

    { 19  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the storage folder in Microsoft Outlook.;
                           RUS=Определяет имя папки хранилища в Microsoft Outlook.];
                ApplicationArea=#RelationshipMgmt;
                SourceExpr="Storage Folder Path";
                OnAssistEdit=VAR
                               ExchangeFolder@1002 : Record 5320;
                             BEGIN
                               IF GetExchangeFolder(ExchangeFolder,Text015) THEN
                                 SetStorageFolder(ExchangeFolder);
                             END;
                              }

    { 1900383207;1;Part   ;
                ApplicationArea=#All;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                ApplicationArea=#All;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ExchangeWebServicesClient@1000 : Codeunit 5320;
      IntegrationManagement@1016 : Codeunit 5150;
      ExchangeAccountPasswordTemp@1018 : Text;
      AttachmentStorageLocationEnabl@19012985 : Boolean INDATASET;
      Text004@1003 : TextConst 'ENU=You are about to add integration data to tables. This process may take several minutes. Do you want to continue?;RUS=Вы собираетесь добавить данные интеграции в таблицы. Этот процесс может занять несколько минут. Продолжить?';
      Text005@1004 : TextConst 'ENU=The integration data has been added to the tables.;RUS=Данные интеграции добавлены в таблицы.';
      Text006@1005 : TextConst 'ENU=A valid email address is needed to find an instance of Exchange Server.;RUS=Для поиска экземпляра Exchange Server требуется действительный адрес эл. почты.';
      Text007@1006 : TextConst 'ENU=Exchange Server cannot be found.;RUS=Сервер Exchange Server не найден.';
      Text008@1002 : TextConst 'ENU=The specified Exchange folder does not exist.;RUS=Указанная папка Exchange не существует.';
      Text009@1001 : TextConst 'ENU=This clears the fields in your email logging setup. Do you want to continue?;RUS=При этом поля настройки регистрации электронной почты будут очищены. Продолжить?';
      Text010@1007 : TextConst 'ENU=The specified Queue folder does not exist or cannot be accessed.;RUS=Указанная папка очереди не существует или недоступна.';
      Text011@1008 : TextConst 'ENU=The specified Storage folder does not exist or cannot be accessed.;RUS=Указанная папка хранилища не существует или недоступна.';
      Text012@1009 : TextConst 'ENU=Email logging setup was successfully validated and completed.;RUS=Настройка регистрации электронной почты успешно проверена и завершена.';
      Text013@1010 : TextConst 'ENU=Validating #1#;RUS=Проверка #1#';
      Text014@1011 : TextConst 'ENU=Select Queue folder;RUS=Выбрать папку очереди';
      Text015@1012 : TextConst 'ENU=Select Storage folder;RUS=Выбрать папку хранилища';
      Text016@1015 : TextConst 'ENU=Interaction Template Setup;RUS=Настройка шаблона взаимодействия';
      GlobalSynchronizationIsEnabled@1013 : Boolean;
      DisableIntegrationServicesQst@1014 : TextConst 'ENU=Disabling integration services will disable the feature for all companies and tenants. The operation requires SUPER user permissions. Do you want to continue?;RUS=Отключение служб интеграции приведет к отключению компонента для всех организаций и арендаторов. Для этой операции требуются разрешения суперпользователя (SUPER). Продолжить?';
      EnableIntegrationServicesQst@1017 : TextConst 'ENU=Enabling integration services will enable all companies and tenants to enable the connector. The operation requires SUPER user permissions. Do you want to continue?;RUS=Включение служб интеграции позволит всем организациям и арендаторам включить соединитель. Для этой операции требуются разрешения суперпользователя (SUPER). Продолжить?';

    PROCEDURE SetAttachmentStorageType@1();
    BEGIN
      IF ("Attachment Storage Type" = "Attachment Storage Type"::Embedded) OR
         ("Attachment Storage Location" <> '')
      THEN BEGIN
        MODIFY;
        COMMIT;
        REPORT.RUN(REPORT::"Relocate Attachments");
      END;
    END;

    PROCEDURE SetAttachmentStorageLocation@3();
    BEGIN
      IF "Attachment Storage Location" <> '' THEN BEGIN
        MODIFY;
        COMMIT;
        REPORT.RUN(REPORT::"Relocate Attachments");
      END;
    END;

    LOCAL PROCEDURE AttachmentStorageTypeOnAfterVa@19041025();
    BEGIN
      AttachmentStorageLocationEnabl := "Attachment Storage Type" = "Attachment Storage Type"::"Disk File";
      SetAttachmentStorageType;
    END;

    LOCAL PROCEDURE AttachmentStorageLocationOnAft@19001696();
    BEGIN
      SetAttachmentStorageLocation;
    END;

    PROCEDURE InitExchangeService@2();
    VAR
      Credentials@1001 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Net.NetworkCredential";
      Result@1000 : Boolean;
    BEGIN
      IF "Autodiscovery E-Mail Address" = '' THEN
        ERROR(Text006);

      IF "Exchange Account User Name" <> '' THEN BEGIN
        CreateExchangeAccountCredentials(Credentials);
        Result :=
          ExchangeWebServicesClient.InitializeOnServer("Autodiscovery E-Mail Address","Exchange Service URL",Credentials);
      END ELSE
        Result := ExchangeWebServicesClient.InitializeOnClient("Autodiscovery E-Mail Address","Exchange Service URL");

      IF NOT Result THEN
        ERROR(Text007);
    END;

    LOCAL PROCEDURE GetExchangeFolder@4(VAR ExchangeFolder@1000 : Record 5320;FoldersCaption@1002 : Text) : Boolean;
    VAR
      ExchangeFoldersPage@1001 : Page 5320;
    BEGIN
      InitExchangeService;
      ExchangeFoldersPage.Initialize(ExchangeWebServicesClient,FoldersCaption);
      ExchangeFoldersPage.LOOKUPMODE(TRUE);
      IF ACTION::LookupOK = ExchangeFoldersPage.RUNMODAL THEN BEGIN
        ExchangeFoldersPage.GETRECORD(ExchangeFolder);
        IF NOT ExchangeWebServicesClient.FolderExists(ExchangeFolder.ReadUniqueID) THEN
          ERROR(Text008);
        EXIT(TRUE);
      END;
      EXIT(FALSE);
    END;

    PROCEDURE ClearEmailLoggingSetup@5(VAR MarketingSetup@1000 : Record 5079);
    VAR
      ServicePassword@1001 : Record 1261;
    BEGIN
      ExchangeWebServicesClient.InvalidateService;

      CLEAR(MarketingSetup."Autodiscovery E-Mail Address");
      CLEAR(MarketingSetup."Email Batch Size");

      CLEAR(MarketingSetup."Queue Folder Path");
      IF MarketingSetup."Queue Folder UID".HASVALUE THEN
        CLEAR(MarketingSetup."Queue Folder UID");

      CLEAR(MarketingSetup."Storage Folder Path");
      IF MarketingSetup."Storage Folder UID".HASVALUE THEN
        CLEAR(MarketingSetup."Storage Folder UID");

      CLEAR(MarketingSetup."Exchange Account User Name");
      CLEAR(MarketingSetup."Exchange Service URL");
      IF NOT ISNULLGUID(MarketingSetup."Exchange Account Password Key") THEN
        IF ServicePassword.GET(MarketingSetup."Exchange Account Password Key") THEN
          ServicePassword.DELETE(TRUE);
      CLEAR(MarketingSetup."Exchange Account Password Key");

      MarketingSetup.MODIFY;
    END;

    LOCAL PROCEDURE ValidateEmailLoggingSetup@6(VAR MarketingSetup@1004 : Record 5079;VAR ErrorMsg@1001 : Text) : Boolean;
    VAR
      EmailLoggingDispatcher@1005 : Codeunit 5064;
      ProgressWindow@1000 : Dialog;
      Credentials@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Net.NetworkCredential";
      ValidationCaption@1002 : Text;
      CanInitialize@1003 : Boolean;
    BEGIN
      ExchangeWebServicesClient.InvalidateService;

      ValidationCaption := FIELDCAPTION("Autodiscovery E-Mail Address");
      ProgressWindow.OPEN(Text013,ValidationCaption);

      IF "Exchange Account User Name" <> '' THEN BEGIN
        CreateExchangeAccountCredentials(Credentials);
        CanInitialize := ExchangeWebServicesClient.InitializeOnServer("Autodiscovery E-Mail Address",
            "Exchange Service URL",Credentials);
      END ELSE
        CanInitialize := ExchangeWebServicesClient.InitializeOnClient("Autodiscovery E-Mail Address","Exchange Service URL");

      IF NOT CanInitialize THEN BEGIN
        ErrorMsg := Text006;
        EXIT(FALSE);
      END;

      ValidationCaption := FIELDCAPTION("Queue Folder Path");
      ProgressWindow.UPDATE;
      IF NOT ExchangeWebServicesClient.FolderExists(MarketingSetup.GetQueueFolderUID) THEN BEGIN
        ErrorMsg := Text010;
        EXIT(FALSE);
      END;

      ValidationCaption := FIELDCAPTION("Storage Folder Path");
      ProgressWindow.UPDATE;
      IF NOT ExchangeWebServicesClient.FolderExists(MarketingSetup.GetStorageFolderUID) THEN BEGIN
        ErrorMsg := Text011;
        EXIT(FALSE);
      END;

      // Emails cannot be automatically logged unless Interaction Template Setup configured correctly.
      ValidationCaption := Text016;
      ProgressWindow.UPDATE;
      IF NOT EmailLoggingDispatcher.CheckInteractionTemplateSetup(ErrorMsg) THEN
        EXIT(FALSE);

      ProgressWindow.CLOSE;
      CLEAR(ErrorMsg);
      MarketingSetup.MODIFY;

      EXIT(TRUE);
    END;

    BEGIN
    END.
  }
}

