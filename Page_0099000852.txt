OBJECT Page 99000852 Planning Worksheet
{
  OBJECT-PROPERTIES
  {
    Date=22.05.17;
    Time=11:39:06;
    Modified=Yes;
    Version List=NAVW110.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Planning Worksheet;
               RUS=Журнал планирования];
    SaveValues=Yes;
    MultipleNewLines=Yes;
    SourceTable=Table246;
    DelayedInsert=Yes;
    DataCaptionFields=Journal Batch Name;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnOpenPage=VAR
                 JnlSelected@1000 : Boolean;
               BEGIN
                 OpenedFromBatch := ("Journal Batch Name" <> '') AND ("Worksheet Template Name" = '');
                 IF OpenedFromBatch THEN BEGIN
                   CurrentWkshBatchName := "Journal Batch Name";
                   ReqJnlManagement.OpenJnl(CurrentWkshBatchName,Rec);
                   EXIT;
                 END;
                 ReqJnlManagement.TemplateSelection(PAGE::"Planning Worksheet",FALSE,2,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 ReqJnlManagement.OpenJnl(CurrentWkshBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       DescriptionIndent := 0;
                       ShowShortcutDimCode(ShortcutDimCode);
                       StartingDateTimeOnFormat;
                       StartingDateOnFormat;
                       DescriptionOnFormat;
                       RefOrderNoOnFormat;
                       PlanningWarningLevel1OnFormat;
                     END;

    OnNewRecord=BEGIN
                  SetUpNewLine(Rec);
                  Type := Type::Item;
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=BEGIN
                     "Accept Action Message" := FALSE;
                     DeleteMultiLevel;
                   END;

    OnAfterGetCurrRecord=BEGIN
                           PlanningWkshManagement.GetDescriptionAndRcptName(Rec,ItemDescription,RoutingDescription);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 39      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 RUS=&Строка];
                      Image=Line }
      { 110     ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 RUS=Измерения];
                      ToolTipML=[ENU=View or edit dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 RUS=Просмотр или изменение измерений, например области, проекта или отдела, которые можно назначать документам покупки и продажи для распределения себестоимости и анализа истории транзакций.];
                      Promoted=Yes;
                      Image=Dimensions;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowDimensions;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 6500    ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 RUS=Строки трассир&овки товаров];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines;
                               END;
                                }
      { 48      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Item;
                                 RUS=&Товар];
                      Image=Item }
      { 53      ;2   ;Action    ;
                      CaptionML=[ENU=Components;
                                 RUS=Компоненты];
                      RunObject=Page 99000862;
                      RunPageLink=Worksheet Template Name=FIELD(Worksheet Template Name),
                                  Worksheet Batch Name=FIELD(Journal Batch Name),
                                  Worksheet Line No.=FIELD(Line No.);
                      Image=Components }
      { 54      ;2   ;Action    ;
                      CaptionML=[ENU=Ro&uting;
                                 RUS=Ма&ршрут];
                      RunObject=Page 99000863;
                      RunPageLink=Worksheet Template Name=FIELD(Worksheet Template Name),
                                  Worksheet Batch Name=FIELD(Journal Batch Name),
                                  Worksheet Line No.=FIELD(Line No.);
                      Image=Route }
      { 49      ;2   ;ActionGroup;
                      CaptionML=[ENU=&Item Availability by;
                                 RUS=Наличие &товара по];
                      Image=ItemAvailability }
      { 5       ;3   ;Action    ;
                      CaptionML=[ENU=Event;
                                 RUS=Событие];
                      Image=Event;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromReqLine(Rec,ItemAvailFormsMgt.ByEvent)
                               END;
                                }
      { 65      ;3   ;Action    ;
                      CaptionML=[ENU=Period;
                                 RUS=периодам];
                      Image=Period;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromReqLine(Rec,ItemAvailFormsMgt.ByPeriod)
                               END;
                                }
      { 66      ;3   ;Action    ;
                      CaptionML=[ENU=Variant;
                                 RUS=вариантам];
                      Image=ItemVariant;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromReqLine(Rec,ItemAvailFormsMgt.ByVariant)
                               END;
                                }
      { 67      ;3   ;Action    ;
                      AccessByPermission=TableData 14=R;
                      CaptionML=[ENU=Location;
                                 RUS=складам];
                      Image=Warehouse;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromReqLine(Rec,ItemAvailFormsMgt.ByLocation)
                               END;
                                }
      { 3       ;3   ;Action    ;
                      CaptionML=[ENU=BOM Level;
                                 RUS=Уровень спецификации];
                      Image=BOMLevel;
                      OnAction=BEGIN
                                 ItemAvailFormsMgt.ShowItemAvailFromReqLine(Rec,ItemAvailFormsMgt.ByBOM)
                               END;
                                }
      { 7       ;3   ;Action    ;
                      CaptionML=[ENU=Timeline;
                                 RUS=График времени];
                      Image=Timeline;
                      OnAction=BEGIN
                                 ShowTimeline(Rec);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 20      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 RUS=Ф&ункции];
                      Image=Action }
      { 106     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Get &Action Messages;
                                 RUS=Получить &указания];
                      Promoted=Yes;
                      Image=GetActionMessages;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 GetActionMessages;

                                 IF NOT FIND('-') THEN
                                   SetUpNewLine(Rec);
                               END;
                                }
      { 109     ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 RUS=""] }
      { 101     ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Calculate &Net Change Plan;
                                 RUS=Вычислить &план оборота];
                      Image=CalculatePlanChange;
                      OnAction=VAR
                                 CalcPlan@1001 : Report 99001017;
                               BEGIN
                                 CalcPlan.SetTemplAndWorksheet("Worksheet Template Name","Journal Batch Name",FALSE);
                                 CalcPlan.RUNMODAL;

                                 IF NOT FIND('-') THEN
                                   SetUpNewLine(Rec);

                                 CLEAR(CalcPlan);
                               END;
                                }
      { 102     ;2   ;Action    ;
                      Name=CalculateRegenerativePlan;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Calculate Regenerative Plan;
                                 RUS=Вычислить регенеративный план];
                      Promoted=Yes;
                      Image=CalculateRegenerativePlan;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CalcPlan@1001 : Report 99001017;
                               BEGIN
                                 CalcPlan.SetTemplAndWorksheet("Worksheet Template Name","Journal Batch Name",TRUE);
                                 CalcPlan.RUNMODAL;

                                 IF NOT FIND('-') THEN
                                   SetUpNewLine(Rec);

                                 CLEAR(CalcPlan);
                               END;
                                }
      { 32      ;2   ;Separator  }
      { 23      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Re&fresh Planning Line;
                                 RUS=Об&новить строку планирования];
                      Promoted=Yes;
                      Image=RefreshPlanningLine;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReqLine@1001 : Record 246;
                               BEGIN
                                 ReqLine.SETRANGE("Worksheet Template Name","Worksheet Template Name");
                                 ReqLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 ReqLine.SETRANGE("Line No.","Line No.");

                                 REPORT.RUNMODAL(REPORT::"Refresh Planning Demand",TRUE,FALSE,ReqLine);
                               END;
                                }
      { 42      ;2   ;Separator  }
      { 114     ;2   ;Action    ;
                      CaptionML=[ENU=&Get Error Log;
                                 RUS=&Получить журнал ошибок];
                      RunObject=Page 5430;
                      RunPageLink=Worksheet Template Name=FIELD(Worksheet Template Name),
                                  Journal Batch Name=FIELD(Journal Batch Name);
                      Image=ErrorLog }
      { 113     ;2   ;Separator  }
      { 59      ;2   ;Action    ;
                      Name=CarryOutActionMessage;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Carry &Out Action Message;
                                 RUS=Выполнить &указание];
                      Promoted=Yes;
                      Image=CarryOutActionMessage;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 PerformAction.SetReqWkshLine(Rec);
                                 PerformAction.RUNMODAL;
                                 CLEAR(PerformAction);
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 19      ;2   ;Separator  }
      { 62      ;2   ;Action    ;
                      CaptionML=[ENU=&Reserve;
                                 RUS=&Резервировать];
                      Image=Reserve;
                      OnAction=BEGIN
                                 CurrPage.SAVERECORD;
                                 ShowReservation;
                               END;
                                }
      { 18      ;2   ;Action    ;
                      Name=OrderTracking;
                      CaptionML=[ENU=Order &Tracking;
                                 RUS=Трассир&овка заказов];
                      Promoted=Yes;
                      Image=OrderTracking;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 TrackingForm@1001 : Page 99000822;
                               BEGIN
                                 TrackingForm.SetReqLine(Rec);
                                 TrackingForm.RUNMODAL;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 69  ;1   ;Field     ;
                CaptionML=[ENU=Name;
                           RUS=Название];
                ToolTipML=[ENU=Specifies the name of the journal batch of the planning worksheet.;
                           RUS=Определяет название раздела журнала планирования.];
                SourceExpr=CurrentWkshBatchName;
                OnValidate=BEGIN
                             ReqJnlManagement.CheckName(CurrentWkshBatchName,Rec);
                             CurrentWkshBatchNameOnAfterVal;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           ReqJnlManagement.LookupName(CurrentWkshBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                         END;
                          }

    { 1   ;1   ;Group     ;
                IndentationColumnName=DescriptionIndent;
                IndentationControls=Description;
                GroupType=Repeater }

    { 118 ;2   ;Field     ;
                Name=Warning;
                CaptionML=[ENU=Warning;
                           RUS=Предупреждение];
                ToolTipML=[ENU=Any planning line created for an unusual situation will display a warning text in this field.;
                           RUS=Во всех строках планирования, созданных для нестандартной ситуации, в этом поле будет отображаться текстовое предупреждение.];
                OptionCaptionML=[ENU=" ,Emergency,Exception,Attention";
                                 RUS=" ,Экстренный,Исключение,Внимание"];
                SourceExpr=Warning;
                Editable=False;
                OnDrillDown=BEGIN
                              PlanningTransparency.SetCurrReqLine(Rec);
                              PlanningTransparency.DrillDownUntrackedQty('');
                            END;
                             }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the type of requisition worksheet line you are creating.;
                           RUS=Определяет тип создаваемой строки журнала заявок.];
                SourceExpr=Type;
                Visible=FALSE }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the general ledger account or item to be entered on the line.;
                           RUS=Определяет номер счета главной книги или товара, который будет введен в строку.];
                SourceExpr="No.";
                OnValidate=BEGIN
                             PlanningWkshManagement.GetDescriptionAndRcptName(Rec,ItemDescription,RoutingDescription);
                           END;
                            }

    { 29  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a variant code for the item.;
                           RUS=Определяет код варианта товара.];
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 96  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies an action to take to rebalance the demand-supply situation.;
                           RUS=Определяет, какое действие необходимо предпринять, чтобы заново сбалансировать ситуацию спроса и предложения.];
                SourceExpr="Action Message" }

    { 98  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether to accept the action message proposed for the line.;
                           RUS=Определяет, следует ли принимать указание, предлагаемое для строки.];
                SourceExpr="Accept Action Message" }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the due date stated on the production or purchase order, when an action message proposes to reschedule an order.;
                           RUS=Определяет срок выполнения, который заявлен в производственном заказе или заказе на покупку, если указание предлагает перепланировать заказ.];
                SourceExpr="Original Due Date" }

    { 82  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the order date that will apply to the requisition worksheet line.;
                           RUS=Определяет дату заказа, которая будет использоваться в строке журнала заявок.];
                SourceExpr="Order Date";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date when you can expect to receive the items.;
                           RUS=Определяет дату ожидаемого получения товаров.];
                SourceExpr="Due Date" }

    { 115 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the shipment date of the transfer order proposal.;
                           RUS=Определяет дату отгрузки по предложению заказа на перемещение.];
                SourceExpr="Transfer Shipment Date";
                Visible=FALSE }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting date and the starting time, which are combined in a format called "starting date-time".;
                           RUS=Определяет дату и время начала, объединенные в формате, который называется "Дата/время начала".];
                SourceExpr="Starting Date-Time" }

    { 55  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting time of the manufacturing process.;
                           RUS=Определяет время начала процесса производства.];
                SourceExpr="Starting Time";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the starting date of the manufacturing process, if the planned supply is a production order.;
                           RUS=Определяет дату начала производственного процесса, если планируемая поставка является производственным заказом.];
                SourceExpr="Starting Date";
                Visible=FALSE }

    { 107 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending date and the ending time, which are combined in a format called "ending date-time".;
                           RUS=Определяет дату и время окончания, объединенные в формате, который называется "Дата/время окончания".];
                SourceExpr="Ending Date-Time" }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending time for the manufacturing process.;
                           RUS=Определяет время окончания процесса производства.];
                SourceExpr="Ending Time";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the ending date of the manufacturing process, if the planned supply is a production order.;
                           RUS=Определяет дату окончания производственного процесса, если планируемая поставка является производственным заказом.];
                SourceExpr="Ending Date";
                Visible=FALSE }

    { 80  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the planning level of this item entry in the planning worksheet.;
                           RUS=Определяет уровень планирования этой товарной операции в журнале планирования.];
                SourceExpr="Low-Level Code";
                Visible=FALSE }

    { 63  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies text that describes the entry.;
                           RUS=Определяет текст, описывающий операцию.];
                SourceExpr=Description }

    { 74  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies additional text describing the entry, or a remark about the requisition worksheet line.;
                           RUS=Определяет дополнительный текст, описывающий операцию, или замечание о строке журнала заявок.];
                SourceExpr="Description 2";
                Visible=FALSE }

    { 43  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the production BOM number for this production order.;
                           RUS=Определяет номер производственной спецификации для этого производственного заказа.];
                SourceExpr="Production BOM No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the version code of the BOM.;
                           RUS=Определяет код версии спецификации.];
                SourceExpr="Production BOM Version Code";
                Visible=FALSE }

    { 45  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the routing number.;
                           RUS=Определяет номер производственной операции.];
                SourceExpr="Routing No.";
                Visible=FALSE;
                OnValidate=BEGIN
                             PlanningWkshManagement.GetDescriptionAndRcptName(Rec,ItemDescription,RoutingDescription);
                           END;
                            }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the version code of the routing.;
                           RUS=Определяет код версии производственной операции.];
                SourceExpr="Routing Version Code";
                Visible=FALSE }

    { 27  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code to be linked to the requisition worksheet line.;
                           RUS=Определяет код значения измерения для связи строкой журнала заявок.];
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 25  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code to be linked to the requisition worksheet line.;
                           RUS=Определяет код значения измерения для связи строкой журнала заявок.];
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 111 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the location that the item will be transferred from.;
                           RUS=Определяет код склада, с которого будет перемещен товар.];
                SourceExpr="Transfer-from Code";
                Visible=FALSE }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for an inventory location where the items that are being ordered will be registered.;
                           RUS=Определяет код местонахождения на складе, где будут зарегистрированы заказываемые товары.];
                SourceExpr="Location Code";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity stated on the production or purchase order, when an action message proposes to change the quantity on an order.;
                           RUS=Определяет количество, которое заявлено в производственном заказе или заказе на покупку, если указание предлагает изменение количества в заказе.];
                SourceExpr="Original Quantity" }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the requisition worksheet line is an MPS order, that is, whether it is linked to a production forecast or a sales order.;
                           RUS=Указывает, была ли строка журнала заявок заказом MPS, т. е. связана ли она с производственным прогнозом или с заказом на продажу.];
                SourceExpr="MPS Order" }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of units of the item.;
                           RUS=Определяет количество единиц товара.];
                SourceExpr=Quantity }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure code used to determine the unit price.;
                           RUS=Определяет код единицы измерения для определения цены единицы.];
                SourceExpr="Unit of Measure Code";
                Visible=FALSE }

    { 88  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which kind of order to use to create replenishment orders and order proposals.;
                           RUS=Определяет, какой тип заказа должен использоваться для создания заказов на пополнение и предложений заказов.];
                SourceExpr="Replenishment System";
                Visible=FALSE }

    { 90  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the order is a purchase order, a production order, or a transfer order.;
                           RUS=Определяет, является ли заказ заказом на покупку, производственным заказом или заказом на перемещение.];
                SourceExpr="Ref. Order Type" }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the relevant production or purchase order.;
                           RUS=Определяет номер соответствующего производственного заказа или заказа на покупку.];
                SourceExpr="Ref. Order No." }

    { 92  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the production order.;
                           RUS=Определяет статус производственного заказа.];
                SourceExpr="Ref. Order Status" }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the purchase or production order line.;
                           RUS=Определяет номер строки заказа на покупку или производственного заказа.];
                SourceExpr="Ref. Line No.";
                Visible=FALSE }

    { 104 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the supply, represented by the requisition worksheet line, is considered by the planning system, when calculating action messages.;
                           RUS=Определяет, учитывается ли поставка, представленная строкой журнала заявок, системой планирования при расчете указаний.];
                SourceExpr="Planning Flexibility";
                Visible=FALSE }

    { 51  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many units of this item have been reserved.;
                           RUS=Определяет, какое количество единиц этого товара было зарезервировано.];
                SourceExpr="Reserved Quantity";
                Visible=FALSE;
                OnDrillDown=BEGIN
                              ShowReservationEntries(TRUE);
                            END;
                             }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the general product posting group to be used for the item when you make orders from the planning worksheet.;
                           RUS=Определяет код общей товарной группы, которая будет использоваться при создании заказов из журнала планирования.];
                SourceExpr="Gen. Prod. Posting Group";
                Visible=FALSE }

    { 86  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit costs for the planning worksheet line.;
                           RUS=Определяет себестоимость единиц для строки журнала планирования.];
                SourceExpr="Unit Cost";
                Visible=FALSE }

    { 35  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the general business posting group to be used for the item when you post the planning worksheet.;
                           RUS=Определяет код общей бизнес-группы, которая будет использоваться учете журнала планирования.];
                SourceExpr="Gen. Business Posting Group";
                Visible=FALSE }

    { 37  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total costs for the requisition worksheet line.;
                           RUS=Определяет итоговую себестоимость для строки журнала заявок.];
                SourceExpr="Cost Amount";
                Visible=FALSE }

    { 78  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the vendor who will ship the items in the purchase order.;
                           RUS=Определяет номер поставщика, который будет производить отгрузку товаров в заказе на покупку.];
                SourceExpr="Vendor No.";
                Visible=FALSE }

    { 56  ;1   ;Group      }

    { 1902454301;2;Group  ;
                GroupType=FixedLayout }

    { 1900295501;3;Group  ;
                CaptionML=[ENU=Item Description;
                           RUS=Описание товара] }

    { 57  ;4   ;Field     ;
                SourceExpr=ItemDescription;
                Editable=FALSE;
                ShowCaption=No }

    { 1901312901;3;Group  ;
                CaptionML=[ENU=Routing Description;
                           RUS=Описание маршрута] }

    { 70  ;4   ;Field     ;
                CaptionML=[ENU=Routing Description;
                           RUS=Описание маршрута];
                ToolTipML=[ENU=Specifies a description of the routing for the item that is entered on the line.;
                           RUS=Определяет описание производственной операции для товара, который вводится в строку.];
                SourceExpr=RoutingDescription;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 9   ;1   ;Part      ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9090;
                Visible=FALSE;
                PartType=Page }

    { 11  ;1   ;Part      ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9091;
                PartType=Page }

    { 15  ;1   ;Part      ;
                SubPageLink=Worksheet Template Name=FIELD(Worksheet Template Name),
                            Worksheet Batch Name=FIELD(Journal Batch Name),
                            Worksheet Line No.=FIELD(Line No.);
                PagePartID=Page9101;
                PartType=Page }

    { 13  ;1   ;Part      ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page9109;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PerformAction@1000 : Report 99001020;
      PlanningTransparency@1009 : Codeunit 99000856;
      ReqJnlManagement@1001 : Codeunit 330;
      PlanningWkshManagement@1002 : Codeunit 99000812;
      ItemAvailFormsMgt@1008 : Codeunit 353;
      CurrentWkshBatchName@1003 : Code[10];
      ItemDescription@1004 : Text[50];
      RoutingDescription@1005 : Text[50];
      ShortcutDimCode@1006 : ARRAY [20] OF Code[20];
      OpenedFromBatch@1007 : Boolean;
      DescriptionIndent@19057867 : Integer INDATASET;
      Warning@19070923 : ' ,Emergency,Exception,Attention';

    LOCAL PROCEDURE PlanningWarningLevel@40();
    VAR
      Transparency@1001 : Codeunit 99000856;
    BEGIN
      Warning := Transparency.ReqLineWarningLevel(Rec);
    END;

    LOCAL PROCEDURE CurrentWkshBatchNameOnAfterVal@19053116();
    BEGIN
      CurrPage.SAVERECORD;
      ReqJnlManagement.SetName(CurrentWkshBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE StartingDateTimeOnFormat@19018669();
    BEGIN
      IF ("Starting Date" < WORKDATE) AND
         ("Action Message" IN ["Action Message"::New,"Action Message"::Reschedule,"Action Message"::"Resched. & Chg. Qty."])
      THEN;
    END;

    LOCAL PROCEDURE StartingDateOnFormat@19039781();
    BEGIN
      IF "Starting Date" < WORKDATE THEN;
    END;

    LOCAL PROCEDURE DescriptionOnFormat@19023855();
    BEGIN
      DescriptionIndent := "Planning Level";
    END;

    LOCAL PROCEDURE RefOrderNoOnFormat@19059185();
    VAR
      PurchHeader@1000 : Record 38;
      TransfHeader@1003 : Record 5740;
    BEGIN
      CASE "Ref. Order Type" OF
        "Ref. Order Type"::Purchase:
          IF PurchHeader.GET(PurchHeader."Document Type"::Order,"Ref. Order No.") AND
             (PurchHeader.Status = PurchHeader.Status::Released)
          THEN;
        "Ref. Order Type"::"Prod. Order":
          ;
        "Ref. Order Type"::Transfer:
          IF TransfHeader.GET("Ref. Order No.") AND
             (TransfHeader.Status = TransfHeader.Status::Released)
          THEN;
      END;
    END;

    LOCAL PROCEDURE PlanningWarningLevel1OnFormat@19030151();
    BEGIN
      PlanningWarningLevel;
    END;

    PROCEDURE OpenPlanningComponent@1(VAR PlanningComponent@1001 : Record 99000829);
    BEGIN
      PlanningComponent.SETRANGE("Worksheet Template Name",PlanningComponent."Worksheet Template Name");
      PlanningComponent.SETRANGE("Worksheet Batch Name",PlanningComponent."Worksheet Batch Name");
      PlanningComponent.SETRANGE("Worksheet Line No.",PlanningComponent."Worksheet Line No.");
      PAGE.RUNMODAL(PAGE::"Planning Components",PlanningComponent);
    END;

    BEGIN
    END.
  }
}

