OBJECT Page 132 Posted Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=14.06.17;
    Time=11:21:38;
    Modified=Yes;
    Version List=NAVW110.00.00.15601,NAVRU10.00.00.15601,NOS-26;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Sales Invoice;
               RUS=Учтенный счет продажи];
    InsertAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table112;
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Invoice,Correct;
                                RUS=Создать,Обработать,Отчет,Счет,Исправить];
    OnInit=BEGIN
             DocExcStatusVisible := TRUE;
           END;

    OnOpenPage=VAR
                 CRMIntegrationManagement@1000 : Codeunit 5330;
                 OfficeMgt@1001 : Codeunit 1630;
               BEGIN
                 SetSecurityFilterOnRespCenter;
                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;
                 IsOfficeAddin := OfficeMgt.IsAvailable;
               END;

    OnAfterGetRecord=BEGIN
                       DocExchStatusStyle := GetDocExchStatusStyle;
                     END;

    OnDeleteRecord=BEGIN
                     //NC S729 > PCH
                     ERROR(Text55000);
                     //NC S729 < PCH
                   END;

    OnAfterGetCurrRecord=VAR
                           IncomingDocument@1000 : Record 130;
                           CRMCouplingManagement@1001 : Codeunit 5331;
                         BEGIN
                           HasIncomingDocument := IncomingDocument.PostedDocExists("No.","Posting Date");
                           DocExchStatusStyle := GetDocExchStatusStyle;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           CRMIsCoupledToRecord := CRMIntegrationEnabled AND CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);
                           UpdatePaymentService;
                           DocExcStatusVisible := DocExchangeStatusIsSent;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 55      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Invoice;
                                 RUS=&Счет];
                      Image=Invoice }
      { 8       ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 RUS=Статистика];
                      RunObject=Page 397;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Statistics;
                      PromotedCategory=Category4 }
      { 57      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 RUS=Ко&мментарии];
                      RunObject=Page 67;
                      RunPageLink=Document Type=CONST(Posted Invoice),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ViewComments;
                      PromotedCategory=Category4 }
      { 89      ;2   ;Action    ;
                      Name=Dimensions;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 RUS=Измерения];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 RUS=Просмотр или изменение измерений, например области, проекта или отдела, которые можно назначать документам покупки и продажи для распределения себестоимости и анализа истории транзакций.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 ShowDimensions;
                               END;
                                }
      { 112     ;2   ;Action    ;
                      AccessByPermission=TableData 456=R;
                      CaptionML=[ENU=Approvals;
                                 RUS=Утверждения];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 RUS=Просмотр списка записей, ожидающих утверждения. Например, вы можете видеть имя пользователя, запросившего утверждение записи, время отправки запроса и время, когда он должен быть утвержден.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Approvals;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ShowPostedApprovalEntries(RECORDID);
                               END;
                                }
      { 171     ;2   ;Separator  }
      { 1470000 ;2   ;Action    ;
                      CaptionML=[ENU=Employee Si&gnatures;
                                 RUS=Под&писи сотрудников];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 12464;
                      RunPageLink=Table ID=CONST(112),
                                  Document No.=FIELD(No.);
                      Image=Signature }
      { 1210000 ;2   ;Separator  }
      { 1210001 ;2   ;Action    ;
                      CaptionML=[ENU=Shipments;
                                 RUS=Расх. накладные];
                      ApplicationArea=#Basic,#Suite;
                      Image=Shipment;
                      OnAction=BEGIN
                                 FindShipments(Rec);
                               END;
                                }
      { 35      ;2   ;Action    ;
                      Name=ChangePaymentService;
                      CaptionML=[ENU=Change Payment Service;
                                 RUS=Изменить службу платежей];
                      ToolTipML=[ENU=Change or add the payment service, such as PayPal Standard, that will be included on the sales document so the customer can quickly access the payment site.;
                                 RUS=Изменение или добавление службы платежей, например PayPal Standard, которая будет включаться в документ продажи, чтобы клиент мог легко перейти на сайт для оплаты.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=PaymentServiceVisible;
                      PromotedIsBig=Yes;
                      Image=ElectronicPayment;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 PaymentServiceSetup@1000 : Record 1060;
                               BEGIN
                                 PaymentServiceSetup.ChangePaymentServicePostedInvoice(Rec);
                               END;
                                }
      { 45      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=[ENU=Dynamics CRM;
                                 RUS=Dynamics CRM];
                      Visible=CRMIntegrationEnabled }
      { 43      ;2   ;Action    ;
                      Name=CRMGotoInvoice;
                      CaptionML=[ENU=Invoice;
                                 RUS=Счет];
                      ToolTipML=[ENU=Open the coupled Microsoft Dynamics CRM account.;
                                 RUS=Открытие связанной организации Microsoft Dynamics CRM.];
                      ApplicationArea=#All;
                      Enabled=CRMIsCoupledToRecord;
                      Image=CoupledSalesInvoice;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 29      ;2   ;Action    ;
                      Name=CreateInCRM;
                      CaptionML=[ENU=Create Invoice in Dynamics CRM;
                                 RUS=Создать счет в Dynamics CRM];
                      ToolTipML=[ENU=Create a sales invoice in Dynamics CRM that is connected to this posted sales invoice.;
                                 RUS=Создание в Dynamics CRM счета продажи, связанного с этим учтенным счетом продажи.];
                      ApplicationArea=#All;
                      Enabled=NOT CRMIsCoupledToRecord;
                      Image=NewSalesInvoice;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.CreateNewRecordInCRM(RECORDID,FALSE);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 58      ;1   ;Action    ;
                      Name=Print;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 RUS=&Печать];
                      ToolTipML=[ENU=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.;
                                 RUS=Подготовка документа к печати. Открывается окно запроса отчета для документа, где вы можете указать, какая информация должна выводиться на печать.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=NOT IsOfficeAddin;
                      PromotedIsBig=Yes;
                      Image=Print;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 SalesInvHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 SalesInvHeader.PrintRecords(TRUE);
                               END;
                                }
      { 9       ;1   ;Action    ;
                      Name=Email;
                      CaptionML=[ENU=&Email;
                                 RUS=&Эл. почта];
                      ToolTipML=[ENU=Prepare to email the document. The Send Email window opens prefilled with the customer's email address so you can add or edit information.;
                                 RUS=Подготовка документа к отправке по электронной почте. Будет открыто окно "Отправить сообщение эл. почты" с заранее заполненным полем адреса электронной почты, чтобы вы могли добавлять и изменять информацию.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Email;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 SalesInvHeader := Rec;
                                 CurrPage.SETSELECTIONFILTER(SalesInvHeader);
                                 SalesInvHeader.EmailRecords(TRUE);
                               END;
                                }
      { 59      ;1   ;Action    ;
                      CaptionML=[ENU=&Navigate;
                                 RUS=&Навигатор];
                      ToolTipML=[ENU=Find all entries and documents that exist for the document number and posting date on the selected entry or document.;
                                 RUS=Поиск всех операций и документов, существующих для номера документа и даты учета в выбранной операции или в выбранном документе.];
                      ApplicationArea=#Basic,#Suite;
                      Visible=NOT IsOfficeAddin;
                      Image=Navigate;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 Navigate;
                               END;
                                }
      { 13      ;1   ;Action    ;
                      Name=ActivityLog;
                      CaptionML=[ENU=Activity Log;
                                 RUS=Журнал действий];
                      ToolTipML=[ENU=View the status and any errors if the document was sent as an electronic document or OCR file through the document exchange service.;
                                 RUS=Просмотр состояния и всех ошибок, если документ был отправлен в электронной форме или в форме файла OCR через службу обмена документами.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Log;
                      OnAction=BEGIN
                                 ShowActivityLog;
                               END;
                                }
      { 23      ;1   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=[ENU=Incoming Document;
                                 RUS=Входящий документ];
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 21      ;2   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=[ENU=View Incoming Document;
                                 RUS=Просмотр входящего документа];
                      ToolTipML=;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCard("No.","Posting Date");
                               END;
                                }
      { 19      ;2   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=[ENU=Select Incoming Document;
                                 RUS=Выбрать входящий документ];
                      ToolTipML=;
                      Enabled=NOT HasIncomingDocument;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.SelectIncomingDocumentForPostedDocument("No.","Posting Date",RECORDID);
                               END;
                                }
      { 17      ;2   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Incoming Document from File;
                                 RUS=Создать входящий документ из файла];
                      ToolTipML=;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPostedDocument("No.","Posting Date");
                               END;
                                }
      { 41      ;1   ;ActionGroup;
                      CaptionML=[ENU=Correct;
                                 RUS=Исправить] }
      { 39      ;2   ;Action    ;
                      Name=CorrectInvoice;
                      CaptionML=[ENU=Correct;
                                 RUS=Исправить];
                      ToolTipML=[ENU=Reverse this posted invoice and automatically create a new invoice with the same information that you can correct before posting. This posted invoice will automatically be canceled.;
                                 RUS=Сторнирование этого учтенного счета и автоматическое создание нового счета с той же информацией, в который можно будет внести корректировки перед учетом. Этот учтенный счет будет автоматически отменен.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Undo;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 CorrectPstdSalesInvYesNo@1000 : Codeunit 1322;
                               BEGIN
                                 IF CorrectPstdSalesInvYesNo.CorrectInvoice(Rec) THEN
                                   CurrPage.CLOSE;
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=CancelInvoice;
                      CaptionML=[ENU=Cancel;
                                 RUS=Отмена];
                      ToolTipML=[ENU=Create and post a sales credit memo that reverses this posted sales invoice. This posted sales invoice will be canceled.;
                                 RUS=Создание и учет кредит-ноты продажи, сторнирующей этот учтенный счет продажи. Учтенный счет продажи будет отменен.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Cancel;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 CancelPstdSalesInvYesNo@1000 : Codeunit 1323;
                               BEGIN
                                 IF CancelPstdSalesInvYesNo.CancelInvoice(Rec) THEN
                                   CurrPage.CLOSE;
                               END;
                                }
      { 33      ;2   ;Action    ;
                      Name=CreateCreditMemo;
                      CaptionML=[ENU=Create Corrective Credit Memo;
                                 RUS=Создать корректирующую кредит-ноту];
                      ToolTipML=[ENU=Create a credit memo for this posted invoice that you complete and post manually to reverse the posted invoice.;
                                 RUS=Создание кредит-ноты для этого учтенного счета, которая будет заполнена и вручную учтена для сторнирования учтенного счета.];
                      ApplicationArea=#Basic,#Suite;
                      Image=CreateCreditMemo;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 SalesHeader@1001 : Record 36;
                                 CorrectPostedSalesInvoice@1000 : Codeunit 1303;
                               BEGIN
                                 CorrectPostedSalesInvoice.CreateCreditMemoCopyDocument(Rec,SalesHeader);
                                 PAGE.RUN(PAGE::"Sales Credit Memo",SalesHeader);
                                 CurrPage.CLOSE;
                               END;
                                }
      { 51      ;1   ;ActionGroup;
                      CaptionML=[ENU=Invoice;
                                 RUS=Счет];
                      Image=Invoice }
      { 49      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Customer;
                                 RUS=Клиент];
                      ToolTipML=[ENU=View or edit detailed information about the customer.;
                                 RUS=Просмотр или изменение подробных сведений о клиенте.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 21;
                      RunPageLink=No.=FIELD(Sell-to Customer No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Customer;
                      PromotedCategory=Category4;
                      PromotedOnly=Yes }
      { 47      ;2   ;Action    ;
                      Name=ShowCreditMemo;
                      CaptionML=[ENU=Show Canceled/Corrective Credit Memo;
                                 RUS=Показать отмененную/корректирующую кредит-ноту];
                      ToolTipML=[ENU=Open the posted sales credit memo that was created when you canceled the posted sales invoice. If the posted sales invoice is the result of a canceled sales credit memo, then canceled sales credit memo will open.;
                                 RUS=Открытие учтенной кредит-ноты продажи, которая была создана при отмене учтенного счета продажи. Если учтенный счет продажи является результатом отмененной кредит-ноты, то будет открыта отмененная кредит-нота продажи.];
                      ApplicationArea=#Basic,#Suite;
                      Enabled=Cancelled OR Corrective;
                      Image=CreditMemo;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowCanceledOrCorrCrMemo;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           RUS=Общее] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posted invoice number.;
                           RUS=Определяет номер учтенного счета.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No.";
                Importance=Promoted;
                Editable=FALSE }

    { 61  ;2   ;Field     ;
                CaptionML=[ENU=Customer;
                           RUS=Клиент];
                ToolTipML=[ENU=Specifies the name of the customer that you shipped the items on the invoice to.;
                           RUS=Определяет имя клиента, которому были отгружены товары по счету.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Customer Name";
                TableRelation=Customer.Name;
                Importance=Promoted;
                Editable=FALSE }

    { 4   ;2   ;Group     ;
                CaptionML=[ENU=Sell-to;
                           RUS=Клиент];
                GroupType=Group }

    { 63  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           RUS=Адрес];
                ToolTipML=[ENU=Specifies the address of the customer that the items on the invoice were shipped to.;
                           RUS=Определяет адрес клиента, которому были отгружены товары по счету.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address";
                Importance=Additional;
                Editable=FALSE }

    { 65  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           RUS=Адрес 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           RUS=Определяет дополнительные сведения адреса.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 6   ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           RUS=Индекс];
                ToolTipML=[ENU=Specifies the postal code.;
                           RUS=Определяет почтовый индекс.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 67  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           RUS=Город];
                ToolTipML=[ENU=Specifies the city the items on the invoice were shipped to.;
                           RUS=Определяет город, в который были отгружены товары по счету.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to City";
                Importance=Additional;
                Editable=FALSE }

    { 96  ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           RUS=Код контакта];
                ToolTipML=[ENU=Specifies the number of the contact that the invoice was sent to.;
                           RUS=Определяет номер контакта, которому был отправлен счет.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 69  ;2   ;Field     ;
                CaptionML=[ENU=Contact;
                           RUS=Контакт];
                ToolTipML=[ENU=Specifies the name of the person to contact when you communicate with the customer who you shipped the items to.;
                           RUS=Определяет имя контактного лица при взаимодействии с клиентом, которому отправлены товары.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sell-to Contact";
                Editable=FALSE }

    { 1210007;2;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Description";
                Editable=FALSE }

    { 25  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which you created the sales document.;
                           RUS=Определяет дату создания этого документа продажи.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Date";
                Importance=Additional;
                Editable=FALSE }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the invoice was posted.;
                           RUS=Определяет дату, когда был выполнен учет счета.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Posting Date";
                Editable=FALSE }

    { 68  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on which the invoice is due for payment.;
                           RUS=Определяет дату, когда должна быть совершена оплата по счету.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Due Date";
                Importance=Promoted;
                Editable=FALSE }

    { 3   ;2   ;Group     ;
                Visible=DocExcStatusVisible;
                GroupType=Group }

    { 27  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the status of the document if you are using a document exchange service to send it as an electronic document. The status values are reported by the document exchange service.;
                           RUS=Определяет состояние документа, если для его отправки в виде электронного документа используется служба обмена документами. Значения состояния предоставляются службой обмена документами.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Exchange Status";
                Importance=Additional;
                Editable=FALSE;
                StyleExpr=DocExchStatusStyle;
                OnDrillDown=VAR
                              DocExchServDocStatus@1000 : Codeunit 1420;
                            BEGIN
                              DocExchServDocStatus.DocExchStatusDrillDown(Rec);
                            END;
                             }

    { 114 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the sales quote document if a quote was used to start the sales process.;
                           RUS=Определяет номер документа предложения по продаже, если для начала процесса продажи использовалось предложение.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Quote No." }

    { 86  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the sales order that this invoice was posted from.;
                           RUS=Определяет номер заказа на продажу, из которого учитывался этот счет.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Order No.";
                Importance=Promoted;
                Editable=FALSE }

    { 73  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the sales document that the posted invoice was created for.;
                           RUS=Определяет номер документа продажи, для которого был создан учтенный счет.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pre-Assigned No.";
                Importance=Additional;
                Editable=FALSE }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the external document number that is entered on the sales header that this line was posted from.;
                           RUS=Определяет номер внешнего документа, который указывается в заголовке продажи и из которого была учтена эта строка.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="External Document No.";
                Importance=Additional;
                Editable=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which salesperson is associated with the invoice.;
                           RUS=Определяет менеджера по продажам, связанного со счетом.];
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code";
                Importance=Additional;
                Editable=FALSE }

    { 92  ;2   ;Field     ;
                AccessByPermission=TableData 5714=R;
                ToolTipML=[ENU=Specifies the code of the responsibility center associated with the user who created the invoice, your company, or the customer in the sales invoice.;
                           RUS=Определяет код центра ответственности, связанного с пользователем, создавшим счет, с организацией или с клиентом в счете продажи.];
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Editable=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how many times the invoice has been printed.;
                           RUS=Определяет, сколько раз был напечатан счет.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="No. Printed";
                Importance=Additional;
                Editable=FALSE }

    { 77  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted sales invoice has been either corrected or canceled.;
                           RUS=Определяет, был ли учтенный счет продажи скорректирован или отменен.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Cancelled;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Cancelled;
                OnDrillDown=BEGIN
                              ShowCorrectiveCreditMemo;
                            END;
                             }

    { 102 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted sales invoice is a corrective document.;
                           RUS=Указывает, является ли учтенный счет продажи корректирующим документом.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Corrective;
                Importance=Additional;
                Style=Unfavorable;
                StyleExpr=Corrective;
                OnDrillDown=BEGIN
                              ShowCancelledCreditMemo;
                            END;
                             }

    { 76  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the posted invoice is paid. The check box will also be selected if a credit memo for the remaining amount has been applied.;
                           RUS=Определяет, был ли оплачен учтенный счет. Флажок также будет установлен, если была применена кредит-нота на оставшуюся сумму.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Closed;
                Importance=Promoted }

    { 83  ;2   ;Group     ;
                CaptionML=[ENU=Work Description;
                           RUS=Описание работы];
                GroupType=Group }

    { 82  ;3   ;Field     ;
                SourceExpr=GetWorkDescription;
                Importance=Additional;
                Editable=FALSE;
                MultiLine=Yes }

    { 54  ;1   ;Part      ;
                Name=SalesInvLines;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page133 }

    { 16  ;1   ;Group     ;
                CaptionML=[ENU=Invoice Details;
                           RUS=Счет - подробности];
                GroupType=Group }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code of the invoice.;
                           RUS=Определяет код валюты счета.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Promoted;
                Editable=FALSE;
                OnAssistEdit=BEGIN
                               ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                               ChangeExchangeRate.EDITABLE(FALSE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 "Currency Factor" := ChangeExchangeRate.GetParameter;
                                 MODIFY;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 62  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the shipment date. It is copied from the Shipment Date field on the sales header and is used for planning purposes.;
                           RUS=Определяет дату отгрузки. Она копируется из поля "Дата отгрузки" в заголовке продажи и используется для планирования.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Date";
                Importance=Promoted;
                Editable=FALSE }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a formula that calculates the payment due date, payment discount date, and payment discount amount on the sales document.;
                           RUS=Определяет формулу, по которой рассчитывается срок оплаты, дата скидки по оплате и сумма скидки по оплате по документу продажи.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Promoted;
                Editable=FALSE }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how the customer must pay for products on the sales document.;
                           RUS=Определяет, как клиент должен оплатить продукты по документу продажи.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                Importance=Additional;
                Editable=FALSE }

    { 15  ;2   ;Group     ;
                Visible=PaymentServiceVisible;
                GroupType=Group }

    { 64  ;3   ;Field     ;
                Name=SelectedPayments;
                CaptionML=[ENU=Payment Service;
                           RUS=Служба платежей];
                ToolTipML=[ENU=Specifies the payment service, such as PayPal, that the sales invoice can be paid with.;
                           RUS=Определяет службу платежей, с помощью которой можно оплачивать счета, например PayPal.];
                ApplicationArea=#All;
                SourceExpr=GetSelectedPaymentsText;
                Enabled=PaymentServiceEnabled;
                Editable=FALSE;
                MultiLine=Yes;
                OnAssistEdit=VAR
                               PaymentServiceSetup@1000 : Record 1060;
                             BEGIN
                               PaymentServiceSetup.ChangePaymentServicePostedInvoice(Rec);
                               CurrPage.UPDATE(FALSE);
                             END;
                              }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the invoice.;
                           RUS=Определяет код значения измерения, связанный со счетом.];
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FALSE }

    { 32  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the dimension value code associated with the invoice.;
                           RUS=Определяет код значения измерения, связанный со счетом.];
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FALSE }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the payment discount percentage granted if payment is made by the date entered in the Pmt. Discount Date field.;
                           RUS=Определяет процент скидки по оплате, которая предоставляется при условии оплаты не позже даты, указанной в поле "Дата скидки оплаты".];
                SourceExpr="Payment Discount %";
                Editable=FALSE }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date by which the invoice must be paid to obtain a payment discount.;
                           RUS=Определяет дату, на которую должен быть оплачен счет для получения скидки по оплате.];
                SourceExpr="Pmt. Discount Date";
                Importance=Additional;
                Editable=FALSE }

    { 70  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the direct-debit mandate that the customer has signed to allow direct debit collection of payments.;
                           RUS=Определяет поручение прямого дебетования, подписанное клиентом, чтобы разрешить сбор платежей по принципу прямого дебита.];
                SourceExpr="Direct Debit Mandate ID";
                Editable=FALSE }

    { 1210005;2;Field     ;
                ToolTipML=[ENU=Specifies the agreement number associated with this sales invoice header.;
                           RUS=Определяет номер соглашения, связанный с этим заголовком счета продажи.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Agreement No.";
                Editable=FALSE }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the location from which the items were shipped.;
                           RUS=Определяет код склада, c которого были отгружены товары.];
                SourceExpr="Location Code";
                Importance=Additional;
                Editable=FALSE }

    { 53  ;1   ;Group     ;
                CaptionML=[ENU=Shipping and Billing;
                           RUS=Отгрузка и выставление счетов];
                GroupType=Group }

    { 80  ;2   ;Group     ;
                CaptionML=[ENU=Shipping Details;
                           RUS=Сведения об отгрузке];
                GroupType=Group }

    { 71  ;3   ;Field     ;
                CaptionML=[ENU=Method;
                           RUS=Способ];
                ToolTipML=[ENU=Specifies the code that represents the shipment method for the invoice.;
                           RUS=Определяет код метода поставки для этого счета.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Shipment Method Code";
                Importance=Additional;
                Editable=FALSE }

    { 79  ;3   ;Field     ;
                CaptionML=[ENU=Agent;
                           RUS=Агент];
                ToolTipML=[ENU=Specifies which shipping agent is used to transport the items on the sales document to the customer.;
                           RUS=Определяет экспедитора, который используется для транспортировки клиенту товаров из документа продажи.];
                ApplicationArea=#Suite;
                SourceExpr="Shipping Agent Code";
                Importance=Additional;
                Editable=FALSE }

    { 81  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the shipping agent's package number.;
                           RUS=Определяет номер пакета экспедитора.];
                ApplicationArea=#Suite;
                SourceExpr="Package Tracking No.";
                Importance=Additional;
                Editable=FALSE }

    { 1905885101;2;Group  ;
                CaptionML=[ENU=Ship-to;
                           RUS=Получатель];
                GroupType=Group }

    { 56  ;3   ;Field     ;
                CaptionML=[ENU=Address Code;
                           RUS=Код адреса];
                ToolTipML=[ENU=Specifies the address on purchase orders shipped with a drop shipment directly from the vendor to a customer.;
                           RUS=Определяет адрес в заказах покупки, отгрузка по которым будет произведена посредством прямой поставки от поставщика к клиенту.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Code";
                Importance=Promoted;
                Editable=FALSE }

    { 46  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           RUS=Название];
                ToolTipML=[ENU=Specifies the name of the customer that the items were shipped to.;
                           RUS=Определяет имя клиента, которому были отгружены товары.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Name";
                Editable=FALSE }

    { 1210011;3;Field     ;
                ToolTipML=[ENU=Specifies the consignor number associated with this sales invoice header.;
                           RUS=Определяет номер грузоотправителя, связанный с этим заголовком счета продажи.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Consignor No.";
                Editable=FALSE }

    { 1210002;3;Field     ;
                ToolTipML=[ENU=Specifies the code of the company registration associated with this sales invoice header.;
                           RUS=Определяет код регистрации компании, связанный с этим заголовком счета продажи.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="KPP Code";
                Editable=FALSE }

    { 42  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           RUS=Адрес];
                ToolTipML=[ENU=Specifies the address that the items on the invoice were shipped to.;
                           RUS=Определяет адрес, по которому были отгружены товары по счету.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address";
                Editable=FALSE }

    { 44  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           RUS=Адрес 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           RUS=Определяет дополнительные сведения адреса.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Address 2";
                Editable=FALSE }

    { 40  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           RUS=Индекс];
                ToolTipML=[ENU=Specifies the postal code.;
                           RUS=Определяет почтовый индекс.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Post Code";
                Editable=FALSE }

    { 38  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           RUS=Город];
                ToolTipML=[ENU=Specifies the city the items on the invoice were shipped to.;
                           RUS=Определяет город, в который были отгружены товары по счету.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to City";
                Editable=FALSE }

    { 36  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           RUS=Контакт];
                ToolTipML=[ENU=Specifies the name of the person you regularly contact at the address that the items were shipped to.;
                           RUS=Определяет имя лица, с которым вы регулярно контактируете, по адресу отгрузки товаров.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ship-to Contact";
                Editable=FALSE }

    { 60  ;2   ;Group     ;
                CaptionML=[ENU=Bill-to;
                           RUS=Плательщик];
                GroupType=Group }

    { 18  ;3   ;Field     ;
                CaptionML=[ENU=Name;
                           RUS=Название];
                ToolTipML=[ENU=Specifies the name of the customer that the invoice was sent to.;
                           RUS=Определяет имя клиента, которому был отправлен счет.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Name";
                Importance=Promoted;
                Editable=FALSE }

    { 20  ;3   ;Field     ;
                CaptionML=[ENU=Address;
                           RUS=Адрес];
                ToolTipML=[ENU=Specifies the address of the customer that the invoice was sent to.;
                           RUS=Определяет адрес клиента, которому был отправлен счет.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Address";
                Importance=Additional;
                Editable=FALSE }

    { 22  ;3   ;Field     ;
                CaptionML=[ENU=Address 2;
                           RUS=Адрес 2];
                ToolTipML=[ENU=Specifies additional address information.;
                           RUS=Определяет дополнительные сведения адреса.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Address 2";
                Importance=Additional;
                Editable=FALSE }

    { 78  ;3   ;Field     ;
                CaptionML=[ENU=Post Code;
                           RUS=Индекс];
                ToolTipML=[ENU=Specifies the postal code.;
                           RUS=Определяет почтовый индекс.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Post Code";
                Importance=Additional;
                Editable=FALSE }

    { 24  ;3   ;Field     ;
                CaptionML=[ENU=City;
                           RUS=Город];
                ToolTipML=[ENU=Specifies the city of the customer that the invoice was sent to.;
                           RUS=Определяет город клиента, которому был отправлен счет.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to City";
                Importance=Additional;
                Editable=FALSE }

    { 98  ;3   ;Field     ;
                CaptionML=[ENU=Contact No.;
                           RUS=Код контакта];
                ToolTipML=[ENU=Specifies the number of the contact the invoice was sent to.;
                           RUS=Определяет номер контакта, которому был отправлен счет.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Contact No.";
                Importance=Additional;
                Editable=FALSE }

    { 26  ;3   ;Field     ;
                CaptionML=[ENU=Contact;
                           RUS=Контакт];
                ToolTipML=[ENU=Specifies the name of the person you regularly contact when you communicate with the customer to whom the invoice was sent.;
                           RUS=Определяет имя лица, с которым осуществляются регулярные контакты при взаимодействии с клиентом, которому был отправлен счет.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Bill-to Contact";
                Editable=FALSE }

    { 1907468901;1;Group  ;
                CaptionML=[ENU=Foreign Trade;
                           RUS=Внешняя торговля] }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether the invoice was part of an EU 3-party trade transaction.;
                           RUS=Определяет, был ли счет частью транзакции трехсторонней торговли в ЕС.];
                SourceExpr="EU 3-Party Trade";
                Editable=FALSE }

    { 31  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the transaction specification that was used in the invoice.;
                           RUS=Определяет спецификацию транзакции, используемой в счете.];
                SourceExpr="Transaction Specification";
                Editable=FALSE }

    { 72  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the transport method of the sales header that this line was posted from.;
                           RUS=Определяет метод перевозки из заголовка продажи, откуда была учтена эта строка.];
                SourceExpr="Transport Method";
                Editable=FALSE }

    { 74  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the port of exit through which you shipped the items out of your country/region.;
                           RUS=Определяет код порта выхода, через который производится отгрузка товаров за пределы страны или региона.];
                SourceExpr="Exit Point";
                Editable=FALSE }

    { 75  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the area code used in the invoice.;
                           RUS=Определяет код области, который используется в счете.];
                SourceExpr=Area;
                Editable=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 11  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                PagePartID=Page193;
                Visible=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      SalesInvHeader@1000 : Record 112;
      ChangeExchangeRate@1001 : Page 511;
      HasIncomingDocument@1002 : Boolean;
      DocExchStatusStyle@1003 : Text;
      CRMIntegrationEnabled@1004 : Boolean;
      CRMIsCoupledToRecord@1005 : Boolean;
      PaymentServiceVisible@1007 : Boolean;
      PaymentServiceEnabled@1008 : Boolean;
      DocExcStatusVisible@1006 : Boolean;
      IsOfficeAddin@1009 : Boolean;
      Text55000@1101495000 : TextConst 'ENU=You can not remove the posted documents;RUS=Вы не можете удалить учтенный документ';

    LOCAL PROCEDURE UpdatePaymentService@7();
    VAR
      PaymentServiceSetup@1000 : Record 1060;
    BEGIN
      PaymentServiceVisible := PaymentServiceSetup.IsPaymentServiceVisible;
      PaymentServiceEnabled := PaymentServiceSetup.CanChangePaymentService(Rec);
    END;

    BEGIN
    {
      NC S729 PCH Блокировка удаления
      -----
      NC NOS-26 ENK
    }
    END.
  }
}

