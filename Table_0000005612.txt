OBJECT Table 5612 FA Depreciation Book
{
  OBJECT-PROPERTIES
  {
    Date=30.05.17;
    Time=17:40:08;
    Modified=Yes;
    Version List=NAVW110.00,NAVRU10.00,NOS-26;
  }
  PROPERTIES
  {
    Permissions=TableData 5601=r,
                TableData 5625=r;
    OnInsert=VAR
               TaxRegisterSetup@1000 : Record 17236;
             BEGIN
               "Acquisition Date" := 0D;
               "G/L Acquisition Date" := 0D;
               "Last Acquisition Cost Date" := 0D;
               "Last Salvage Value Date" := 0D;
               "Last Depreciation Date" := 0D;
               "Last Write-Down Date" := 0D;
               "Last Appreciation Date" := 0D;
               "Last Custom 1 Date" := 0D;
               "Last Custom 2 Date" := 0D;
               "Disposal Date" := 0D;
               "Last Maintenance Date" := 0D;
               LOCKTABLE;
               FA.LOCKTABLE;
               DeprBook.LOCKTABLE;
               FA.GET("FA No.");
               DeprBook.GET("Depreciation Book Code");
               Description := FA.Description;
               "Main Asset/Component" := FA."Main Asset/Component";
               "Component of Main Asset" := FA."Component of Main Asset";
               IF ("No. of Depreciation Years" <> 0) OR ("No. of Depreciation Months" <> 0) THEN
                 DeprBook.TESTFIELD("Fiscal Year 365 Days",FALSE);

               //NC > MP 06.03.07
               "Inventory Number" := FA."Inventory Number";
               //NC < MP 06.03.07

               IF TaxRegisterSetup.GET THEN
                 IF "Depreciation Book Code" = TaxRegisterSetup."Tax Depreciation Book" THEN
                   "Depr. Bonus %" := TaxRegisterSetup."Default Depr. Bonus %";

               //NC NCS-1284 > DP
               IF "No. of Depreciation Months"<>0 THEN
                 SynchroniseIt(0);
               //NC NCS-1284 < DP
             END;

    OnModify=BEGIN
               "Last Date Modified" := TODAY;
               LOCKTABLE;
               DeprBook.LOCKTABLE;
               DeprBook.GET("Depreciation Book Code");
               IF ("No. of Depreciation Years" <> 0) OR ("No. of Depreciation Months" <> 0) THEN
                 DeprBook.TESTFIELD("Fiscal Year 365 Days",FALSE);
             END;

    OnDelete=BEGIN
               FAMoveEntries.MoveFAEntries(Rec);
             END;

    OnRename=BEGIN
               ERROR(Text000,TABLECAPTION);
             END;

    CaptionML=[ENU=FA Depreciation Book;
               RUS=Книга амортизации ОС];
  }
  FIELDS
  {
    { 1   ;   ;FA No.              ;Code20        ;TableRelation="Fixed Asset";
                                                   CaptionML=[ENU=FA No.;
                                                              RUS=Номер ОС];
                                                   NotBlank=Yes }
    { 2   ;   ;Depreciation Book Code;Code10      ;TableRelation="Depreciation Book";
                                                   OnValidate=VAR
                                                                "NCV >"@1101495002 : Integer;
                                                                DeprBook1@1101495001 : Record 5611;
                                                                "NCV <"@1101495000 : Integer;
                                                              BEGIN
                                                                //NC > MP 28.02.07
                                                                IF DeprBook1.GET("Depreciation Book Code") THEN
                                                                  "Currency Code" := DeprBook1."Currency Code";
                                                                //NC < MP 28.02.07
                                                              END;

                                                   CaptionML=[ENU=Depreciation Book Code;
                                                              RUS=Код книги амортизации];
                                                   NotBlank=Yes }
    { 3   ;   ;Depreciation Method ;Option        ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                CASE "Depreciation Method" OF
                                                                  "Depreciation Method"::"SL-RU":
                                                                    BEGIN
                                                                      CalcDeprPeriod;
                                                                      "Declining-Balance %" := 0;
                                                                      "Depreciation Table Code" := '';
                                                                      "First User-Defined Depr. Date" := 0D;
                                                                    END;
                                                                  "Depreciation Method"::"Straight-Line":
                                                                    BEGIN
                                                                      "Declining-Balance %" := 0;
                                                                      "Depreciation Table Code" := '';
                                                                      "First User-Defined Depr. Date" := 0D;
                                                                      "Use DB% First Fiscal Year" := FALSE;
                                                                    END;
                                                                  "Depreciation Method"::"Declining-Balance 1",
                                                                  "Depreciation Method"::"Declining-Balance 2":
                                                                    BEGIN
                                                                      "Straight-Line %" := 0;
                                                                      "No. of Depreciation Years" := 0;
                                                                      "No. of Depreciation Months" := 0;
                                                                      "Fixed Depr. Amount" := 0;
                                                                      "Depreciation Ending Date" := 0D;
                                                                      "Depreciation Table Code" := '';
                                                                      "First User-Defined Depr. Date" := 0D;
                                                                      "Use DB% First Fiscal Year" := FALSE;
                                                                    END;
                                                                  "Depreciation Method"::"DB/SL-RU",
                                                                  "Depreciation Method"::"DB1/SL",
                                                                  "Depreciation Method"::"DB2/SL":
                                                                    BEGIN
                                                                      "Depreciation Table Code" := '';
                                                                      "First User-Defined Depr. Date" := 0D;
                                                                    END;
                                                                  "Depreciation Method"::"User-Defined":
                                                                    BEGIN
                                                                      "Straight-Line %" := 0;
                                                                      "No. of Depreciation Years" := 0;
                                                                      "No. of Depreciation Months" := 0;
                                                                      "Fixed Depr. Amount" := 0;
                                                                      "Depreciation Ending Date" := 0D;
                                                                      "Declining-Balance %" := 0;
                                                                      "Use DB% First Fiscal Year" := FALSE;
                                                                    END;
                                                                  "Depreciation Method"::Manual:
                                                                    BEGIN
                                                                      "Straight-Line %" := 0;
                                                                      "No. of Depreciation Years" := 0;
                                                                      "No. of Depreciation Months" := 0;
                                                                      "Fixed Depr. Amount" := 0;
                                                                      "Depreciation Ending Date" := 0D;
                                                                      "Declining-Balance %" := 0;
                                                                      "Depreciation Table Code" := '';
                                                                      "First User-Defined Depr. Date" := 0D;
                                                                      "Use DB% First Fiscal Year" := FALSE;
                                                                    END;
                                                                  "Depreciation Method"::"DB/SL-RU Tax Group":
                                                                    BEGIN
                                                                      FA.GET("FA No.");
                                                                      FA.TESTFIELD("Depreciation Group");
                                                                      DeprGroup.GET(FA."Depreciation Group");
                                                                      DeprGroup.TESTFIELD("Tax Depreciation Rate");
                                                                      DeprGroup.TESTFIELD("Depreciation Factor");
                                                                      TaxRegisterSetup.GET;
                                                                      TaxRegisterSetup.TESTFIELD("Use Group Depr. Method from");
                                                                    END;
                                                                END;
                                                                TestHalfYearConventionMethod;
                                                              END;

                                                   CaptionML=[ENU=Depreciation Method;
                                                              RUS=Метод амортизации];
                                                   OptionCaptionML=[ENU=Straight-Line,Declining-Balance 1,Declining-Balance 2,DB1/SL,DB2/SL,User-Defined,Manual,SL-RU,DB/SL-RU,DB/SL-RU Tax Group;
                                                                    RUS=Линейный,Уменьш. остатка 1,Уменьш. остатка 2,Ум. ост. 1/линейный,Ум. ост. 2/линейный,Пользовательский,Вручную,Линейный (Россия),Ум. ост./лин. (Россия),Ум. ост./лин. (Россия) - группа нал.];
                                                   OptionString=Straight-Line,Declining-Balance 1,Declining-Balance 2,DB1/SL,DB2/SL,User-Defined,Manual,SL-RU,DB/SL-RU,DB/SL-RU Tax Group }
    { 4   ;   ;Depreciation Starting Date;Date    ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                CalcDeprPeriod;
                                                              END;

                                                   CaptionML=[ENU=Depreciation Starting Date;
                                                              RUS=Дата начала амортизации];
                                                   Editable=Yes }
    { 5   ;   ;Straight-Line %     ;Decimal       ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                IF ("Straight-Line %" <> 0) AND NOT LinearMethod THEN
                                                                  DeprMethodError;
                                                                AdjustLinearMethod("No. of Depreciation Years","Fixed Depr. Amount");
                                                              END;

                                                   CaptionML=[ENU=Straight-Line %;
                                                              RUS=Линейный (%)];
                                                   DecimalPlaces=2:8;
                                                   MinValue=0 }
    { 6   ;   ;No. of Depreciation Years;Decimal  ;OnValidate=VAR
                                                                DeprBook2@1000 : Record 5611;
                                                              BEGIN
                                                                DeprBook2.GET("Depreciation Book Code");
                                                                DeprBook2.TESTFIELD("Fiscal Year 365 Days",FALSE);

                                                                IF "Depreciation Starting Date" <> 0D THEN BEGIN
                                                                  ModifyDeprFields;
                                                                  IF ("No. of Depreciation Years" <> 0) AND NOT LinearMethod THEN
                                                                    DeprMethodError;

                                                                  "No. of Depreciation Months" := ROUND("No. of Depreciation Years" * 12,0.00000001);
                                                                  AdjustLinearMethod("Straight-Line %","Fixed Depr. Amount");
                                                                  "Depreciation Ending Date" := CalcEndingDate;

                                                                  IF "Depreciation Method" = "Depreciation Method"::"DB/SL-RU" THEN
                                                                    "Declining-Balance %" := ROUND(100 / "No. of Depreciation Months",0.00000001);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No. of Depreciation Years;
                                                              RUS=Число лет амортизации];
                                                   DecimalPlaces=2:8;
                                                   MinValue=0;
                                                   BlankZero=Yes }
    { 7   ;   ;No. of Depreciation Months;Decimal ;OnValidate=VAR
                                                                DeprBook2@1000 : Record 5611;
                                                              BEGIN
                                                                DeprBook2.GET("Depreciation Book Code");
                                                                DeprBook2.TESTFIELD("Fiscal Year 365 Days",FALSE);

                                                                ModifyDeprFields;
                                                                IF ("No. of Depreciation Months" <> 0) AND NOT LinearMethod THEN
                                                                  DeprMethodError;

                                                                "No. of Depreciation Years" := ROUND("No. of Depreciation Months" / 12,0.00000001);
                                                                AdjustLinearMethod("Straight-Line %","Fixed Depr. Amount");
                                                                "Depreciation Ending Date" := CalcEndingDate;

                                                                IF "Depreciation Method" = "Depreciation Method"::"DB/SL-RU" THEN
                                                                  "Declining-Balance %" := ROUND(100 / "No. of Depreciation Months",0.00000001);
                                                              END;

                                                   CaptionML=[ENU=No. of Depreciation Months;
                                                              RUS=Число месяцев амортизации];
                                                   DecimalPlaces=2:8;
                                                   MinValue=0;
                                                   BlankZero=Yes }
    { 8   ;   ;Fixed Depr. Amount  ;Decimal       ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                IF ("Fixed Depr. Amount" <> 0) AND NOT LinearMethod THEN
                                                                  DeprMethodError;
                                                                AdjustLinearMethod("Straight-Line %","No. of Depreciation Years");
                                                              END;

                                                   CaptionML=[ENU=Fixed Depr. Amount;
                                                              RUS=Фиксированная cумма амортизации];
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 9   ;   ;Declining-Balance % ;Decimal       ;OnValidate=BEGIN
                                                                IF "Declining-Balance %" >= 100 THEN
                                                                  FIELDERROR("Declining-Balance %",Text001);
                                                                ModifyDeprFields;
                                                                IF ("Declining-Balance %" <> 0) AND NOT DecliningMethod THEN
                                                                  DeprMethodError;
                                                              END;

                                                   CaptionML=[ENU=Declining-Balance %;
                                                              RUS=Уменьш. остатка, %];
                                                   DecimalPlaces=2:8;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 10  ;   ;Depreciation Table Code;Code10     ;TableRelation="Depreciation Table Header";
                                                   OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                IF ("Depreciation Table Code" <> '') AND NOT UserDefinedMethod THEN
                                                                  DeprMethodError;
                                                              END;

                                                   CaptionML=[ENU=Depreciation Table Code;
                                                              RUS=Код таблицы амортизации] }
    { 11  ;   ;Final Rounding Amount;Decimal      ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=[ENU=Final Rounding Amount;
                                                              RUS=Оконч. сумма округления];
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 12  ;   ;Ending Book Value   ;Decimal       ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=[ENU=Ending Book Value;
                                                              RUS=Конечная бал. стоимость];
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 13  ;   ;FA Posting Group    ;Code10        ;TableRelation="FA Posting Group";
                                                   OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=[ENU=FA Posting Group;
                                                              RUS=Учетная группа ОС] }
    { 14  ;   ;Depreciation Ending Date;Date      ;OnValidate=BEGIN
                                                                TESTFIELD("Depreciation Starting Date");
                                                                IF ("Depreciation Ending Date" <> 0D) AND NOT LinearMethod THEN
                                                                  DeprMethodError;
                                                                ModifyDeprFields;
                                                                CalcDeprPeriod;
                                                              END;

                                                   CaptionML=[ENU=Depreciation Ending Date;
                                                              RUS=Дата окончания амортизации] }
    { 15  ;   ;Acquisition Cost    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Acquisition Cost),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Acquisition Cost;
                                                              RUS=Стоимость приобретения];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 16  ;   ;Depreciation        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Depreciation),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Depreciation;
                                                              RUS=Амортизация];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 17  ;   ;Book Value          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   Part of Book Value=CONST(Yes),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Book Value;
                                                              RUS=Балансовая стоимость];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 18  ;   ;Proceeds on Disposal;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Proceeds on Disposal),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Proceeds on Disposal;
                                                              RUS=Поступления от реализации];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 19  ;   ;Gain/Loss           ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Gain/Loss),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Gain/Loss;
                                                              RUS=Прибыль/убыток];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 20  ;   ;Write-Down          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Write-Down),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Write-Down;
                                                              RUS=Понижение стоимости];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 21  ;   ;Appreciation        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Appreciation),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Appreciation;
                                                              RUS=Повышение стоимости];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 22  ;   ;Custom 1            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Custom 1),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Custom 1;
                                                              RUS=Польз. метод 1];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 23  ;   ;Custom 2            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Custom 2),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Custom 2;
                                                              RUS=Польз. метод 2];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 24  ;   ;Depreciable Basis   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   Part of Depreciable Basis=CONST(Yes),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Depreciable Basis;
                                                              RUS=Базис амортизации];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 25  ;   ;Salvage Value       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Salvage Value),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Salvage Value;
                                                              RUS=Ликвидационная стоимость];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 26  ;   ;Book Value on Disposal;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(Disposal),
                                                                                                   FA Posting Type=CONST(Book Value on Disposal),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Book Value on Disposal;
                                                              RUS=Бал. стоимость при реализации];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 27  ;   ;Maintenance         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Maintenance Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                            Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                            Maintenance Code=FIELD(Maintenance Code Filter),
                                                                                                            FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                            FA Location Code=FIELD(FA Location Code Filter),
                                                                                                            Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                            Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                            Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Maintenance;
                                                              RUS=Обслуживание];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 28  ;   ;Maintenance Code Filter;Code10     ;FieldClass=FlowFilter;
                                                   TableRelation=Maintenance;
                                                   CaptionML=[ENU=Maintenance Code Filter;
                                                              RUS=Фильтр по коду обслуживания] }
    { 29  ;   ;FA Posting Date Filter;Date        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=FA Posting Date Filter;
                                                              RUS=Фильтр по дате учета ОС] }
    { 30  ;   ;Acquisition Date    ;Date          ;CaptionML=[ENU=Acquisition Date;
                                                              RUS=Дата приобретения];
                                                   Editable=No }
    { 31  ;   ;G/L Acquisition Date;Date          ;CaptionML=[ENU=G/L Acquisition Date;
                                                              RUS=Дата приобретения ГК];
                                                   Editable=No }
    { 32  ;   ;Disposal Date       ;Date          ;CaptionML=[ENU=Disposal Date;
                                                              RUS=Дата реализации];
                                                   Editable=No }
    { 33  ;   ;Last Acquisition Cost Date;Date    ;CaptionML=[ENU=Last Acquisition Cost Date;
                                                              RUS=Посл. дата стоимости приобретения];
                                                   Editable=No }
    { 34  ;   ;Last Depreciation Date;Date        ;CaptionML=[ENU=Last Depreciation Date;
                                                              RUS=Дата последней амортизации];
                                                   Editable=No }
    { 35  ;   ;Last Write-Down Date;Date          ;CaptionML=[ENU=Last Write-Down Date;
                                                              RUS=Посл. дата понижения стоимости];
                                                   Editable=No }
    { 36  ;   ;Last Appreciation Date;Date        ;CaptionML=[ENU=Last Appreciation Date;
                                                              RUS=Посл. дата повышения стоимости];
                                                   Editable=No }
    { 37  ;   ;Last Custom 1 Date  ;Date          ;CaptionML=[ENU=Last Custom 1 Date;
                                                              RUS=Посл. дата польз. метода 1];
                                                   Editable=No }
    { 38  ;   ;Last Custom 2 Date  ;Date          ;CaptionML=[ENU=Last Custom 2 Date;
                                                              RUS=Посл. дата польз. метода 2];
                                                   Editable=No }
    { 39  ;   ;Last Salvage Value Date;Date       ;CaptionML=[ENU=Last Salvage Value Date;
                                                              RUS=Посл. дата ликвид. стоимости];
                                                   Editable=No }
    { 40  ;   ;FA Exchange Rate    ;Decimal       ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=[ENU=FA Exchange Rate;
                                                              RUS=Курс валюты для ОС];
                                                   DecimalPlaces=4:4;
                                                   MinValue=0 }
    { 41  ;   ;Fixed Depr. Amount below Zero;Decimal;
                                                   OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                "Depr. below Zero %" := 0;
                                                                IF "Fixed Depr. Amount below Zero" > 0 THEN BEGIN
                                                                  DeprBook.GET("Depreciation Book Code");
                                                                  DeprBook.TESTFIELD("Allow Depr. below Zero",TRUE);
                                                                  TESTFIELD("Use FA Ledger Check",TRUE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Fixed Depr. Amount below Zero;
                                                              RUS=Фиксир. отриц. сумма аморт.];
                                                   MinValue=0;
                                                   BlankZero=Yes;
                                                   AutoFormatType=1 }
    { 42  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              RUS=Дата последнего изменения];
                                                   Editable=No }
    { 43  ;   ;First User-Defined Depr. Date;Date ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                IF ("First User-Defined Depr. Date" <> 0D) AND NOT UserDefinedMethod THEN
                                                                  DeprMethodError;
                                                              END;

                                                   CaptionML=[ENU=First User-Defined Depr. Date;
                                                              RUS=Первая польз. дата аморт.] }
    { 44  ;   ;Use FA Ledger Check ;Boolean       ;InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                IF NOT "Use FA Ledger Check" THEN BEGIN
                                                                  DeprBook.GET("Depreciation Book Code");
                                                                  DeprBook.TESTFIELD("Use FA Ledger Check",FALSE);
                                                                  TESTFIELD("Fixed Depr. Amount below Zero",0);
                                                                  TESTFIELD("Depr. below Zero %",0);
                                                                END;
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=[ENU=Use FA Ledger Check;
                                                              RUS=Использовать проверку книги ОС] }
    { 45  ;   ;Last Maintenance Date;Date         ;CaptionML=[ENU=Last Maintenance Date;
                                                              RUS=Дата последнего обслуживания];
                                                   Editable=No }
    { 46  ;   ;Depr. below Zero %  ;Decimal       ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                "Fixed Depr. Amount below Zero" := 0;
                                                                IF "Depr. below Zero %" > 0 THEN BEGIN
                                                                  DeprBook.GET("Depreciation Book Code");
                                                                  DeprBook.TESTFIELD("Allow Depr. below Zero",TRUE);
                                                                  TESTFIELD("Use FA Ledger Check",TRUE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Depr. below Zero %;
                                                              RUS=Отрицательная амортизация (%)];
                                                   DecimalPlaces=2:8;
                                                   MinValue=0;
                                                   BlankZero=Yes }
    { 47  ;   ;Projected Disposal Date;Date       ;CaptionML=[ENU=Projected Disposal Date;
                                                              RUS=Прогнозная дата реализации] }
    { 48  ;   ;Projected Proceeds on Disposal;Decimal;
                                                   CaptionML=[ENU=Projected Proceeds on Disposal;
                                                              RUS=Прогнозные поступления от реализации];
                                                   MinValue=0;
                                                   BlankZero=Yes;
                                                   AutoFormatType=1 }
    { 50  ;   ;Depr. Starting Date (Custom 1);Date;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=[ENU=Depr. Starting Date (Custom 1);
                                                              RUS=Дата начала амортизации (польз. метод 1)] }
    { 51  ;   ;Depr. Ending Date (Custom 1);Date  ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=[ENU=Depr. Ending Date (Custom 1);
                                                              RUS=Дата окончания амортизации (польз. метод 1)] }
    { 52  ;   ;Accum. Depr. % (Custom 1);Decimal  ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=[ENU=Accum. Depr. % (Custom 1);
                                                              RUS=Накопл. аморт. (%) - польз. метод 1];
                                                   DecimalPlaces=2:8;
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   BlankZero=Yes }
    { 53  ;   ;Depr. This Year % (Custom 1);Decimal;
                                                   CaptionML=[ENU=Depr. This Year % (Custom 1);
                                                              RUS=Аморт. этого года (%) - польз. метод 1];
                                                   DecimalPlaces=2:8;
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   BlankZero=Yes }
    { 54  ;   ;Property Class (Custom 1);Option   ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=[ENU=Property Class (Custom 1);
                                                              RUS=Класс собственности (польз. метод 1)];
                                                   OptionCaptionML=[ENU=" ,Personal Property,Real Property";
                                                                    RUS=" ,Личная собственность,Недвижимость"];
                                                   OptionString=[ ,Personal Property,Real Property] }
    { 55  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              RUS=Описание];
                                                   Editable=No }
    { 56  ;   ;Main Asset/Component;Option        ;CaptionML=[ENU=Main Asset/Component;
                                                              RUS=Комплект ОС/компонент];
                                                   OptionCaptionML=[ENU=" ,Main Asset,Component";
                                                                    RUS=" ,Комплект ОС,Компонент"];
                                                   OptionString=[ ,Main Asset,Component];
                                                   Editable=No }
    { 57  ;   ;Component of Main Asset;Code20     ;TableRelation="Fixed Asset";
                                                   CaptionML=[ENU=Component of Main Asset;
                                                              RUS=Компонент комплекта ОС];
                                                   Editable=No }
    { 58  ;   ;FA Add.-Currency Factor;Decimal    ;CaptionML=[ENU=FA Add.-Currency Factor;
                                                              RUS=Коэффициент курса валюты ОС (ДОВ)];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0 }
    { 59  ;   ;Use Half-Year Convention;Boolean   ;OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                                TestHalfYearConventionMethod;
                                                              END;

                                                   CaptionML=[ENU=Use Half-Year Convention;
                                                              RUS=Использ. начисл. полугод. нормы износа] }
    { 60  ;   ;Use DB% First Fiscal Year;Boolean  ;OnValidate=BEGIN
                                                                IF "Use DB% First Fiscal Year" THEN
                                                                  IF NOT (("Depreciation Method" = "Depreciation Method"::"DB1/SL") OR
                                                                          ("Depreciation Method" = "Depreciation Method"::"DB2/SL"))
                                                                  THEN
                                                                    DeprMethodError;
                                                              END;

                                                   CaptionML=[ENU=Use DB% First Fiscal Year;
                                                              RUS=Использ. первый фин. год % уменьш. ост.] }
    { 61  ;   ;Temp. Ending Date   ;Date          ;CaptionML=[ENU=Temp. Ending Date;
                                                              RUS=Врем. дата окончания] }
    { 62  ;   ;Temp. Fixed Depr. Amount;Decimal   ;CaptionML=[ENU=Temp. Fixed Depr. Amount;
                                                              RUS=Врем. фиксир. сумма амортизации];
                                                   AutoFormatType=1 }
    { 63  ;   ;Ignore Def. Ending Book Value;Boolean;
                                                   OnValidate=BEGIN
                                                                ModifyDeprFields;
                                                              END;

                                                   CaptionML=[ENU=Ignore Def. Ending Book Value;
                                                              RUS=Игнорир. конечную бал. стоим. по умолч.] }
    { 70  ;   ;Default FA Depreciation Book;Boolean;
                                                   OnValidate=VAR
                                                                DefaultFADeprBook@1000 : Record 5612;
                                                              BEGIN
                                                                DefaultFADeprBook.SETRANGE("FA No.","FA No.");
                                                                DefaultFADeprBook.SETRANGE("Default FA Depreciation Book",TRUE);
                                                                IF NOT DefaultFADeprBook.ISEMPTY THEN
                                                                  FIELDERROR("Default FA Depreciation Book",OnlyOneDefaultDeprBookErr);
                                                              END;

                                                   CaptionML=[ENU=Default FA Depreciation Book;
                                                              RUS=Книга амортизации ОС по умолчанию] }
    { 12400;  ;Depreciated Cost    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Depreciated Cost;
                                                              RUS=Остаточная стоимость];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 12405;  ;Global Dimension 1 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Filter;
                                                              RUS=Фильтр глобального измерения 1];
                                                   CaptionClass='1,3,1' }
    { 12406;  ;Global Dimension 2 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Global Dimension 2 Filter;
                                                              RUS=Фильтр глобального измерения 2];
                                                   CaptionClass='1,3,2' }
    { 12416;  ;FA Employee Filter  ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Employee;
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=FA Employee Filter;
                                                              RUS=Фильтр по сотрудникам ОС] }
    { 12470;  ;FA Location Code Filter;Code10     ;FieldClass=FlowFilter;
                                                   TableRelation="FA Location";
                                                   CaptionML=[ENU=FA Location Code Filter;
                                                              RUS=Фильтр по коду местонахождения ОС] }
    { 12471;  ;Quantity            ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Quantity WHERE (FA No.=FIELD(FA No.),
                                                                                                     Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                     FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                     FA Location Code=FIELD(FA Location Code Filter),
                                                                                                     Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                     Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                     Employee No.=FIELD(FA Employee Filter),
                                                                                                     FA Posting Type=FILTER(Acquisition Cost)));
                                                   CaptionML=[ENU=Quantity;
                                                              RUS=Кол-во] }
    { 12472;  ;Initial Acquisition ;Boolean       ;CaptionML=[ENU=Initial Acquisition;
                                                              RUS=Исходное приобретение];
                                                   Editable=No }
    { 12473;  ;Initial Acquisition Filter;Boolean ;FieldClass=FlowFilter;
                                                   InitValue=Yes;
                                                   CaptionML=[ENU=Initial Acquisition Filter;
                                                              RUS=Фильтр по исходному приобретению];
                                                   Editable=No }
    { 12474;  ;Initial Acquisition Cost;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=FILTER(Acquisition Cost|Transfer),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter),
                                                                                                   Initial Acquisition=CONST(Yes)));
                                                   CaptionML=[ENU=Initial Acquisition Cost;
                                                              RUS=Исходная стоимость приобретения];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 17201;  ;Depreciation Bonus  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=CONST(Depreciation),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter),
                                                                                                   Depr. Bonus=CONST(Yes)));
                                                   CaptionML=[ENU=Depreciation Bonus;
                                                              RUS=Амортизационная премия];
                                                   Editable=No }
    { 17202;  ;Depr. Bonus Base Amount;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry".Amount WHERE (FA No.=FIELD(FA No.),
                                                                                                   Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                   FA Posting Category=CONST(" "),
                                                                                                   FA Posting Type=FILTER(Acquisition Cost|Appreciation),
                                                                                                   FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                   FA Location Code=FIELD(FA Location Code Filter),
                                                                                                   Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                   Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                   Employee No.=FIELD(FA Employee Filter),
                                                                                                   Depr. Bonus=CONST(Yes)));
                                                   CaptionML=[ENU=Depr. Bonus Base Amount;
                                                              RUS=Базовая сумма аморт. премии];
                                                   Editable=No }
    { 17203;  ;Depr. Bonus %       ;Decimal       ;OnValidate=BEGIN
                                                                IF "Depr. Bonus %" <> xRec."Depr. Bonus %" THEN BEGIN
                                                                  CALCFIELDS("Depreciation Bonus");
                                                                  TESTFIELD("Depreciation Bonus",0);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Depr. Bonus %;
                                                              RUS=Аморт. премия (%)];
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 50001;  ;Global Dimension 1 Code;Code20     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Fixed Asset"."Global Dimension 1 Code" WHERE (No.=FIELD(FA No.)));
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              RUS=Глобал. Измерение 1 Код];
                                                   Description=NC MFA22 DP;
                                                   Editable=No;
                                                   CaptionClass='1,1,1' }
    { 50002;  ;Global Dimension 2 Code;Code20     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Fixed Asset"."Global Dimension 2 Code" WHERE (No.=FIELD(FA No.)));
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              RUS=Глобал. Измерение 2 Код];
                                                   Description=NC MFA22 DP;
                                                   Editable=No;
                                                   CaptionClass='1,1,2' }
    { 55000;  ;Acquisition Cost (ACY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("FA Ledger Entry"."Additional-Currency Amount" WHERE (FA No.=FIELD(FA No.),
                                                                                                                         Depreciation Book Code=FIELD(Depreciation Book Code),
                                                                                                                         FA Posting Category=CONST(" "),
                                                                                                                         FA Posting Type=CONST(Acquisition Cost),
                                                                                                                         FA Posting Date=FIELD(FA Posting Date Filter),
                                                                                                                         FA Location Code=FIELD(FA Location Code Filter),
                                                                                                                         Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                         Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                                         Employee No.=FIELD(FA Employee Filter)));
                                                   CaptionML=[ENU=Acquisition Cost (ACY);
                                                              RUS=Стоимость Приобретения (ДОВ)];
                                                   Description=NCPIF001 MP;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 55001;  ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Code;
                                                              RUS=Код Валюты];
                                                   Description=NC MP;
                                                   Editable=No }
    { 55002;  ;Inventory Number    ;Text30        ;CaptionML=[ENU=Inventory Number;
                                                              RUS=Инвентарный номер];
                                                   Description=NC MP }
  }
  KEYS
  {
    {    ;FA No.,Depreciation Book Code           ;Clustered=Yes }
    {    ;Depreciation Book Code,FA No.            }
    {    ;Depreciation Book Code,Component of Main Asset,Main Asset/Component }
    {    ;Main Asset/Component,Depreciation Book Code }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot rename a %1.;RUS=Нельзя переименовать %1.';
      Text001@1001 : TextConst 'ENU=must not be 100;RUS=не должно быть 100';
      Text002@1002 : TextConst 'ENU=%1 is later than %2.;RUS=%1 позже чем %2.';
      Text003@1003 : TextConst 'ENU=must not be %1;RUS=не должно быть %1';
      Text004@1004 : TextConst 'ENU=untitled;RUS=без названия';
      FA@1005 : Record 5600;
      DeprBook@1006 : Record 5611;
      DeprGroup@1210000 : Record 12476;
      TaxRegisterSetup@1210001 : Record 17236;
      FAMoveEntries@1007 : Codeunit 5623;
      FADateCalc@1008 : Codeunit 5617;
      DepreciationCalc@1009 : Codeunit 5616;
      OnlyOneDefaultDeprBookErr@1010 : TextConst 'ENU=Only one fixed asset depreciation book can be marked as the default book;RUS=Только одна книга амортизации основных средств может быть помечена в качестве книги по умолчанию.';

    LOCAL PROCEDURE AdjustLinearMethod@1(VAR Amount1@1000 : Decimal;VAR Amount2@1001 : Decimal);
    BEGIN
      Amount1 := 0;
      Amount2 := 0;
      IF "No. of Depreciation Years" = 0 THEN BEGIN
        "No. of Depreciation Months" := 0;
        "Depreciation Ending Date" := 0D;
      END;
    END;

    LOCAL PROCEDURE ModifyDeprFields@2();
    BEGIN
      IF ("Last Depreciation Date" > 0D) OR
         ("Last Write-Down Date" > 0D) OR
         ("Last Appreciation Date" > 0D) OR
         ("Last Custom 1 Date" > 0D) OR
         ("Last Custom 2 Date" > 0D) OR
         ("Disposal Date" > 0D)
      THEN BEGIN
        DeprBook.GET("Depreciation Book Code");
        DeprBook.TESTFIELD("Allow Changes in Depr. Fields",TRUE);
      END;
    END;

    PROCEDURE CalcDeprPeriod@4();
    VAR
      DeprBook2@1000 : Record 5611;
    BEGIN
      IF ("No. of Depreciation Years" <> 0) OR ("No. of Depreciation Months" <> 0) THEN BEGIN
        IF "Depreciation Starting Date" = 0D THEN
          "Depreciation Ending Date" := 0D
        ELSE BEGIN
          IF ("Depreciation Method" = "Depreciation Method"::"SL-RU") OR
            ("Depreciation Method" = "Depreciation Method"::"DB/SL-RU") THEN
            "Depreciation Starting Date" := CALCDATE('<-1M + CM +1D>',"Depreciation Starting Date");
          "Depreciation Ending Date" := CalcEndingDate;
          AdjustLinearMethod("Straight-Line %","Fixed Depr. Amount");
        END;
      END ELSE BEGIN
        IF "Depreciation Starting Date" = 0D THEN BEGIN
          "Depreciation Ending Date" := 0D;
          "No. of Depreciation Years" := 0;
          "No. of Depreciation Months" := 0;
        END;
        IF ("Depreciation Starting Date" = 0D) OR ("Depreciation Ending Date" = 0D) THEN BEGIN
          "No. of Depreciation Years" := 0;
          "No. of Depreciation Months" := 0;
        END ELSE BEGIN
          IF "Depreciation Starting Date" > "Depreciation Ending Date" THEN
            ERROR(
              Text002,
              FIELDCAPTION("Depreciation Starting Date"),FIELDCAPTION("Depreciation Ending Date"));
          DeprBook2.GET("Depreciation Book Code");
          IF DeprBook2."Fiscal Year 365 Days" THEN BEGIN
            "No. of Depreciation Months" := 0;
            "No. of Depreciation Years" := 0;
          END;
          IF NOT DeprBook2."Fiscal Year 365 Days" THEN BEGIN
            "No. of Depreciation Months" :=
              DepreciationCalc.DeprDays("Depreciation Starting Date","Depreciation Ending Date",FALSE) / 30;
            "No. of Depreciation Months" := ROUND("No. of Depreciation Months",0.00000001);
            "No. of Depreciation Years" := ROUND("No. of Depreciation Months" / 12,0.00000001);
          END;
          "Straight-Line %" := 0;
          "Fixed Depr. Amount" := 0;
        END;
        IF NOT DeprBook2."Fiscal Year 365 Days" THEN BEGIN
          "No. of Depreciation Months" :=
            DepreciationCalc.DeprDays("Depreciation Starting Date","Depreciation Ending Date",FALSE) / 30;
          "No. of Depreciation Months" := ROUND("No. of Depreciation Months",0.00000001);
          "No. of Depreciation Years" := ROUND("No. of Depreciation Months" / 12,0.00000001);
        END;
        "Straight-Line %" := 0;
        "Fixed Depr. Amount" := 0;
      END;
    END;

    LOCAL PROCEDURE CalcEndingDate@3() : Date;
    VAR
      EndingDate@1000 : Date;
    BEGIN
      IF "No. of Depreciation Years" = 0 THEN
        EXIT(0D);
      IF "Depreciation Starting Date" = 0D THEN
        EXIT(0D);
      EndingDate := FADateCalc.CalculateDate(
          "Depreciation Starting Date",ROUND("No. of Depreciation Years" * 360,1),FALSE);
      EndingDate := DepreciationCalc.Yesterday(EndingDate,FALSE);
      IF EndingDate < "Depreciation Starting Date" THEN
        EndingDate := "Depreciation Starting Date";
      EXIT(EndingDate);
    END;

    PROCEDURE GetExchangeRate@5() : Decimal;
    VAR
      DeprBook@1000 : Record 5611;
    BEGIN
      DeprBook.GET("Depreciation Book Code");
      IF NOT DeprBook."Use FA Exch. Rate in Duplic." THEN
        EXIT(0);
      IF "FA Exchange Rate" > 0 THEN
        EXIT("FA Exchange Rate");
      EXIT(DeprBook."Default Exchange Rate");
    END;

    LOCAL PROCEDURE LinearMethod@9() : Boolean;
    BEGIN
      EXIT(
        "Depreciation Method" IN
        ["Depreciation Method"::"Straight-Line",
         "Depreciation Method"::"DB1/SL",
         "Depreciation Method"::"DB2/SL",
         "Depreciation Method"::"SL-RU",
         "Depreciation Method"::"DB/SL-RU",
         "Depreciation Method"::"DB/SL-RU Tax Group"]);
    END;

    LOCAL PROCEDURE DecliningMethod@10() : Boolean;
    BEGIN
      EXIT(
        "Depreciation Method" IN
        ["Depreciation Method"::"Declining-Balance 1",
         "Depreciation Method"::"Declining-Balance 2",
         "Depreciation Method"::"DB1/SL",
         "Depreciation Method"::"DB2/SL",
         "Depreciation Method"::"DB/SL-RU",
         "Depreciation Method"::"DB/SL-RU Tax Group"]);
    END;

    LOCAL PROCEDURE UserDefinedMethod@11() : Boolean;
    BEGIN
      EXIT("Depreciation Method" = "Depreciation Method"::"User-Defined");
    END;

    LOCAL PROCEDURE TestHalfYearConventionMethod@8();
    BEGIN
      IF "Depreciation Method" IN
         ["Depreciation Method"::"Declining-Balance 2",
          "Depreciation Method"::"DB2/SL",
          "Depreciation Method"::"User-Defined"]
      THEN
        TESTFIELD("Use Half-Year Convention",FALSE);
    END;

    LOCAL PROCEDURE DeprMethodError@7();
    BEGIN
      FIELDERROR("Depreciation Method",STRSUBSTNO(Text003,"Depreciation Method"));
    END;

    PROCEDURE Caption@6() : Text[120];
    VAR
      FA@1000 : Record 5600;
      DeprBook@1001 : Record 5611;
    BEGIN
      IF "FA No." = '' THEN
        EXIT(Text004);
      FA.GET("FA No.");
      DeprBook.GET("Depreciation Book Code");
      EXIT(
        STRSUBSTNO(
          '%1 %2 %3 %4',"FA No.",FA.Description,"Depreciation Book Code",DeprBook.Description));
    END;

    PROCEDURE ShowBookValueAfterDisposal@12();
    VAR
      TempFALedgEntry@1000 : TEMPORARY Record 5601;
      FALedgEntry@1001 : Record 5601;
    BEGIN
      IF "Disposal Date" > 0D THEN BEGIN
        CLEAR(TempFALedgEntry);
        TempFALedgEntry.DELETEALL;
        TempFALedgEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","FA Posting Date");
        DepreciationCalc.SetFAFilter(FALedgEntry,"FA No.","Depreciation Book Code",FALSE);
        WITH FALedgEntry DO BEGIN
          IF FIND('-') THEN
            REPEAT
              IF (("FA Posting Category" = "FA Posting Category"::Disposal) AND
                  ("FA Posting Type" <> "FA Posting Type"::"Book Value on Disposal") AND
                  ("FA Posting Type" <> "FA Posting Type"::"Salvage Value")) OR
                 "Part of Book Value"
              THEN BEGIN
                TempFALedgEntry := FALedgEntry;
                TempFALedgEntry.INSERT;
              END;
            UNTIL NEXT = 0;
          TempFALedgEntry.SETRANGE("FA No.",TempFALedgEntry."FA No.");
          TempFALedgEntry.SETRANGE("Depreciation Book Code",TempFALedgEntry."Depreciation Book Code");
          PAGE.RUN(0,TempFALedgEntry);
        END;
      END ELSE BEGIN
        FALedgEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","Part of Book Value","FA Posting Date");
        FALedgEntry.SETRANGE("FA No.","FA No.");
        FALedgEntry.SETRANGE("Depreciation Book Code","Depreciation Book Code");
        FALedgEntry.SETRANGE("Part of Book Value",TRUE);
        PAGE.RUN(0,FALedgEntry);
      END;
    END;

    PROCEDURE CalcBookValue@1001();
    BEGIN
      IF "Disposal Date" > 0D THEN
        "Book Value" := 0
      ELSE
        CALCFIELDS("Book Value");
    END;

    PROCEDURE SetBookValueFiltersOnFALedgerEntry@13(VAR FALedgEntry@1000 : Record 5601);
    BEGIN
      FALedgEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","Part of Book Value","FA Posting Date");
      FALedgEntry.SETRANGE("FA No.","FA No.");
      FALedgEntry.SETRANGE("Depreciation Book Code","Depreciation Book Code");
      FALedgEntry.SETRANGE("Part of Book Value",TRUE);
    END;

    PROCEDURE GetStatus@1210000(FANo@1210000 : Code[20];DeprBookCode@1210001 : Code[10]) : Integer;
    VAR
      Status@1210002 : 'On Hand,,,Saled,Disposed';
    BEGIN
      GET(FANo,DeprBookCode);
      IF "Disposal Date" = 0D THEN
        Status := Status::"On Hand"
      ELSE BEGIN
        CALCFIELDS("Proceeds on Disposal");
        IF "Proceeds on Disposal" = 0 THEN
          Status := Status::Disposed
        ELSE
          Status := Status::Saled;
      END;
      EXIT(Status);
    END;

    PROCEDURE GetLocationAtDate@1470000(VAR LocationCode@1470000 : Code[10];VAR EmployeeNo@1470001 : Code[20];AtDate@1470002 : Date);
    VAR
      FALedgEntry@1470003 : Record 5601;
      Found@1470004 : Boolean;
    BEGIN
      LocationCode := '';
      EmployeeNo := '';

      IF AtDate = 0D THEN
        EXIT;

      FALedgEntry.RESET;
      FALedgEntry.SETCURRENTKEY("FA No.","Depreciation Book Code","FA Posting Category","FA Posting Type","Posting Date");
      FALedgEntry.SETRANGE("FA No.","FA No.");
      FALedgEntry.SETRANGE("Depreciation Book Code","Depreciation Book Code");
      FALedgEntry.SETRANGE("FA Posting Category",FALedgEntry."FA Posting Category"::" ");
      FALedgEntry.SETRANGE("FA Posting Type",FALedgEntry."FA Posting Type"::"Acquisition Cost");
      FALedgEntry.SETFILTER("FA Posting Date",'..%1',AtDate);
      IF FALedgEntry.FIND('+') THEN
        REPEAT
          IF FALedgEntry."Debit Amount" > 0 THEN BEGIN
            LocationCode := FALedgEntry."FA Location Code";
            EmployeeNo := FALedgEntry."Employee No.";
            Found := TRUE;
          END;
        UNTIL (FALedgEntry.NEXT(-1) = 0) OR Found;
    END;

    PROCEDURE LineIsReadyForAcquisition@14(FANo@1000 : Code[20]) : Boolean;
    VAR
      FADepreciationBook@1001 : Record 5612;
      FASetup@1002 : Record 5603;
    BEGIN
      FASetup.GET;
      EXIT(FADepreciationBook.GET(FANo,FASetup."Default Depr. Book") AND FADepreciationBook.RecIsReadyForAcquisition);
    END;

    PROCEDURE RecIsReadyForAcquisition@17() : Boolean;
    VAR
      FASetup@1000 : Record 5603;
    BEGIN
      FASetup.GET;
      EXIT(
        ("Depreciation Book Code" = FASetup."Default Depr. Book") AND
        ("FA Posting Group" <> '') AND
        ("Depreciation Starting Date" > 0D) AND
        ("No. of Depreciation Years" > 0) );
    END;

    PROCEDURE UpdateBookValue@15();
    BEGIN
      IF "Disposal Date" > 0D THEN
        "Book Value" := 0;
    END;

    PROCEDURE SynchroniseIt@1000000000(Mode@1000000000 : 'Insert,Modify,Delete,Rename');
    VAR
      FA@1000000001 : Record 5600;
    BEGIN
      // TD BMN 23.11.2012 NCS-712

      IF "Depreciation Book Code" IN ['FA','PE','IA'] THEN BEGIN
        FA.GET("FA No.");
        FA."No. of Depreciation Months" := "No. of Depreciation Months";
        FA."Depreciation Starting Date" := "Depreciation Starting Date";
        FA.MODIFY(TRUE);
      END;
    END;

    BEGIN
    {
      NCPIF001 MP Добавлено поле "Сумма Приобретения (ДОВ)"
      NC MP 28.02.07 Новое поле Currency Code
                     Код на Depreciation Book Code - OnValidate()
      NC MP 06.03.07 Новое Поле "Инвентарный номер"
                     Код на OnInsert
      CFC PIF001 KA добавлены два новых поля "Modernization" и "Retirement"
      TD BMN 27.08.2012 JIRA::APCOC-54 "Настройка интеграции DataStage между NAV-OFFSH и CONS-MIS"
      TD BMN 23.11.2012 NCS-712 "Интеграция данных из договоров OFF - IFRS"
      NC NCS-1284 DP Синхронизация при вставке книг амортизации
    }
    END.
  }
}

