OBJECT Page 99000850 Recurring Consumption Journal
{
  OBJECT-PROPERTIES
  {
    Date=22.05.17;
    Time=11:38:53;
    Modified=Yes;
    Version List=NAVW110.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Recurring Consumption Journal;
               RUS=Типовой журнал потребления];
    SaveValues=Yes;
    SourceTable=Table83;
    DelayedInsert=Yes;
    DataCaptionFields=Journal Batch Name;
    PageType=Worksheet;
    AutoSplitKey=Yes;
    OnOpenPage=VAR
                 JnlSelected@1000 : Boolean;
               BEGIN
                 IF IsOpenedFromBatch THEN BEGIN
                   CurrentJnlBatchName := "Journal Batch Name";
                   ItemJnlMgt.OpenJnl(CurrentJnlBatchName,Rec);
                   EXIT;
                 END;
                 ItemJnlMgt.TemplateSelection(PAGE::"Recurring Consumption Journal",4,TRUE,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 ItemJnlMgt.OpenJnl(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnNewRecord=BEGIN
                  SetUpNewLine(xRec);
                  VALIDATE("Entry Type","Entry Type"::Consumption);
                  CLEAR(ShortcutDimCode);
                END;

    OnDeleteRecord=VAR
                     ReserveItemJnlLine@1000 : Codeunit 99000835;
                   BEGIN
                     COMMIT;
                     IF NOT ReserveItemJnlLine.DeleteLineConfirm(Rec) THEN
                       EXIT(FALSE);
                     ReserveItemJnlLine.DeleteLine(Rec);
                   END;

    OnAfterGetCurrRecord=BEGIN
                           ItemJnlMgt.GetConsump(Rec,ProdOrderDescription);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 35      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Line;
                                 RUS=&Строка];
                      Image=Line }
      { 42      ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 RUS=Измерения];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 RUS=Просмотр или изменение измерений, например области, проекта или отдела, которые можно назначать документам покупки и продажи для распределения себестоимости и анализа истории транзакций.];
                      ApplicationArea=#Jobs;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDimensions;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 43      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+I;
                      CaptionML=[ENU=Item &Tracking Lines;
                                 RUS=Строки трассир&овки товаров];
                      Image=ItemTrackingLines;
                      OnAction=BEGIN
                                 OpenItemTrackingLines(FALSE);
                               END;
                                }
      { 44      ;2   ;Action    ;
                      CaptionML=[ENU=Bin Contents;
                                 RUS=Содержимое ячейки];
                      RunObject=Page 7305;
                      RunPageView=SORTING(Location Code,Bin Code,Item No.,Variant Code);
                      RunPageLink=Location Code=FIELD(Location Code),
                                  Item No.=FIELD(Item No.),
                                  Variant Code=FIELD(Variant Code);
                      Image=BinContent }
      { 13      ;1   ;ActionGroup;
                      CaptionML=[ENU=Pro&d. Order;
                                 RUS=Про&изв. заказ];
                      Image=Order }
      { 24      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 RUS=Карточка];
                      ToolTipML=[ENU=View or change detailed information about the record that is being processed on the journal line.;
                                 RUS=Просмотр или изменение подробных сведений о записи, обрабатываемой в строке журнала.];
                      ApplicationArea=#Jobs;
                      RunObject=Page 99000831;
                      RunPageLink=No.=FIELD(Order No.);
                      Image=EditLines }
      { 25      ;2   ;ActionGroup;
                      CaptionML=[ENU=Ledger E&ntries;
                                 RUS=&Книга операций];
                      Image=Entries }
      { 26      ;3   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Item Ledger E&ntries;
                                 RUS=Книга операций по т&оварам];
                      ToolTipML=[ENU=View the item ledger entries of the item on the journal line.;
                                 RUS=Просмотр операций книги товаров для товара в строке журнала.];
                      ApplicationArea=#Jobs;
                      RunObject=Page 38;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(Order No.);
                      Image=ItemLedger }
      { 27      ;3   ;Action    ;
                      CaptionML=[ENU=Capacity Ledger Entries;
                                 RUS=Книга операций по произв. мощностям];
                      ToolTipML=[ENU=View the capacity ledger entries of the involved production order. Capacity is recorded either as time (run time, stop time, or setup time) or as quantity (scrap quantity or output quantity).;
                                 RUS=Просмотр операций книги производственных мощностей для соответствующего производственного заказа. Производственная мощность записывается в терминах времени ("Длительность операции", "Время останова", "Время настройки") или количества ("Кол-во брака", "Выходное количество").];
                      ApplicationArea=#Jobs;
                      RunObject=Page 5832;
                      RunPageView=SORTING(Order Type,Order No.);
                      RunPageLink=Order Type=CONST(Production),
                                  Order No.=FIELD(Order No.);
                      Image=CapacityLedger }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 36      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 RUS=Ф&ункции];
                      Image=Action }
      { 2       ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Calc. Co&nsumption;
                                 RUS=Расчет &потребления];
                      ToolTipML=[ENU=Use a batch job to help you fill the consumption journal with actual or expected consumption figures.;
                                 RUS=Использование пакетного задания для заполнения журнала потребления фактическими или ожидаемыми значениями потребления.];
                      ApplicationArea=#Jobs;
                      Image=CalculateConsumption;
                      OnAction=VAR
                                 CalcConsumption@1001 : Report 5405;
                               BEGIN
                                 CalcConsumption.SetTemplateAndBatchName("Journal Template Name","Journal Batch Name");

                                 CalcConsumption.RUNMODAL;
                               END;
                                }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[ENU=P&osting;
                                 RUS=У&чет];
                      Image=Post }
      { 41      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Test Report;
                                 RUS=Тестовый отчет];
                      ToolTipML=[ENU=View a test report so that you can find and correct any errors before you perform the actual posting of the journal or document.;
                                 RUS=Просмотр тестового отчета, чтобы можно было найти и исправить все ошибки перед учетом журнала или документа.];
                      ApplicationArea=#Jobs;
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintItemJnlLine(Rec);
                               END;
                                }
      { 56      ;2   ;Action    ;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 RUS=У&чет];
                      ToolTipML=[ENU=Finalize the document or journal by posting the amounts and quantities to the related accounts in your company books.;
                                 RUS=Завершение подготовки документа или журнала путем учета сумм и количеств на соответствующих счетах в книгах организации.];
                      ApplicationArea=#Jobs;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 PostingItemJnlFromProduction(FALSE);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 57      ;2   ;Action    ;
                      ShortCutKey=Shift+F9;
                      CaptionML=[ENU=Post and &Print;
                                 RUS=Учет и &печать];
                      ToolTipML=[ENU=Finalize and prepare to print the document or journal. The values and quantities are posted to the related accounts. A report request window where you can specify what to include on the print-out.;
                                 RUS=Завершение подготовки документа или журнала и его подготовка к печати. Значения и количества учитываются на соответствующих счетах. В окне запроса отчета можно указать, какая информация должна выводиться на печать.];
                      ApplicationArea=#Jobs;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 PostingItemJnlFromProduction(TRUE);
                                 CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 31      ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=&Print;
                                 RUS=&Печать];
                      ToolTipML=[ENU=Prepare to print the document. A report request window for the document opens where you can specify what to include on the print-out.;
                                 RUS=Подготовка документа к печати. Открывается окно запроса отчета для документа, где вы можете указать, какая информация должна выводиться на печать.];
                      ApplicationArea=#Jobs;
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ItemJnlLine@1001 : Record 83;
                               BEGIN
                                 ItemJnlLine.COPY(Rec);
                                 ItemJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                 ItemJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                 REPORT.RUNMODAL(REPORT::"Inventory Movement",TRUE,TRUE,ItemJnlLine);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 78  ;1   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Batch Name;
                           RUS=Код раздела];
                ToolTipML=[ENU=Specifies the name of the journal batch of the recurring consumption journal.;
                           RUS=Определяет название раздела типового журнала потребления.];
                ApplicationArea=#Jobs;
                SourceExpr=CurrentJnlBatchName;
                OnValidate=BEGIN
                             ItemJnlMgt.CheckName(CurrentJnlBatchName,Rec);
                             CurrentJnlBatchNameOnAfterVali;
                           END;

                OnLookup=BEGIN
                           CurrPage.SAVERECORD;
                           ItemJnlMgt.LookupName(CurrentJnlBatchName,Rec);
                           CurrPage.UPDATE(FALSE);
                           ItemJnlMgt.CheckName(CurrentJnlBatchName,Rec);
                         END;
                          }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a recurring method, if you have indicated that the journal is recurring.;
                           RUS=Определяет метод повторения, если указано, что журнал является типовым.];
                ApplicationArea=#Jobs;
                SourceExpr="Recurring Method" }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a recurring frequency if it is indicated that the journal is recurring.;
                           RUS=Определяет частоту повторения, если указано, что журнал является типовым.];
                ApplicationArea=#Jobs;
                SourceExpr="Recurring Frequency" }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the posting date for the entry.;
                           RUS=Определяет дату учета операции.];
                ApplicationArea=#Jobs;
                SourceExpr="Posting Date" }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the order that created the entry.;
                           RUS=Определяет номер заказа, на основании которого создана операция.];
                ApplicationArea=#Jobs;
                SourceExpr="Order No.";
                OnValidate=BEGIN
                             ItemJnlMgt.GetConsump(Rec,ProdOrderDescription);
                           END;
                            }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the line number of the order that created the entry.;
                           RUS=Определяет номер строки заказа, на основании которого создана операция.];
                ApplicationArea=#Jobs;
                SourceExpr="Order Line No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the production order component line number.;
                           RUS=Определяет номер строки компонента производственного заказа.];
                ApplicationArea=#Jobs;
                SourceExpr="Prod. Order Comp. Line No.";
                Visible=FALSE }

    { 134 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date on the document that provides the basis for the entry on the journal line.;
                           RUS=Определяет дату документа, на которой базируется операция в строке журнала.];
                ApplicationArea=#Jobs;
                SourceExpr="Document Date";
                Visible=FALSE }

    { 136 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a document number referring to the customer or vendor numbering system with whom you are trading items on this journal line.;
                           RUS=Определяет номер документа, относящийся к системе нумерации клиента или поставщика, с которым осуществляется торговля товарами в этой строке журнала.];
                ApplicationArea=#Jobs;
                SourceExpr="External Document No.";
                Visible=FALSE }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a document number for the journal line.;
                           RUS=Определяет номер документа для строки журнала.];
                ApplicationArea=#Jobs;
                SourceExpr="Document No." }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the item on the journal line.;
                           RUS=Определяет номер товара в строке журнала.];
                ApplicationArea=#Jobs;
                SourceExpr="Item No.";
                OnValidate=BEGIN
                             ShowShortcutDimCode(ShortcutDimCode);
                           END;
                            }

    { 108 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a variant code for the item.;
                           RUS=Определяет код варианта товара.];
                ApplicationArea=#Jobs;
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 84  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a description of the item on the journal line.;
                           RUS=Определяет описание товара в строке журнала.];
                ApplicationArea=#Jobs;
                SourceExpr=Description }

    { 118 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 1.;
                           RUS=Определяет код ярлыка измерения 1.];
                ApplicationArea=#Jobs;
                SourceExpr="Shortcut Dimension 1 Code";
                Visible=FALSE }

    { 120 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for Shortcut Dimension 2.;
                           RUS=Определяет код ярлыка измерения 2.];
                ApplicationArea=#Jobs;
                SourceExpr="Shortcut Dimension 2 Code";
                Visible=FALSE }

    { 300 ;2   ;Field     ;
                ApplicationArea=#Jobs;
                SourceExpr=ShortcutDimCode[3];
                CaptionClass='1,2,3';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(3),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                           END;
                            }

    { 302 ;2   ;Field     ;
                ApplicationArea=#Jobs;
                SourceExpr=ShortcutDimCode[4];
                CaptionClass='1,2,4';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(4),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                           END;
                            }

    { 304 ;2   ;Field     ;
                ApplicationArea=#Jobs;
                SourceExpr=ShortcutDimCode[5];
                CaptionClass='1,2,5';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(5),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                           END;
                            }

    { 306 ;2   ;Field     ;
                ApplicationArea=#Jobs;
                SourceExpr=ShortcutDimCode[6];
                CaptionClass='1,2,6';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(6),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                           END;
                            }

    { 308 ;2   ;Field     ;
                ApplicationArea=#Jobs;
                SourceExpr=ShortcutDimCode[7];
                CaptionClass='1,2,7';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(7),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                           END;
                            }

    { 310 ;2   ;Field     ;
                ApplicationArea=#Jobs;
                SourceExpr=ShortcutDimCode[8];
                CaptionClass='1,2,8';
                TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(8),
                                                            Dimension Value Type=CONST(Standard),
                                                            Blocked=CONST(No));
                Visible=FALSE;
                OnValidate=BEGIN
                             ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                           END;
                            }

    { 100 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the inventory location where the item on the journal line will be registered.;
                           RUS=Определяет код для местонахождения на складе, где будет регистрироваться товар в строке журнала.];
                SourceExpr="Location Code";
                Visible=FALSE }

    { 33  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a bin code for the item.;
                           RUS=Определяет код ячейки товара.];
                SourceExpr="Bin Code";
                Visible=FALSE }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the general business posting group that will be used when you post the entry on the journal line.;
                           RUS=Определяет общую бизнес-группу, которая будет использоваться при учете операции в строке журнала.];
                ApplicationArea=#Jobs;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the general product posting group that will be used when you post the entry on the journal line.;
                           RUS=Определяет общую товарную группу, которая будет использоваться при учете операции в строке журнала.];
                ApplicationArea=#Jobs;
                SourceExpr="Gen. Prod. Posting Group";
                Visible=FALSE }

    { 86  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of units of the item to be included on the journal line.;
                           RUS=Определяет количество единиц товара, которое нужно включить в строку журнала.];
                ApplicationArea=#Jobs;
                SourceExpr=Quantity }

    { 110 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code if you have filled in the Sales Unit of Measure field on the item card.;
                           RUS=Определяет код, если в карточке товара заполнено поле "Единица измерения продаж".];
                ApplicationArea=#Jobs;
                SourceExpr="Unit of Measure Code" }

    { 88  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit cost of the item on the line.;
                           RUS=Определяет себестоимость единицы товара в строке.];
                ApplicationArea=#Jobs;
                SourceExpr="Unit Cost";
                Visible=FALSE }

    { 90  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the price of one unit of the item on the journal line.;
                           RUS=Определяет цену единицы товара в строке журнала.];
                ApplicationArea=#Jobs;
                SourceExpr="Unit Amount" }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the quantity in the item journal line should be applied to an already-posted document.;
                           RUS=Определяет, что количество в строке журнала товаров должно применяться к уже учтенному документу.];
                ApplicationArea=#Jobs;
                SourceExpr="Applies-to Entry" }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the last date on which the recurring journal will be posted, if you have indicated that the journal is recurring.;
                           RUS=Определяет дату последнего учета типового журнала, если указано, что журнал является типовым.];
                ApplicationArea=#Jobs;
                SourceExpr="Expiration Date" }

    { 73  ;1   ;Group      }

    { 1902114901;2;Group  ;
                GroupType=FixedLayout }

    { 1903098501;3;Group  ;
                CaptionML=[ENU=Prod. Order Name;
                           RUS=Название произв. заказа] }

    { 74  ;4   ;Field     ;
                ApplicationArea=#Jobs;
                SourceExpr=ProdOrderDescription;
                Editable=FALSE;
                ShowCaption=No }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ItemJnlMgt@1000 : Codeunit 240;
      ReportPrint@1001 : Codeunit 228;
      ProdOrderDescription@1002 : Text[50];
      CurrentJnlBatchName@1003 : Code[10];
      ShortcutDimCode@1004 : ARRAY [20] OF Code[20];

    LOCAL PROCEDURE CurrentJnlBatchNameOnAfterVali@19002411();
    BEGIN
      CurrPage.SAVERECORD;
      ItemJnlMgt.SetName(CurrentJnlBatchName,Rec);
      CurrPage.UPDATE(FALSE);
    END;

    BEGIN
    END.
  }
}

