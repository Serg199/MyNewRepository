OBJECT Page 1345 Sales Price and Line Discounts
{
  OBJECT-PROPERTIES
  {
    Date=25.10.16;
    Time=12:00:00;
    Version List=NAVW110.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Sales Prices;
               RUS=Цены продажи];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table1304;
    PageType=List;
    SourceTableTemporary=Yes;
    OnNewRecord=BEGIN
                  IF ("Loaded Customer No." = GetLoadedCustNo) AND ("Loaded Item No." = GetLoadedItemNo) THEN
                    EXIT;

                  "Loaded Item No." := GetLoadedItemNo;
                  "Loaded Customer No." := GetLoadedCustNo;
                  "Loaded Price Group" := GetLoadedPriceGroup;
                  "Loaded Disc. Group" := GetLoadedDiscGroup;
                END;

    ActionList=ACTIONS
    {
      { 20      ;0   ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 14      ;1   ;ActionGroup;
                      CaptionML=[ENU=Filtering;
                                 RUS=Фильтрация] }
      { 17      ;1   ;Action    ;
                      CaptionML=[ENU=Show Current Only;
                                 RUS=Показать только текущие];
                      ToolTipML=[ENU=Show only valid price and discount agreements that have ending dates later than today's date.;
                                 RUS=Отображение только действительных соглашений по цене и предоставлению скидок, дата окончания которых приходится позже сегодняшнего дня.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ActivateDiscounts;
                      OnAction=BEGIN
                                 FilterToActualRecords
                               END;
                                }
      { 10      ;1   ;Action    ;
                      CaptionML=[ENU=Show All;
                                 RUS=Показать все];
                      ToolTipML=[ENU=Show all price and discount agreements, including those with ending dates earlier than today's date.;
                                 RUS=Отображение всех соглашений по цене и предоставлению скидок, включая те, у которых дата окончания наступила до сегодняшнего дня.];
                      ApplicationArea=#Basic,#Suite;
                      Image=DeactivateDiscounts;
                      OnAction=BEGIN
                                 RESET;
                               END;
                                }
      { 15      ;1   ;Action    ;
                      CaptionML=[ENU=Refresh Data;
                                 RUS=Обновить данные];
                      ToolTipML=[ENU=Update sales prices or sales line discounts with values that other users may have added for the customer since you opened the window.;
                                 RUS=Обновление цен продажи и скидок по строкам продажи значениями, которые другие пользователи могли добавить за то время, пока у вас было открыто окно.];
                      ApplicationArea=#Basic,#Suite;
                      Image=RefreshLines;
                      OnAction=VAR
                                 Customer@1001 : Record 18;
                                 Item@1000 : Record 27;
                               BEGIN
                                 IF GetLoadedItemNo <> '' THEN
                                   IF Item.GET(GetLoadedItemNo) THEN BEGIN
                                     LoadDataForItem(Item);
                                     EXIT;
                                   END;
                                 IF Customer.GET(GetLoadedCustNo) THEN
                                   LoadDataForCustomer(Customer)
                               END;
                                }
      { 25      ;1   ;Action    ;
                      CaptionML=[ENU=Set Special Prices;
                                 RUS=Задать специальные цены];
                      ToolTipML=[ENU=Set up different prices for the item. An item price is automatically granted on invoice lines when the specified criteria are met, such as customer, quantity, or ending date.;
                                 RUS=Настройка различных цен для товара. Цена товара автоматически задается для строк счета при выполнении определенных условий, например по клиенту, количеству или дате окончания.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 7002;
                      RunPageView=SORTING(Item No.);
                      RunPageLink=Item No.=FIELD(Loaded Item No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Price;
                      PromotedCategory=Process }
      { 19      ;1   ;Action    ;
                      CaptionML=[ENU=Set Special Discounts;
                                 RUS=Задать специальные скидки];
                      ToolTipML=[ENU=Set up different discounts for the item. An item discount is automatically granted on invoice lines when the specified criteria are met, such as customer, quantity, or ending date.;
                                 RUS=Настройка различных скидок для товара. Скидка для товара автоматически задается для строк счета при выполнении определенных условий, например по клиенту, количеству или дате окончания.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 7004;
                      RunPageView=SORTING(Type,Code);
                      RunPageLink=Type=CONST(Item),
                                  Code=FIELD(Loaded Item No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=LineDiscount;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the line is for a sales price or a sales line discount.;
                           RUS=Определяет, является ли строка строкой цены продажи или скидкой строки продажи.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Line Type" }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the sales type of the price or discount. The sales type defines whether the sales price or discount is for an individual customer, a customer discount group, or for all customers.;
                           RUS=Определяет тип продажи для цены или скидки. Тип продажи определяет, относится ли цена продажи или скидка к определенному клиенту, к группе скидок клиентов или ко всем клиентам.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Sales Type" }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the sales code of the price or discount. The sales code depends on the value in the Sales Type field. The code can represent an individual customer, a customer discount group, or for all customers.;
                           RUS=Определяет код продажи для цены или скидки. Код продажи зависит от значения поля "Тип продажи". Код может представлять определенного клиента, группу скидок клиентов или всех клиентов.];
                ApplicationArea=#All;
                SourceExpr="Sales Code";
                Visible=SalesCodeIsVisible;
                Enabled=SalesCodeIsVisible }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the discount is valid for an item or for an item discount group.;
                           RUS=Определяет, действительна скидка для товара или для группы скидок на товары.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Type }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code for the sales line price or discount.;
                           RUS=Определяет код цены или скидки строки продажи.];
                ApplicationArea=#All;
                SourceExpr=Code;
                Visible=CodeIsVisible;
                Enabled=CodeIsVisible }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit of measure that must be used on the sales document line to warrant the sales price or discount.;
                           RUS=Определяет единицу измерения, которую следует использовать в строке документа продажи, чтобы гарантировать цену продажи или скидку.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit of Measure Code" }

    { 21  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the quantity that must be entered on the sales document to warrant the sales price or discount.;
                           RUS=Определяет количество, которое следует ввести в документ продажи, чтобы гарантировать цену продажи или скидку.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Minimum Quantity" }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the discount percent that is granted.;
                           RUS=Определяет процент предоставляемой скидки.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Line Discount %";
                Enabled="Line Type" = 1 }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the unit price that is granted on sales documents if the criteria, such as sales code, currency code, and date, are met.;
                           RUS=Определяет цену единицы, которая предоставляется по документам продажи, если соблюдены такие условия, как код продажи, код валюты и дата.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Unit Price";
                Enabled="Line Type" = 2 }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date from which the sales line discount is valid.;
                           RUS=Определяет дату, с которой действительна скидка по строке продажи.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Starting Date" }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the date to which the sales line discount is valid.;
                           RUS=Определяет дату, по которую действительна скидка по строке продажи.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Ending Date" }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency that must be used on the sales document line to warrant the sales price or discount.;
                           RUS=Определяет валюту, которую следует использовать в строке документа продажи, чтобы гарантировать цену продажи или скидку.];
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the price that is granted includes VAT.;
                           RUS=Определяет, включает ли предоставленная цена НДС.];
                SourceExpr="Price Includes VAT";
                Visible=FALSE }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if an invoice discount will be calculated when the sales price is offered.;
                           RUS=Определяет, будет ли при предложении цены продажи рассчитана скидка по счету.];
                SourceExpr="Allow Invoice Disc.";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the VAT business posting group for customers who you want to apply the sales price to. This price includes VAT.;
                           RUS=Определяет бизнес-группу НДС для клиентов, для которых требуется применить цену продажи. Эта цена включает НДС.];
                SourceExpr="VAT Bus. Posting Gr. (Price)";
                Visible=FALSE }

    { 5   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the variant that must be used on the sales document line to warrant the sales price or discount.;
                           RUS=Определяет вариант, который следует использовать в строке документа продажи, чтобы гарантировать цену продажи или скидку.];
                SourceExpr="Variant Code";
                Visible=FALSE }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if line discounts are allowed.;
                           RUS=Определяет, разрешаются ли скидки по строке.];
                SourceExpr="Allow Line Disc.";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      loadedItemNo@1001 : Code[20];
      loadedCustNo@1003 : Code[20];
      loadedPriceGroup@1002 : Code[20];
      loadedDiscGroup@1000 : Code[20];
      CodeIsVisible@1004 : Boolean;
      SalesCodeIsVisible@1005 : Boolean;

    PROCEDURE InitPage@4(ForItem@1001 : Boolean);
    BEGIN
      IF ForItem THEN BEGIN
        CodeIsVisible := FALSE;
        SalesCodeIsVisible := TRUE;
      END ELSE BEGIN
        CodeIsVisible := TRUE;
        SalesCodeIsVisible := FALSE;
      END;
    END;

    PROCEDURE LoadItem@1(Item@1000 : Record 27);
    BEGIN
      CLEAR(Rec);
      loadedItemNo := Item."No.";
      loadedDiscGroup := Item."Item Disc. Group";
      loadedPriceGroup := '';

      LoadDataForItem(Item);
    END;

    PROCEDURE LoadCustomer@3(Customer@1000 : Record 18);
    BEGIN
      CLEAR(Rec);
      loadedCustNo := Customer."No.";
      loadedPriceGroup := Customer."Customer Price Group";
      loadedDiscGroup := Customer."Customer Disc. Group";

      LoadDataForCustomer(Customer);
    END;

    PROCEDURE GetLoadedItemNo@2() : Code[20];
    BEGIN
      EXIT(loadedItemNo)
    END;

    PROCEDURE GetLoadedCustNo@9() : Code[20];
    BEGIN
      EXIT(loadedCustNo)
    END;

    LOCAL PROCEDURE GetLoadedDiscGroup@8() : Code[20];
    BEGIN
      EXIT(loadedDiscGroup)
    END;

    LOCAL PROCEDURE GetLoadedPriceGroup@5() : Code[20];
    BEGIN
      EXIT(loadedPriceGroup)
    END;

    PROCEDURE RunUpdatePriceIncludesVatAndPrices@6(IncludesVat@1000 : Boolean);
    VAR
      Item@1001 : Record 27;
    BEGIN
      Item.GET(loadedItemNo);
      UpdatePriceIncludesVatAndPrices(Item,IncludesVat);
    END;

    BEGIN
    END.
  }
}

