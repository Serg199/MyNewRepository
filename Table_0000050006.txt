OBJECT Table 50006 FA Consolidation Register
{
  OBJECT-PROPERTIES
  {
    Date=11.07.17;
    Time=14:52:29;
    Modified=Yes;
    Version List=NOS-26;
  }
  PROPERTIES
  {
    OnInsert=VAR
               ConsSetup@1101495000 : Record 50000;
               ConsSource@1101495001 : Record 50001;
             BEGIN
               //NOS-26 > RRV
               "Consolidation Date"  := TODAY;
               "Consolidation Time"  := TIME;
               "User ID"             := USERID;

               ConsSetup.GET;
               ConsSource.GET("Cons. Source Code");

               "Gen. Journal Template"           := ConsSetup."Gen. Jnl. Template";
               "Gen. Journal Batch"              := ConsSource."Acquisition Gen. Batch Name";
               "Closed Period Journal Template"  := ConsSetup."Gen. Jnl. Template";
               "Closed Period Journal Batch"     := ConsSource."Closed Period Batch Name";

               IF "No." = 0 THEN
                 "No." := GetLastNo + 1;
               //NOS-26 < RRV
             END;

    CaptionML=[ENU=FA Consolidation Register;
               RUS=ОС Консолидация Регистр];
    LookupPageID=Page50040;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Integer       ;CaptionML=[ENU=No.;
                                                              RUS=Но.] }
    { 2   ;   ;Cons. Source Code   ;Code20        ;TableRelation="Consolidation Source";
                                                   CaptionML=[ENU=Cons. Source Code;
                                                              RUS=Консол. Код Источника] }
    { 3   ;   ;Consolidation Date  ;Date          ;CaptionML=[ENU=Consolidation Date;
                                                              RUS=Дата Консолидации] }
    { 4   ;   ;User ID             ;Code20        ;CaptionML=[ENU=User ID;
                                                              RUS=Код Пользователя] }
    { 5   ;   ;From Entry No.      ;Integer       ;CaptionML=[ENU=From Entry No.;
                                                              RUS=От Операция Но.] }
    { 6   ;   ;To Entry No.        ;Integer       ;CaptionML=[ENU=To Entry No.;
                                                              RUS=До Операция Но.] }
    { 7   ;   ;From Posting Date   ;Date          ;CaptionML=[ENU=From Posting Date;
                                                              RUS=От Дата Учета] }
    { 8   ;   ;To Posting Date     ;Date          ;CaptionML=[ENU=To Posting Date;
                                                              RUS=До Дата Учета] }
    { 10  ;   ;Cancelled           ;Boolean       ;CaptionML=[ENU=Canceled;
                                                              RUS=Отменено] }
    { 11  ;   ;Cancel Proccessed   ;Boolean       ;CaptionML=[ENU=Cancel Proccessed;
                                                              RUS=Отмена Обработана] }
    { 15  ;   ;Gen. Journal Template;Code10       ;TableRelation="Gen. Journal Template";
                                                   CaptionML=[ENU=Gen. Journal Template;
                                                              RUS=Фин. Журнал Шаблон];
                                                   Editable=No }
    { 16  ;   ;Gen. Journal Batch  ;Code10        ;TableRelation="Gen. Journal Batch".Name WHERE (Journal Template Name=FIELD(Gen. Journal Template));
                                                   CaptionML=[ENU=Gen. Journal Batch;
                                                              RUS=Фин. Журнал Раздел];
                                                   Editable=No }
    { 17  ;   ;Closed Period Journal Template;Code10;
                                                   TableRelation="Gen. Journal Template";
                                                   CaptionML=[ENU=Closed Period Journal Template;
                                                              RUS=Закрытый Период Фин. Журнал Шаблон];
                                                   Editable=No }
    { 18  ;   ;Closed Period Journal Batch;Code10 ;TableRelation="Gen. Journal Batch".Name WHERE (Journal Template Name=FIELD(Closed Period Journal Template));
                                                   CaptionML=[ENU=Closed Period Journal Batch;
                                                              RUS=Закрытый Период Фин. Журнал Раздел];
                                                   Editable=No }
    { 19  ;   ;Reposted Journal Template;Code10   ;TableRelation="Gen. Journal Template";
                                                   CaptionML=[ENU=Reposted Journal Template;
                                                              RUS=Перепроведение Шаблон];
                                                   Editable=No }
    { 20  ;   ;Reposted Journal Batch;Code10      ;TableRelation="Gen. Journal Batch".Name WHERE (Journal Template Name=FIELD(Reposted Journal Template));
                                                   CaptionML=[ENU=Reposted Journal Batch;
                                                              RUS=Перепроведение Журнал Раздел];
                                                   Editable=No }
    { 21  ;   ;Removed Journal Template;Code10    ;TableRelation="Gen. Journal Template";
                                                   CaptionML=[ENU=Removed Journal Template;
                                                              RUS=Удаление Шаблон];
                                                   Editable=No }
    { 22  ;   ;Removed Journal Batch;Code10       ;TableRelation="Gen. Journal Batch".Name WHERE (Journal Template Name=FIELD(Removed Journal Template));
                                                   CaptionML=[ENU=Removed Journal Batch;
                                                              RUS=Удаление Журнал Раздел];
                                                   Editable=No }
    { 52  ;   ;Unloaded Entries From Date;Date    ;FieldClass=FlowField;
                                                   CalcFormula=Min("Cons. Data Buffer"."Document Date" WHERE (Export Cons. Source Code=FIELD(Cons. Source Code),
                                                                                                              Export Consolidation Register=FILTER(0)));
                                                   CaptionML=[ENU=Unloaded Entries From Date;
                                                              RUS=От Дата Учета];
                                                   Editable=No }
    { 53  ;   ;Unloaded Entries To Date;Date      ;FieldClass=FlowField;
                                                   CalcFormula=Max("Cons. Data Buffer"."Document Date" WHERE (Export Cons. Source Code=FIELD(Cons. Source Code),
                                                                                                              Export Consolidation Register=FILTER(0)));
                                                   CaptionML=[ENU=Unloaded Entries From Date;
                                                              RUS=До Дата Учета];
                                                   Editable=No }
    { 55  ;   ;Deleted             ;Boolean       ;CaptionML=[ENU=Deleted;
                                                              RUS=Удалено] }
    { 56  ;   ;Deleted by User ID  ;Code20        ;CaptionML=[ENU=User Deleted;
                                                              RUS=Удалено Пользователем] }
    { 57  ;   ;Deleted DateTime    ;DateTime      ;CaptionML=[ENU=Deleted DateTime;
                                                              RUS=Дата Время Удаления] }
    { 70  ;   ;Consolidation Time  ;Time          ;CaptionML=[ENU=Consolidation Time;
                                                              RUS=Время Консолидации] }
    { 50000;  ;Total Entries In Session;Integer   ;CaptionML=[ENU=Total Entries in Session;
                                                              RUS=Всего Операций в Сеансе] }
    { 50005;  ;Total Succ. Loaded In Session;Integer;
                                                   CaptionML=[ENU=Total Successfully Loaded In Session;
                                                              RUS=Кол-во Успешно Загруженных в Сеансе] }
    { 50006;  ;Total Accept In Session;Integer    ;CaptionML=[ENU=Total Exception In Session;
                                                              RUS=Кол-во Принятых в Сеансе] }
    { 50007;  ;Total Loaded without Jnl;Integer   ;CaptionML=[ENU=Total Loaded without Journals;
                                                              RUS=Кол-во Обработанных без Журнала в Сеансе] }
    { 50010;  ;Total Unloaded In Session;Integer  ;CaptionML=[ENU=Total Unloaded In Session;
                                                              RUS=Кол-во Незагруженных в Сеансе] }
  }
  KEYS
  {
    {    ;Cons. Source Code,No.                   ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    LOCAL PROCEDURE GetLastNo@1101495000() : Integer;
    VAR
      FAConsReg@1101495000 : Record 50006;
    BEGIN
      FAConsReg.SETRANGE("Cons. Source Code","Cons. Source Code");
      IF FAConsReg.FINDLAST THEN
        EXIT(FAConsReg."No.");
      EXIT(0);
    END;

    BEGIN
    {
      NC PIF001 AK Таблица перенесена с другого проекта и кастомизирована
      NC MP 28.02.07 Новые поля Count Unloaded Entry In Buffer
                     Unloaded Entries From Date
                     Unloaded Entries To Date
                     Count Exception
      NC PIF001 MP Новые поля Deleted, User Deleted, Deleted DateTime
      NC PIF001 MP Новое поле Compression

      NOS-26 RRV Доработан триггер OnInsert
    }
    END.
  }
}

