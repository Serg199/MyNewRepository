OBJECT Table 14902 Customer Agreement
{
  OBJECT-PROPERTIES
  {
    Date=08.06.17;
    Time=18:34:14;
    Modified=Yes;
    Version List=NAVRU10.00,NOS-26;
  }
  PROPERTIES
  {
    DataCaptionFields=Customer No.,No.;
    OnInsert=BEGIN
               Cust.GET("Customer No.");
               Cust.TESTFIELD("Agreement Posting",Cust."Agreement Posting"::Mandatory);
               IF "No." = '' THEN BEGIN
                 Cust.TESTFIELD("Agreement Nos.");
                 NoSeriesMgt.InitSeries(Cust."Agreement Nos.",xRec."No. Series",WORKDATE,"No.","No. Series");
                 Description := STRSUBSTNO('%1 %2',Text12400,"No.");
               END;

               //NC MTD02 > AIG
               {
               CustAgrmt.RESET;
               CustAgrmt.SETCURRENTKEY("No.");
               CustAgrmt.SETRANGE("No.","No.");
               IF CustAgrmt.FINDSET THEN
                 REPEAT
                   IF CustAgrmt."Customer No." <> "Customer No." THEN
                     ERROR(Text12403,FIELDCAPTION("No."),CustAgrmt."Customer No.");
                 UNTIL CustAgrmt.NEXT = 0;
               }
               //NC MTD02 < AIG

               CustTransferFields;
               CustTransferDimensions;

               SalesSetup.GET;
               IF SalesSetup."Synch. Agreement Dimension" THEN BEGIN
                 //NC OMCP02 > DP
                 IF "Agreement Type"= "Agreement Type"::Trade THEN
                   SalesSetup.TESTFIELD("Cust. Trade Agrmnt. Dim. Code")
                 ELSE
                 //NC OMCP02 > DP

                 SalesSetup.TESTFIELD("Customer Agreement Dim. Code");

                 DimValue.INIT;
                 //NC OMCP02 > DP
                 IF "Agreement Type"= "Agreement Type"::Trade THEN BEGIN
                   DimValue."Dimension Code" := SalesSetup."Cust. Trade Agrmnt. Dim. Code";
                   //NC OAM45 > RD
                   DimValue.Marked := FALSE;
                   END
                   //NC OAM45  <RD
                 ELSE BEGIN
                 //NC OMCP02 > DP

                 DimValue."Dimension Code" := SalesSetup."Customer Agreement Dim. Code";
                 //NC OAM45 > RD
                 DimValue.Marked := TRUE;
                 END;
                 //NC OAM45 < RD
                 DimValue.Code := "No.";
                 //NC MLN17 > DP
                 IF "External Agreement No."<>'' THEN
                   DimValue.Name := COPYSTR("External Agreement No.",1,MAXSTRLEN(DimValue.Name))
                 ELSE
                 //NC MLN17 < DP
                 DimValue.Name := COPYSTR("No.",1,MAXSTRLEN(DimValue.Name));
                 //NC NOS-26 > ENK
                 {
                 IF DimValue.INSERT THEN;
                 }
                 DimValue."Company Name" := COMPANYNAME;
                 IF DimValue.INSERT(TRUE) THEN;
                 //NC NOS-26 < ENK

                 //NC OAM31 > PCH
                 {
                 DefaultDim2.INIT;
                 DefaultDim2."Table ID" := DATABASE::"Customer Agreement";
                 DefaultDim2."No." := "No.";

                 //NC OMCP02 > DP
                 IF "Agreement Type"= "Agreement Type"::Trade THEN
                   DefaultDim2."Dimension Code" := SalesSetup."Cust. Trade Agrmnt. Dim. Code"
                 ELSE
                 //NC OMCP02 > DP

                 DefaultDim2."Dimension Code" := SalesSetup."Customer Agreement Dim. Code";
                 DefaultDim2."Dimension Value Code" := "No.";
                 DefaultDim2."Value Posting" := DefaultDim2."Value Posting"::"Same Code";
                 IF DefaultDim2.INSERT THEN;
                 }
                 IF (CurrCompany = '') OR (CurrCompany = COMPANYNAME) THEN
                   DefaultDim2Adv.CHANGECOMPANY
                 ELSE
                   DefaultDim2Adv.CHANGECOMPANY(CurrCompany);

                 DefaultDim2Adv.INIT;
                 DefaultDim2Adv."Table ID" := DATABASE::"Customer Agreement";
                 DefaultDim2Adv."Source No." := "Customer No.";
                 DefaultDim2Adv."No." := "No.";

                 IF "Agreement Type"= "Agreement Type"::Trade THEN
                   DefaultDim2Adv."Dimension Code" := SalesSetup."Cust. Trade Agrmnt. Dim. Code"
                 ELSE

                 DefaultDim2Adv."Dimension Code" := SalesSetup."Customer Agreement Dim. Code";
                 DefaultDim2Adv."Dimension Value Code" := "No.";
                 DefaultDim2Adv."Value Posting" := DefaultDim2Adv."Value Posting"::"Same Code";

                 IF NOT DefaultDim2Adv.INSERT THEN ;
                 //NC OAM31 < PCH
               END;
               //TDRANCS-1207>
               IF "Type Deal" = '' THEN
                 IF g_recDealType.GET('UNKNOWN') THEN
                   "Type Deal" := g_recDealType.Code;
               //TDRANCS-1207<
             END;

    OnModify=VAR
               l_RecRef@1101495000 : RecordRef;
             BEGIN
               SalesSetup.GET;
               //NC OMCP02 > DP
               IF "Agreement Type"= "Agreement Type"::Trade THEN BEGIN
                 IF DimValue.GET(SalesSetup."Cust. Trade Agrmnt. Dim. Code","No.") THEN BEGIN
                   DimValue.Name := COPYSTR("No.",1,MAXSTRLEN(DimValue.Name));
                   IF Blocked > 0 THEN
                     DimValue.Blocked := TRUE
                   ELSE
                     DimValue.Blocked := FALSE;
                   //NC OAM45 > RD
                   DimValue.Marked := FALSE;
                   //NC OAM45  <RD
                   DimValue.MODIFY;
                 END;
               END ELSE
               //NC OMCP02 > DP

               IF DimValue.GET(SalesSetup."Customer Agreement Dim. Code","No.") THEN BEGIN

                 //NC MLN17 > DP
                 IF "External Agreement No."<>'' THEN
                   DimValue.Name := COPYSTR("External Agreement No.",1,MAXSTRLEN(DimValue.Name))
                 ELSE
                 //NC MLN17 < DP

                 DimValue.Name := COPYSTR("No.",1,MAXSTRLEN(DimValue.Name));
                 IF Blocked > 0 THEN
                   DimValue.Blocked := TRUE
                 ELSE
                   DimValue.Blocked := FALSE;
                   //NC OAM45 > RD
                   DimValue.Marked := TRUE;
                   //NC OAM45  <RD
                   //NC NOS-26 > ENK
                   {
                   DimValue.MODIFY;
                   }
                   DimValue.MODIFY(TRUE);
                   //NC NOS-26 < ENK
               END;

               SynchroniseIt(1); // TD BMN 23.11.2012 NCS-712
               //TDRANCS-1405>
               GLSetup.GET;
               IF GLSetup."Create Deal for Agreement" THEN BEGIN
                 l_RecRef.GETTABLE(Rec);
                 IF Deal.fn_DealFromAgrCreate(l_RecRef) THEN "Deal No." := "No.";
               END;
               //TDRANCS-1405<
             END;

    OnDelete=VAR
               CustAgreement@1101495002 : Record 14902;
               VendAgreement@1101495001 : Record 14901;
               IsDimDelete@1101495000 : Boolean;
             BEGIN
               CustLedgEntry.RESET;
               CustLedgEntry.SETRANGE("Customer No.","Customer No.");
               CustLedgEntry.SETRANGE("Agreement No.","No.");
               IF CustLedgEntry.FINDFIRST THEN
                 ERROR(Text001);

               SalesSetup.GET;

               //NC OMCP02.1 > DP
               VendAgreement.SETRANGE("No.","No.");
               CustAgreement.SETFILTER("Customer No.",'<>%1',"Customer No.");
               CustAgreement.SETRANGE("No.","No.");
               IsDimDelete := CustAgreement.ISEMPTY AND VendAgreement.ISEMPTY;
               IF IsDimDelete THEN BEGIN
               //NC OMCP02.1 < DP

               //NC OMCP02 > DP
               IF "Agreement Type"= "Agreement Type"::Trade THEN BEGIN
                 IF DimValue.GET(SalesSetup."Cust. Trade Agrmnt. Dim. Code","No.") THEN
                   DimValue.DELETE;
               END ELSE
               //NC OMCP02 < DP

               IF DimValue.GET(SalesSetup."Customer Agreement Dim. Code","No.") THEN
                 DimValue.DELETE;

               //NC OMCP02.1 > DP
               END;
               //NC OMCP02.1 < DP

               //NC MLN18 > DP
               AgreementDetail.RESET;
               AgreementDetail.SETRANGE("Source Type",AgreementDetail."Source Type"::Customer);
               AgreementDetail.SETRANGE("Source No.","Customer No.");
               AgreementDetail.SETRANGE("Agreement No.","No.");
               AgreementDetail.DELETEALL(TRUE);
               //NC MLN18 < DP

               //NC OAM31 > PCH
               DefaultDim2Adv.RESET;
               DefaultDim2Adv.SETRANGE("Table ID",DATABASE::"Customer Agreement");
               DefaultDim2Adv.SETRANGE("Source No.","Customer No.");
               DefaultDim2Adv.SETRANGE("No.","No.");
               DefaultDim2Adv.DELETEALL;
               //NC OAM31 < PCH
             END;

    OnRename=BEGIN
               ERROR(Text003,TABLECAPTION);
             END;

    CaptionML=[ENU=Customer Agreement;
               RUS=Договор клиента];
    LookupPageID=Page14900;
    DrillDownPageID=Page14900;
  }
  FIELDS
  {
    { 1   ;   ;Customer No.        ;Code20        ;TableRelation=Customer;
                                                   CaptionML=[ENU=Customer No.;
                                                              RUS=Код клиента] }
    { 2   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  Cust.GET("Customer No.");
                                                                  NoSeriesMgt.TestManual(Cust."Agreement Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              RUS=Номер] }
    { 3   ;   ;Description         ;Text250       ;CaptionML=[ENU=Description;
                                                              RUS=Описание] }
    { 4   ;   ;External Agreement No.;Text30      ;CaptionML=[ENU=External Agreement No.;
                                                              RUS=Номер внешнего договора] }
    { 5   ;   ;Agreement Date      ;Date          ;CaptionML=[ENU=Agreement Date;
                                                              RUS=Дата договора] }
    { 6   ;   ;Active              ;Boolean       ;CaptionML=[ENU=Active;
                                                              RUS=Активно] }
    { 7   ;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                CheckDates;
                                                              END;

                                                   CaptionML=[ENU=Starting Date;
                                                              RUS=Дата начала] }
    { 8   ;   ;Expire Date         ;Date          ;OnValidate=VAR
                                                                l_RecRef@1101495000 : RecordRef;
                                                              BEGIN
                                                                CheckDates;
                                                                //TDRANCS-1479>
                                                                GLSetup.GET;
                                                                IF GLSetup."Create Deal for Agreement" THEN BEGIN
                                                                  l_RecRef.GETTABLE(Rec);
                                                                  IF Deal.fn_DealFromAgrUpdate(l_RecRef) THEN "Deal No." := "No.";
                                                                END;
                                                                //TDRANCS-1479<
                                                              END;

                                                   CaptionML=[ENU=Expire Date;
                                                              RUS=Дата окончания];
                                                   Description=TDRANCS-1479 }
    { 9   ;   ;Agreement Group     ;Code20        ;TableRelation="Agreement Group".Code WHERE (Type=CONST(Sales));
                                                   CaptionML=[ENU=Agreement Group;
                                                              RUS=Группа договоров] }
    { 10  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Customer No.));
                                                   CaptionML=[ENU=Ship-to Code;
                                                              RUS=Код получателя] }
    { 12  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Sales Comment Line" WHERE (Document Type=CONST(Agreement),
                                                                                                 No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              RUS=Комментарий] }
    { 14  ;   ;Contact             ;Text50        ;CaptionML=[ENU=Contact;
                                                              RUS=Контакт] }
    { 15  ;   ;Phone No.           ;Text30        ;CaptionML=[ENU=Phone No.;
                                                              RUS=Телефон] }
    { 16  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              RUS=Код глобального измерения 1];
                                                   CaptionClass='1,1,1' }
    { 17  ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              RUS=Код глобального измерения 2];
                                                   CaptionClass='1,1,2' }
    { 20  ;   ;Credit Limit (LCY)  ;Decimal       ;OnValidate=BEGIN
                                                                Cust.GET("Customer No.");
                                                                IF "Credit Limit (LCY)" > Cust."Credit Limit (LCY)" THEN
                                                                  ERROR(Text007);
                                                              END;

                                                   CaptionML=[ENU=Credit Limit (LCY);
                                                              RUS=Кредитный лимит (руб.)];
                                                   Description=NOS-26;
                                                   AutoFormatType=1;
                                                   CaptionClass=['1,11,1,14902,20' ] }
    { 21  ;   ;Customer Posting Group;Code10      ;TableRelation="Customer Posting Group";
                                                   OnValidate=BEGIN
                                                                IF ("Customer Posting Group" <> xRec."Customer Posting Group")

                                                                //NC NCS-1559 > DP
                                                                AND (xRec."Customer Posting Group"<>'')
                                                                //NC NCS-1559 < DP

                                                                  THEN BEGIN
                                                                  SalesSetup.GET;
                                                                  IF NOT SalesSetup."Allow Alter Posting Groups" THEN
                                                                    ERROR(Text12401,FIELDCAPTION("Customer Posting Group"),
                                                                      SalesSetup.FIELDCAPTION("Allow Alter Posting Groups"),SalesSetup.TABLECAPTION);
                                                                END;
                                                                //NC MLN09.5 > DP
                                                                IF ("Agreement Type"="Agreement Type"::Loans) THEN BEGIN
                                                                  CustPostingGroup.RESET;
                                                                  CustPostingGroup.SETRANGE("Loan Princ/Int. Posting Group","Customer Posting Group");
                                                                  CustPostingGroup.SETRANGE("Loan Interest",TRUE);
                                                                  IF CustPostingGroup.FINDFIRST THEN
                                                                    "Interest Posting Group" := CustPostingGroup.Code;
                                                                END;
                                                                //NC MLN09.5 > DP
                                                              END;

                                                   CaptionML=[ENU=Customer Posting Group;
                                                              RUS=Учетная группа клиента] }
    { 22  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Code;
                                                              RUS=Код валюты] }
    { 23  ;   ;Customer Price Group;Code10        ;TableRelation="Customer Price Group";
                                                   CaptionML=[ENU=Customer Price Group;
                                                              RUS=Ценовая группа клиента] }
    { 24  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[ENU=Language Code;
                                                              RUS=Код языка] }
    { 27  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   CaptionML=[ENU=Payment Terms Code;
                                                              RUS=Код условий платежа] }
    { 28  ;   ;Fin. Charge Terms Code;Code10      ;TableRelation="Finance Charge Terms";
                                                   CaptionML=[ENU=Fin. Charge Terms Code;
                                                              RUS=Код процентной ставки] }
    { 29  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Salesperson Code;
                                                              RUS=Код менеджера по продажам] }
    { 30  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   CaptionML=[ENU=Shipment Method Code;
                                                              RUS=Код метода поставки] }
    { 31  ;   ;Shipping Agent Code ;Code10        ;TableRelation="Shipping Agent";
                                                   OnValidate=BEGIN
                                                                IF "Shipping Agent Code" <> xRec."Shipping Agent Code" THEN
                                                                  VALIDATE("Shipping Agent Service Code",'');
                                                              END;

                                                   CaptionML=[ENU=Shipping Agent Code;
                                                              RUS=Код экспедитора] }
    { 34  ;   ;Customer Disc. Group;Code20        ;TableRelation="Customer Discount Group";
                                                   CaptionML=[ENU=Customer Disc. Group;
                                                              RUS=Группа скидки клиента] }
    { 35  ;   ;Prices Including VAT;Boolean       ;CaptionML=[ENU=Prices Including VAT;
                                                              RUS=Цены с учетом НДС] }
    { 39  ;   ;Blocked             ;Option        ;CaptionML=[ENU=Blocked;
                                                              RUS=Заблокировано];
                                                   OptionCaptionML=[ENU=" ,Ship,Invoice,All";
                                                                    RUS=" ,Поставка,Счет,Все"];
                                                   OptionString=[ ,Ship,Invoice,All] }
    { 47  ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   CaptionML=[ENU=Payment Method Code;
                                                              RUS=Код способа оплаты] }
    { 55  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              RUS=Фильтр по дате] }
    { 56  ;   ;Global Dimension 1 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Filter;
                                                              RUS=Фильтр глобального измерения 1];
                                                   CaptionClass='1,3,1' }
    { 57  ;   ;Global Dimension 2 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Global Dimension 2 Filter;
                                                              RUS=Фильтр глобального измерения 2];
                                                   CaptionClass='1,3,2' }
    { 58  ;   ;Balance             ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Customer No.=FIELD(Customer No.),
                                                                                                              Agreement No.=FIELD(No.),
                                                                                                              Customer Posting Group=FIELD(Posting Group Filter)));
                                                   CaptionML=[ENU=Balance;
                                                              RUS=Сальдо];
                                                   Description=NOS-26;
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 59  ;   ;Balance (LCY)       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(Customer No.),
                                                                                                                      Agreement No.=FIELD(No.),
                                                                                                                      Customer Posting Group=FIELD(Posting Group Filter)));
                                                   CaptionML=[ENU=Balance (LCY);
                                                              RUS=Сальдо (руб.)];
                                                   Description=NOS-26;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   CaptionClass=['1,11,1,14902,59' ] }
    { 60  ;   ;Net Change          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Customer No.=FIELD(Customer No.),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Agreement No.=FIELD(No.)));
                                                   CaptionML=[ENU=Net Change;
                                                              RUS=Оборот];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Net Change (LCY)    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(Customer No.),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Agreement No.=FIELD(No.)));
                                                   CaptionML=[ENU=Net Change (LCY);
                                                              RUS=Оборот (руб.)];
                                                   Description=NOS-26;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   CaptionClass=['1,11,1,14902,61' ] }
    { 83  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[ENU=Location Code;
                                                              RUS=Код склада] }
    { 88  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                IF xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group" THEN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    VALIDATE("VAT Bus. Posting Group",GenBusPostingGrp."Def. VAT Bus. Posting Group");
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              RUS=Общая бизнес-группа] }
    { 97  ;   ;Debit Amount        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Debit Amount" WHERE (Customer No.=FIELD(Customer No.),
                                                                                                                      Entry Type=FILTER(<>Application),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Agreement No.=FIELD(No.)));
                                                   CaptionML=[ENU=Debit Amount;
                                                              RUS=Сумма по дебету];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 98  ;   ;Credit Amount       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Credit Amount" WHERE (Customer No.=FIELD(Customer No.),
                                                                                                                       Entry Type=FILTER(<>Application),
                                                                                                                       Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                       Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                       Posting Date=FIELD(Date Filter),
                                                                                                                       Agreement No.=FIELD(No.)));
                                                   CaptionML=[ENU=Credit Amount;
                                                              RUS=Сумма по кредиту];
                                                   BlankZero=Yes;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 99  ;   ;Debit Amount (LCY)  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Debit Amount (LCY)" WHERE (Customer No.=FIELD(Customer No.),
                                                                                                                            Entry Type=FILTER(<>Application),
                                                                                                                            Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                            Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                            Posting Date=FIELD(Date Filter),
                                                                                                                            Agreement No.=FIELD(No.)));
                                                   CaptionML=[ENU=Debit Amount (LCY);
                                                              RUS=Сумма по дебету (руб.)];
                                                   BlankZero=Yes;
                                                   Description=NOS-26;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   CaptionClass=['1,11,1,14902,99' ] }
    { 100 ;   ;Credit Amount (LCY) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Credit Amount (LCY)" WHERE (Customer No.=FIELD(Customer No.),
                                                                                                                             Entry Type=FILTER(<>Application),
                                                                                                                             Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                             Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                             Posting Date=FIELD(Date Filter),
                                                                                                                             Agreement No.=FIELD(No.)));
                                                   CaptionML=[ENU=Credit Amount (LCY);
                                                              RUS=Сумма по кредиту (руб.)];
                                                   BlankZero=Yes;
                                                   Description=NOS-26;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   CaptionClass=['1,11,1,14902,100' ] }
    { 102 ;   ;E-Mail              ;Text80        ;CaptionML=[ENU=Email;
                                                              RUS=Эл. почта] }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              RUS=Серия номеров] }
    { 110 ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              RUS=НДС бизнес-группа] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Responsibility Center;
                                                              RUS=Центр ответственности] }
    { 5750;   ;Shipping Advice     ;Option        ;CaptionML=[ENU=Shipping Advice;
                                                              RUS=Статус отгрузки];
                                                   OptionCaptionML=[ENU=Partial,Complete;
                                                                    RUS=Частично,Полностью];
                                                   OptionString=Partial,Complete }
    { 5790;   ;Shipping Time       ;DateFormula   ;CaptionML=[ENU=Shipping Time;
                                                              RUS=Время отгрузки] }
    { 5792;   ;Shipping Agent Service Code;Code10 ;TableRelation="Shipping Agent Services".Code WHERE (Shipping Agent Code=FIELD(Shipping Agent Code));
                                                   OnValidate=BEGIN
                                                                IF ("Shipping Agent Code" <> '') AND
                                                                   ("Shipping Agent Service Code" <> '')
                                                                THEN
                                                                  IF ShippingAgentService.GET("Shipping Agent Code","Shipping Agent Service Code") THEN
                                                                    "Shipping Time" := ShippingAgentService."Shipping Time"
                                                                  ELSE
                                                                    EVALUATE("Shipping Time",'<>');
                                                              END;

                                                   CaptionML=[ENU=Shipping Agent Service Code;
                                                              RUS=Код услуги экспедитора] }
    { 12400;  ;Default Bank Code   ;Code10        ;TableRelation="Customer Bank Account".Code WHERE (Customer No.=FIELD(Customer No.));
                                                   CaptionML=[ENU=Default Bank Code;
                                                              RUS=Код банка по умолчанию] }
    { 12422;  ;G/L Account Filter  ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="G/L Account";
                                                   CaptionML=[ENU=G/L Account Filter;
                                                              RUS=Фильтр по счету ГК] }
    { 12423;  ;G/L Starting Date Filter;Date      ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=G/L Starting Date Filter;
                                                              RUS=ГК - фильтр по дате начала] }
    { 12424;  ;G/L Starting Balance;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("G/L Entry".Amount WHERE (Source Type=CONST(Customer),
                                                                                             Source No.=FIELD(Customer No.),
                                                                                             G/L Account No.=FIELD(G/L Account Filter),
                                                                                             Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                             Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                             Agreement No.=FIELD(No.),
                                                                                             Posting Date=FIELD(UPPERLIMIT(G/L Starting Date Filter))));
                                                   CaptionML=[ENU=G/L Starting Balance;
                                                              RUS=ГК - начальное сальдо];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 12425;  ;G/L Net Change      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("G/L Entry".Amount WHERE (Source Type=CONST(Customer),
                                                                                             Source No.=FIELD(Customer No.),
                                                                                             G/L Account No.=FIELD(G/L Account Filter),
                                                                                             Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                             Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                             Agreement No.=FIELD(No.),
                                                                                             Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=G/L Net Change;
                                                              RUS=Оборот по ГК];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 12426;  ;G/L Debit Amount    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("G/L Entry"."Debit Amount" WHERE (Source Type=CONST(Customer),
                                                                                                     Source No.=FIELD(Customer No.),
                                                                                                     G/L Account No.=FIELD(G/L Account Filter),
                                                                                                     Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                     Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                     Agreement No.=FIELD(No.),
                                                                                                     Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=G/L Debit Amount;
                                                              RUS=ГК - сумма по дебету];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 12427;  ;G/L Credit Amount   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("G/L Entry"."Credit Amount" WHERE (Source Type=CONST(Customer),
                                                                                                      Source No.=FIELD(Customer No.),
                                                                                                      G/L Account No.=FIELD(G/L Account Filter),
                                                                                                      Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                      Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                                      Agreement No.=FIELD(No.),
                                                                                                      Posting Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=G/L Credit Amount;
                                                              RUS=ГК - сумма по кредиту];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 12428;  ;G/L Balance to Date ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("G/L Entry".Amount WHERE (Source Type=CONST(Customer),
                                                                                             Source No.=FIELD(Customer No.),
                                                                                             G/L Account No.=FIELD(G/L Account Filter),
                                                                                             Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                             Global Dimension 2 Code=FIELD(Global Dimension 2 Filter),
                                                                                             Agreement No.=FIELD(No.),
                                                                                             Posting Date=FIELD(UPPERLIMIT(Date Filter))));
                                                   CaptionML=[ENU=G/L Balance to Date;
                                                              RUS=ГК - сальдо на данное число];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 50000;  ;Deal No.            ;Code20        ;TableRelation=Deal."Deal ID";
                                                   OnValidate=BEGIN
                                                                //TD BMN 03.07.2013 NCS-1048 >
                                                                IF Deal.GET("Deal No.") THEN
                                                                  "Type Deal" := Deal."Type Deal"
                                                                ELSE
                                                                  "Type Deal" := '';
                                                                //TD BMN 03.07.2013 NCS-1048 <

                                                                //TDRANCS-1207>
                                                                IF "Type Deal" = '' THEN
                                                                  IF g_recDealType.GET('UNKNOWN') THEN
                                                                    "Type Deal" := g_recDealType.Code;
                                                                //TDRANCS-1207<
                                                              END;

                                                   CaptionML=[ENU=Deal No.;
                                                              RUS=Сделка Но.];
                                                   Description=NC MTD01 RD }
    { 50001;  ;Agreement Type      ;Option        ;OnValidate=BEGIN
                                                                //TD BMN 03.07.2013 NCS-1048 >
                                                                CASE "Agreement Type" OF
                                                                "Agreement Type"::Loans: BEGIN
                                                                  "Type Deal" := 'LOAN';
                                                                  //TDRANCS-1405>
                                                                  //"Deal No." := '';
                                                                  //TDRANCS-1405<
                                                                  END;
                                                                "Agreement Type"::Standard: BEGIN
                                                                  "Type Deal" := '';
                                                                  //TDRANCS-1405>
                                                                  //"Deal No." := '';
                                                                  //TDRANCS-1405<
                                                                  END;
                                                                END;
                                                                //TD BMN 03.07.2013 NCS-1048 <

                                                                //TDRANCS-1207>
                                                                IF "Type Deal" = '' THEN
                                                                  IF g_recDealType.GET('UNKNOWN') THEN
                                                                    "Type Deal" := g_recDealType.Code;
                                                                //TDRANCS-1207<
                                                              END;

                                                   CaptionML=[ENU=Agreement Type;
                                                              RUS=Договор Тип];
                                                   OptionCaptionML=[ENU=Standard,Trade,Loans,FX MM Loan;
                                                                    RUS=Стандартный,Торговый,Кредиты и Займы,FX MM Займ];
                                                   OptionString=Standard,Trade,Loans,FX MM Loan;
                                                   Description=NC TR198 DP,TDRANCS-1515 }
    { 50002;  ;Agreement Amount    ;Decimal       ;CaptionML=[ENU=Agreement Amount;
                                                              RUS=Договор Сумма];
                                                   Description=NC MLN04 DP }
    { 50005;  ;Interest Posting Group;Code10      ;TableRelation="Customer Posting Group".Code WHERE (Loan Interest=CONST(Yes));
                                                   CaptionML=[ENU=Interest Posting Group;
                                                              RUS=Проценты Учетная Группа];
                                                   Description=NC MLN09.5 DP }
    { 50009;  ;Type Deal           ;Code20        ;TableRelation="Deal Type";
                                                   CaptionML=[ENU=Type Deal;
                                                              RUS=Тип Сделки];
                                                   Description=NCS-1048;
                                                   Editable=No }
    { 50011;  ;Interest Rate       ;Decimal       ;CaptionML=[ENU=Interest Rate;
                                                              RUS=Процентная Ставка];
                                                   DecimalPlaces=2:7;
                                                   Description=TD NCS-712 }
    { 50012;  ;Interest Rate Type  ;Option        ;CaptionML=[ENU=Interest Rate Type;
                                                              RUS=Тип Процентной Ставки];
                                                   OptionCaptionML=[ENU=Simple,Fix.Ext.+Simple,Variable Ext.,Complex;
                                                                    RUS=Простой %,Фикс.Внеш.%+Простой%,Перемен.Внеш.%,Сложный %];
                                                   OptionString=Simple,Fix.Ext.+Simple,Variable Ext.,Complex;
                                                   Description=TD NCS-712 }
    { 50013;  ;Agreement Detail Finish Date;Date  ;FieldClass=FlowField;
                                                   CalcFormula=Max("Agreement Detail"."Finish Date" WHERE (Source Type=CONST(Customer),
                                                                                                           Source No.=FIELD(Customer No.),
                                                                                                           Agreement No.=FIELD(No.),
                                                                                                           Condition Type=CONST(New),
                                                                                                           Blocked=CONST(No)));
                                                   CaptionML=RUS=Дата Окончания По Условию Договора;
                                                   Description=NCS-1050 }
    { 50015;  ;Reserve             ;Boolean       ;CaptionML=[ENU=Reserve Accrual;
                                                              RUS=Начислять Резерв];
                                                   Description=NC NCS-1268 DP }
    { 50020;  ;Reserve %           ;Decimal       ;CaptionML=[ENU=Reserve %;
                                                              RUS=Резерв %];
                                                   Description=NC NCS-1268 DP }
    { 50025;  ;Reserve Posting Group;Code10       ;TableRelation="Customer Posting Group" WHERE (Loan Reserve=CONST(Yes));
                                                   CaptionML=[ENU=Reserve Posting Group;
                                                              RUS=Резерв Учетная Группа];
                                                   Description=NC NCS-1268 DP }
    { 50030;  ;Reserve % Posting Group;Code10     ;TableRelation="Customer Posting Group" WHERE (Loan Reserve=CONST(Yes));
                                                   CaptionML=[ENU=Reserve % Posting Group;
                                                              RUS=Резерв Проценты Учетная Группа];
                                                   Description=NC NCS-1268 DP }
    { 50050;  ;Posting Group Filter;Code20        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Posting Group Filter;
                                                              RUS=Учетная Группа Фильтр];
                                                   Description=NC NCS 1597 }
  }
  KEYS
  {
    {    ;Customer No.,No.                        ;Clustered=Yes }
    {    ;Agreement Group,No.                      }
    {    ;No.                                      }
    {    ;Agreement Type,Currency Code,Customer Posting Group,Customer No.,No. }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1210001 : TextConst 'ENU=You cannot delete agreement if you already have ledger entries.;RUS=Невозможно удалить договор, если уже имеются операции ГК.';
      SalesSetup@1210002 : Record 311;
      Cust@1210003 : Record 18;
      CustLedgEntry@1470001 : Record 21;
      DimValue@1210006 : Record 349;
      GenBusPostingGrp@1210009 : Record 250;
      DefaultDim@1210013 : Record 352;
      DefaultDim2@1210014 : Record 352;
      CustAgrmt@1210017 : Record 14902;
      ShippingAgentService@1210018 : Record 5790;
      NoSeriesMgt@1470000 : Codeunit 396;
      DimMgt@1210004 : Codeunit 408;
      Text003@1210015 : TextConst 'ENU=You cannot rename %1.;RUS=Переименование %1 невозможно.';
      Text004@1210008 : TextConst 'ENU=post;RUS=учесть';
      Text005@1210007 : TextConst 'ENU=create;RUS=создать';
      Text006@1210005 : TextConst 'ENU=You cannot %1 this type of document when Customer %2 is blocked with type %3.;RUS=Нельзя %1 этот тип документа, пока клиент %2 заблокирован с типом %3.';
      Text007@1210010 : TextConst 'ENU=Agreement credit limit should not exceed Customer credit limit.;RUS=Кредитный лимит договора не должен превышать кредитный лимит клиента.';
      Text12400@1210011 : TextConst 'ENU=Agreement;RUS=Договор';
      Text12401@1210012 : TextConst 'ENU=You cannot change %1 until you check %2 in %3.;RUS=Невозможно изменить %1 до проверки %2 в %3.';
      Text12402@1210000 : TextConst 'ENU=%1 should be later than %2.;RUS=%1 должно следовать за %2.';
      Text12403@1210016 : TextConst 'ENU=This %1 already used for customer %2.;RUS=Этот %1 уже используется для клиента %2.';
      ">>>NOS-26"@1101495000 : Integer;
      "NCV>"@1101495007 : Integer;
      CustPostingGroup@1101495006 : Record 92;
      CurrCompany@1101495005 : Text[30];
      GLSetup@1101495004 : Record 98;
      "NCV<"@1101495003 : Integer;
      Deal@1101495002 : Record 50037;
      g_recDealType@1101495001 : Record 50038;
      DefaultDim2Adv@1101495008 : Record 50128;
      AgreementDetail@1101495010 : Record 50096;
      "<<<NOS-26"@1101495009 : Integer;

    PROCEDURE AssistEdit@2(OldCustAgreement@1000 : Record 14902) : Boolean;
    BEGIN
      Cust.GET("Customer No.");
      Cust.TESTFIELD("Agreement Nos.");
      IF NoSeriesMgt.SelectSeries(Cust."Agreement Nos.",OldCustAgreement."No. Series","No. Series") THEN BEGIN
        NoSeriesMgt.SetSeries("No.");
        EXIT(TRUE);
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      //NC DP 270912 <
      {
      DimMgt.SaveDefaultDim(DATABASE::"Customer Agreement","No.",FieldNumber,ShortcutDimCode);
      }
      DefaultDim2Adv.INIT;
      DefaultDim2Adv."Table ID" := DATABASE::"Customer Agreement";
      DefaultDim2Adv."Source No." := "Customer No.";
      DefaultDim2Adv."No." := "No.";
      GLSetup.GET;
      IF FieldNumber=1 THEN
        DefaultDim2Adv."Dimension Code" := GLSetup."Global Dimension 1 Code";
      IF  FieldNumber=2 THEN
        DefaultDim2Adv."Dimension Code" := GLSetup."Global Dimension 2 Code";
      DefaultDim2Adv."Dimension Value Code" := ShortcutDimCode;

      //TD BMN 27.06.2013 NCS-1065 >
      //IF NOT DefaultDim2Adv.INSERT THEN ;
      IF NOT DefaultDim2Adv.INSERT THEN
          DefaultDim2Adv.MODIFY;
      //TD BMN 27.06.2013 NCS-1065 <

      //NC DP 270912 <
      MODIFY;
    END;

    PROCEDURE LookupShortcutDimCode@28(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::"Customer Agreement","No.",FieldNumber,ShortcutDimCode);
    END;

    PROCEDURE CheckBlockedCustOnDocs@5(Cust2@1000 : Record 18;DocType@1001 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order';Shipment@1005 : Boolean;Transaction@1003 : Boolean);
    BEGIN
      IF ((Cust2.Blocked = Cust2.Blocked::All) OR
          ((Cust2.Blocked = Cust2.Blocked::Invoice) AND
           (DocType IN [DocType::Quote,DocType::Order,DocType::Invoice,DocType::"Blanket Order"])) OR
          ((Cust2.Blocked = Cust2.Blocked::Ship) AND
           (DocType IN [DocType::Quote,DocType::Order,DocType::"Blanket Order"]) AND
           (NOT Transaction)) OR
          ((Cust2.Blocked = Cust2.Blocked::Ship) AND
           (DocType IN [DocType::Quote,DocType::Order,DocType::Invoice,DocType::"Blanket Order"]) AND
           Shipment AND Transaction))
      THEN
        CustBlockedErrorMessage(Cust2,Transaction);
    END;

    PROCEDURE CheckBlockedCustOnJnls@7(Cust2@1003 : Record 18;DocType@1002 : ' ,Payment,Invoice,Credit Memo,Finance Charge,Reminder,Refund';Transaction@1000 : Boolean);
    BEGIN
      IF (Cust2.Blocked = Cust2.Blocked::All) OR
         ((Cust2.Blocked = Cust2.Blocked::Invoice) AND (DocType IN [DocType::Invoice,DocType::" "]))
      THEN
        CustBlockedErrorMessage(Cust2,Transaction)
    END;

    PROCEDURE CustBlockedErrorMessage@4(Cust2@1001 : Record 18;Transaction@1000 : Boolean);
    VAR
      Action@1002 : Text[30];
    BEGIN
      IF Transaction THEN
        Action := Text004
      ELSE
        Action := Text005;
      ERROR(Text006,Action,Cust2."No.",Cust2.Blocked);
    END;

    PROCEDURE CustTransferFields@1210000();
    BEGIN
      Contact := Cust.Contact;
      "Phone No." := Cust."Phone No.";
      "E-Mail" := Cust."E-Mail";
      Blocked := Cust.Blocked;

      //NC NCS-1131 > DP
      IF (Cust."Customer Posting Group"<>'') AND ("Customer Posting Group"='') THEN
      //NC NCS-1131 < DP

      "Customer Posting Group" := Cust."Customer Posting Group";
      "Gen. Bus. Posting Group" := Cust."Gen. Bus. Posting Group";
      "VAT Bus. Posting Group" := Cust."VAT Bus. Posting Group";
      "Global Dimension 1 Code" := Cust."Global Dimension 1 Code";
      "Global Dimension 2 Code" := Cust."Global Dimension 2 Code";
      "Credit Limit (LCY)" := Cust."Credit Limit (LCY)";
      "Currency Code" := Cust."Currency Code";
      "Customer Price Group" := Cust."Customer Price Group";
      "Customer Disc. Group" := Cust."Customer Disc. Group";
      "Prices Including VAT" := Cust."Prices Including VAT";
      "Language Code" := Cust."Language Code";
      "Payment Terms Code" := Cust."Payment Terms Code";
      "Payment Method Code" := Cust."Payment Method Code";
      "Fin. Charge Terms Code" := Cust."Fin. Charge Terms Code";
      "Salesperson Code" := Cust."Salesperson Code";
      "Shipment Method Code" := Cust."Shipment Method Code";
      "Location Code" := Cust."Location Code";
      "Responsibility Center" := Cust."Responsibility Center";
      "Shipping Advice" := Cust."Shipping Advice";
      "Shipping Agent Code" := Cust."Shipping Agent Code";
      "Shipping Agent Service Code" := Cust."Shipping Agent Service Code";
      "Shipping Time" := Cust."Shipping Time";
      "Default Bank Code" := Cust."Default Bank Code";
    END;

    PROCEDURE CustTransferDimensions@1210003();
    BEGIN
      DefaultDim.RESET;
      DefaultDim.SETRANGE("Table ID",DATABASE::Customer);
      DefaultDim.SETRANGE("No.","Customer No.");
      IF DefaultDim.FINDSET THEN
        REPEAT
          //NC OAM31 > PCH
          {
          DefaultDim2.INIT;
          DefaultDim2."Table ID" := DATABASE::"Customer Agreement";
          DefaultDim2."No." := "No.";
          DefaultDim2."Dimension Code" := DefaultDim."Dimension Code";
          DefaultDim2."Dimension Value Code" := DefaultDim."Dimension Value Code";
          DefaultDim2."Value Posting" := DefaultDim."Value Posting";
          //NC MTD02 > AIG
          {
          DefaultDim2.INSERT;
           }
          IF DefaultDim2.INSERT THEN;
          //NC MTD02 < AIG
          }
          DefaultDim2Adv.INIT;
          DefaultDim2Adv."Table ID" := DATABASE::"Customer Agreement";
          DefaultDim2Adv."Source No." := "Customer No.";
          DefaultDim2Adv."No." := "No.";
          DefaultDim2Adv."Dimension Code" := DefaultDim."Dimension Code";
          DefaultDim2Adv."Dimension Value Code" := DefaultDim."Dimension Value Code";
          DefaultDim2Adv."Value Posting" := DefaultDim."Value Posting";
          IF DefaultDim2Adv.INSERT THEN;
          //NC OAM31 < PCH
        UNTIL DefaultDim.NEXT = 0;
    END;

    PROCEDURE CheckDates@1210001();
    BEGIN
      IF ("Expire Date" <> 0D) AND ("Starting Date" <> 0D) AND ("Expire Date" < "Starting Date") THEN
        ERROR(Text12402,FIELDCAPTION("Expire Date"),FIELDCAPTION("Starting Date"));
    END;

    PROCEDURE GetDefaultDimSetID@1210005(DimSetID@1210001 : Integer;VAR ShortcutDim1Code@1210002 : Code[20];VAR ShortcutDim2Code@1210003 : Code[20]) : Integer;
    VAR
      AgrmtMgt@1210000 : Codeunit 12421;
      DimSetIDArr@1210004 : ARRAY [10] OF Integer;
    BEGIN
      DimSetIDArr[1] := DimSetID;
      DimSetIDArr[2] := AgrmtMgt.GetAgrmtDefaultDimSetID(DATABASE::"Customer Agreement","No.");
      EXIT(
        DimMgt.GetCombinedDimensionSetID(
          DimSetIDArr,ShortcutDim1Code,ShortcutDim2Code));
    END;

    PROCEDURE GetDefaultAdvDimSetID@1101495000(DimSetID@1210001 : Integer;VAR ShortcutDim1Code@1210002 : Code[20];VAR ShortcutDim2Code@1210003 : Code[20]) : Integer;
    VAR
      AgrmtMgt@1210000 : Codeunit 12421;
      DimSetIDArr@1210004 : ARRAY [10] OF Integer;
    BEGIN
      //NC NOS-26 > SPA
      DimSetIDArr[1] := DimSetID;
      DimSetIDArr[2] := AgrmtMgt.GetAgrmtDefaultAdvDimSetID(DATABASE::"Customer Agreement", "Customer No.", "No.");
      EXIT(
        DimMgt.GetCombinedDimensionSetID(
          DimSetIDArr,ShortcutDim1Code,ShortcutDim2Code));
      //NC NOS-26 < SPA
    END;

    LOCAL PROCEDURE ">NOS-26"@1101495005();
    BEGIN
    END;

    PROCEDURE SetCurrCompany@1101495001(NewCurrCompany@1101495000 : Text[30]);
    BEGIN
      //NC OAM31 > PCH
      CurrCompany := NewCurrCompany;
      //NC OAM31 < PCH
    END;

    PROCEDURE SynchroniseIt@1000000003(Mode@1000000000 : 'Insert,Modify,Delete,Rename');
    VAR
      SyncLog@1000000005 : Record 50121;
      Recref@1000000006 : RecordRef;
      xRecref@1000000004 : RecordRef;
      isDone@1000000007 : Boolean;
      AgreementDetail@1000000001 : Record 50096;
    BEGIN
      // TD BMN 23.11.2012 NCS-712

      xRecref.GETTABLE(xRec);
      xRecref.SETRECFILTER;
      Recref.GETTABLE(Rec);
      Recref.SETRECFILTER;

      SyncLog.Synchronise(Mode, xRecref, Recref);
    END;

    LOCAL PROCEDURE "<NOS-26"@1101495007();
    BEGIN
    END;

    BEGIN
    {
      NC MTD01 RD Добавлено поле "Deal No."
      NC MTD02 AIG Изменения в коде
      NC OMCP02 DP Добавление аналитики по договор в зависимости от его типа
      NC MLN04 DP Добавлено поле "Agreement Amount"
      NC MLN17 DP Наименование аналитики указывается по внеш. номеру договора
      NC MLN18 DP Удаление деталей договора при удалении последнего
      NC MLN09.5 DP Добавлено поле "Interest Posting Group"
      NC OAM22 DP Изменено свойство Caption Class полей ..(LCY)
      NC OAM45 RD Установка флага Marked для Dimension Value для неторговых договоров
      TD BMN 23.11.2012 NCS-712 "Интеграция данных из договоров OFF - IFRS"
      TD BMN 27.06.2013 NCS-1065 "Пакетное задание по начислению %% некорректно проставляет измерение СС в строках фин. журнала"
                        Синхронизировал изменение костцентра в карточке с обязательным измерением для договора
      TD BMN 02.07.2013 NCS-1050 "Добавить поле "Дата Окончания" в реестр кредитов выданных и полученных"
      TD BMN 03.07.2013 NCS-1048 "Изменение алгоритма синхронизации поля тип сделки OFF->MIS "
      TDRANCS-1207>
        Modified OnInsert, OnValidate - "Agreement Type", "Deal No."
      NC NCS-1131 DP Изменена функция CustTransferFields
      NC NCS-1268 DP Added Fields 50015-50030
      TDRANCS-1405>
        Modified OnModify, OnValidate for Agreement Type
      TDRANCS-1479>
        Modified OnValidate "Expire Date"
      TDRANCS-1515>
        Modified "Agreement Type" added FX MM Loan
      NC NCS-1559 DP Изменен триггер "Customer Posting Group" - OnValidate
      --------------------------
      BLD001 DP Создан билд, включающий модификации OAM31,OAM45,S1065,S1050,S1048,S1207,S1268,S1131,S1405,1479,S1515,NCS-1559
      NC NCS 1597 DP Дабавлено поле Posting Group Filter, изменены поля: Balance, Balance (LCY)
      -----
      NC NOS-26 SPA Добавлена функция GetDefaultAdvDimSetID
      NC NOS-26 ENK
    }
    END.
  }
}

