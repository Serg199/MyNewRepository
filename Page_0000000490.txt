OBJECT Page 490 Acc. Schedule Overview
{
  OBJECT-PROPERTIES
  {
    Date=27.06.17;
    Time=11:40:52;
    Modified=Yes;
    Version List=NAVW110.00,NOS-26;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Acc. Schedule Overview;
               RUS=Просмотр финансового отчета];
    SaveValues=Yes;
    LinksAllowed=No;
    SourceTable=Table85;
    DataCaptionExpr=CurrentSchedName + ' - ' + CurrentColumnName;
    PageType=List;
    ShowFilter=No;
    OnInit=BEGIN
             Dim4FilterEnable := TRUE;
             Dim3FilterEnable := TRUE;
             Dim2FilterEnable := TRUE;
             Dim1FilterEnable := TRUE;

             //NC NOS-26 > SPA
             CorrDim3FilterEnable := FALSE;
             CorrDim2FilterEnable := FALSE;
             CorrDim1FilterEnable := FALSE;
             //NC NOS-26 < SPA
           END;

    OnOpenPage=BEGIN
                 GLSetup.GET;
                 UseAmtsInAddCurrVisible := GLSetup."Additional Reporting Currency" <> '';
                 IF NewCurrentSchedName <> '' THEN
                   CurrentSchedName := NewCurrentSchedName;
                 IF CurrentSchedName = '' THEN
                   CurrentSchedName := Text000;
                 IF NewCurrentColumnName <> '' THEN
                   CurrentColumnName := NewCurrentColumnName;
                 IF CurrentColumnName = '' THEN
                   CurrentColumnName := Text000;
                 IF NewPeriodTypeSet THEN
                   PeriodType := ModifiedPeriodType;

                 AccSchedManagement.CopyColumnsToTemp(CurrentColumnName,TempColumnLayout);
                 AccSchedManagement.OpenSchedule(CurrentSchedName,Rec);
                 AccSchedManagement.OpenColumns(CurrentColumnName,TempColumnLayout);
                 AccSchedManagement.CheckAnalysisView(CurrentSchedName,CurrentColumnName,TRUE);
                 UpdateColumnCaptions;
                 IF AccSchedName.GET(CurrentSchedName) THEN
                   IF AccSchedName."Analysis View Name" <> '' THEN
                     AnalysisView.GET(AccSchedName."Analysis View Name")
                   ELSE
                     //NC NCS-1631 > DP
                     IF AccSchedName."G/L Corr. Analysis View Name" <> '' THEN
                       GLCorrAnalysisView.GET(AccSchedName."G/L Corr. Analysis View Name")
                     //NC NCS-1631 < DP
                   ELSE BEGIN
                     CLEAR(AnalysisView);
                     AnalysisView."Dimension 1 Code" := GLSetup."Global Dimension 1 Code";
                     AnalysisView."Dimension 2 Code" := GLSetup."Global Dimension 2 Code";
                     //NC NCS-1631 > DP
                     CLEAR(GLCorrAnalysisView);
                     GLCorrAnalysisView."Credit Dimension 1 Code" := GLSetup."Global Dimension 1 Code";
                     GLCorrAnalysisView."Credit Dimension 2 Code" := GLSetup."Global Dimension 2 Code";
                     //NC NCS-1631 < DP
                   END;

                 AccSchedManagement.FindPeriod(Rec,'',PeriodType);
                 SETFILTER(Show,'<>%1',Show::No);
                 SETRANGE("Dimension 1 Filter");
                 SETRANGE("Dimension 2 Filter");
                 SETRANGE("Dimension 3 Filter");
                 SETRANGE("Dimension 4 Filter");
                 SETRANGE("Cost Center Filter");
                 SETRANGE("Cost Object Filter");
                 SETRANGE("Cash Flow Forecast Filter");
                 SETRANGE("Cost Budget Filter");
                 SETRANGE("G/L Budget Filter");
                 //NC NOS-26 > SPA
                 SETRANGE("Corr. Dimension 1 Filter");
                 SETRANGE("Corr. Dimension 2 Filter");
                 SETRANGE("Corr. Dimension 3 Filter");
                 //NC NOS-26 < SPA
                 UpdateDimFilterControls;
                 DateFilter := GETFILTER("Date Filter");
               END;

    OnAfterGetRecord=VAR
                       ColumnNo@1000 : Integer;
                     BEGIN
                       CLEAR(ColumnValues);

                       IF (Totaling = '') OR (NOT TempColumnLayout.FINDSET) THEN
                         EXIT;

                       REPEAT
                         ColumnNo := ColumnNo + 1;
                         IF (ColumnNo > ColumnOffset) AND (ColumnNo - ColumnOffset <= ARRAYLEN(ColumnValues)) THEN BEGIN
                           ColumnValues[ColumnNo - ColumnOffset] :=
                             RoundNone(
                               MatrixMgt.RoundValue(
                                 AccSchedManagement.CalcCell(Rec,TempColumnLayout,UseAmtsInAddCurr,FALSE,0),
                                 TempColumnLayout."Rounding Factor"),
                               TempColumnLayout."Rounding Factor");
                           ColumnLayoutArr[ColumnNo - ColumnOffset] := TempColumnLayout;
                           GetStyle(ColumnNo - ColumnOffset,"Line No.",TempColumnLayout."Line No.");
                         END;
                       UNTIL TempColumnLayout.NEXT = 0;
                       AccSchedManagement.ForceRecalculate(FALSE);
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 28      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 RUS=Ф&ункции];
                      Image=Action }
      { 40      ;1   ;Action    ;
                      Name=Print;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Print;
                                 RUS=Печать];
                      ToolTipML=[ENU=Print the information in the window. A print request window opens where you can specify what to include on the print-out.;
                                 RUS=Печать сведений в окне. Открывается окно запроса печати, где вы можете указать, какая информация должна выводиться на печать.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Print;
                      OnAction=VAR
                                 AccSched@1000 : Report 25;
                                 DateFilter2@1002 : Text;
                                 GLBudgetFilter2@1003 : Text;
                                 BusUnitFilter@1004 : Text;
                                 CostBudgetFilter2@1005 : Text;
                               BEGIN
                                 AccSched.SetAccSchedName(CurrentSchedName);
                                 AccSched.SetColumnLayoutName(CurrentColumnName);
                                 DateFilter2 := GETFILTER("Date Filter");
                                 GLBudgetFilter2 := GETFILTER("G/L Budget Filter");
                                 CostBudgetFilter2 := GETFILTER("Cost Budget Filter");
                                 BusUnitFilter := GETFILTER("Business Unit Filter");
                                 AccSched.SetFilters(DateFilter2,GLBudgetFilter2,CostBudgetFilter2,BusUnitFilter,Dim1Filter,Dim2Filter,Dim3Filter,Dim4Filter,FALSE);
                                 AccSched.RUN;
                               END;
                                }
      { 2       ;1   ;Action    ;
                      Name=PreviousColumn;
                      CaptionML=[ENU=Previous Column;
                                 RUS=Пред. столбец];
                      ToolTipML=[ENU=Go to the previous column.;
                                 RUS=Переход к предыдущему столбцу.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PreviousRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 AdjustColumnOffset(-1);
                               END;
                                }
      { 27      ;1   ;Action    ;
                      Name=NextPeriod;
                      CaptionML=[ENU=Next Period;
                                 RUS=Следующий период];
                      ToolTipML=[ENU=Show the information based on the next period. If you set the View by field to Day, the date filter changes to the day before.;
                                 RUS=Отображение информации на основании следующего периода. Если в поле "Просмотр по" выбрано значение "День", в фильтр дат подставляется предыдущий день.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=NextRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 AccSchedManagement.FindPeriod(Rec,'>=',PeriodType);
                                 DateFilter := GETFILTER("Date Filter");
                               END;
                                }
      { 26      ;1   ;Action    ;
                      Name=PreviousPeriod;
                      CaptionML=[ENU=Previous Period;
                                 RUS=Предыдущий период];
                      ToolTipML=[ENU=Show the information based on the previous period. If you set the View by field to Day, the date filter changes to the day before.;
                                 RUS=Отображение информации на основании предыдущего периода. Если в поле "Просмотр по" выбрано значение "День", в фильтр дат подставляется предыдущий день.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=PreviousRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 AccSchedManagement.FindPeriod(Rec,'<=',PeriodType);
                                 DateFilter := GETFILTER("Date Filter");
                               END;
                                }
      { 1       ;1   ;Action    ;
                      Name=NextColumn;
                      CaptionML=[ENU=Next Column;
                                 RUS=След. столбец];
                      ToolTipML=[ENU=Show the account schedule based on the next column.;
                                 RUS=Отображение финансового отчета на основании следующего столбца.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NextRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 AdjustColumnOffset(1);
                               END;
                                }
      { 14      ;1   ;Action    ;
                      Name=Recalculate;
                      CaptionML=[ENU=Recalculate;
                                 RUS=Пересчитать];
                      ToolTipML=[ENU=Update the account schedule overview based on recent changes.;
                                 RUS=Обновление обзора финансового отчета на основании последних изменений.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Refresh;
                      OnAction=BEGIN
                                 AccSchedManagement.ForceRecalculate(TRUE);
                               END;
                                }
      { 11      ;1   ;ActionGroup;
                      CaptionML=[ENU=Excel;
                                 RUS=Excel] }
      { 41      ;2   ;ActionGroup;
                      CaptionML=[ENU=Export to Excel;
                                 RUS=Экспорт в Excel];
                      Image=ExportToExcel }
      { 292     ;3   ;Action    ;
                      CaptionML=[ENU=Create New Document;
                                 RUS=Создать новый документ];
                      ToolTipML=[ENU=Open the account schedule overview in a new Excel workbook. This creates an Excel workbook on your device.;
                                 RUS=Открытие обзора финансового отчета в новой книге Excel. На вашем устройстве будет создана книга Excel.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ExportToExcel;
                      OnAction=VAR
                                 ExportAccSchedToExcel@1001 : Report 29;
                               BEGIN
                                 ExportAccSchedToExcel.SetOptions(Rec,CurrentColumnName,UseAmtsInAddCurr);
                                 ExportAccSchedToExcel.RUN;
                               END;
                                }
      { 13      ;3   ;Action    ;
                      CaptionML=[ENU=Update Existing Document;
                                 RUS=Обновить существующий документ];
                      ToolTipML=[ENU=Refresh the data in an existing Excel workbook. You must specify the workbook that you want to update.;
                                 RUS=Обновление данных в имеющейся книге Excel. Вы должны указать книгу, требующую обновления.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ExportToExcel;
                      OnAction=VAR
                                 ExportAccSchedToExcel@1000 : Report 29;
                               BEGIN
                                 ExportAccSchedToExcel.SetOptions(Rec,CurrentColumnName,UseAmtsInAddCurr);
                                 ExportAccSchedToExcel.SetUpdateExistingWorksheet(TRUE);
                                 ExportAccSchedToExcel.RUN;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 8   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           RUS=Общее] }

    { 10  ;2   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Account Schedule Name;
                           RUS=Название фин. отчета];
                ToolTipML=[ENU=Specifies the name of the account schedule to be shown in the window.;
                           RUS=Определяет название финансового отчета, который должен быть показан в окне.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=CurrentSchedName;
                Importance=Promoted;
                LookupPageID=Account Schedule Names;
                OnValidate=BEGIN
                             AccSchedManagement.CheckName(CurrentSchedName);
                             CurrentSchedNameOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           EXIT(AccSchedManagement.LookupName(CurrentSchedName,Text));
                         END;
                          }

    { 12  ;2   ;Field     ;
                Lookup=Yes;
                CaptionML=[ENU=Column Layout Name;
                           RUS=Название раскладки столбцов];
                ToolTipML=[ENU=Specifies the name of the column layout that you want to use in the window.;
                           RUS=Определяет название раскладки столбцов для использования в окне.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=CurrentColumnName;
                TableRelation="Column Layout Name".Name;
                OnValidate=BEGIN
                             AccSchedManagement.CheckColumnName(CurrentColumnName);
                             CurrentColumnNameOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           EXIT(AccSchedManagement.LookupColumnName(CurrentColumnName,Text));
                         END;
                          }

    { 44  ;2   ;Field     ;
                CaptionML=[ENU=Show Amounts in Add. Reporting Currency;
                           RUS=Показать суммы в ДОВ];
                ToolTipML=[ENU=Specifies that the Account Schedule Overview window shows amounts in the additional reporting currency.;
                           RUS=Указывает, что в окне "Фин. отчет по ликвидности - обзор" отображаются суммы в дополнительной отчетной валюте.];
                ApplicationArea=#Suite;
                SourceExpr=UseAmtsInAddCurr;
                Visible=UseAmtsInAddCurrVisible;
                MultiLine=Yes;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;
                            }

    { 42  ;2   ;Field     ;
                CaptionML=[ENU=View by;
                           RUS=Просмотр по];
                ToolTipML=[ENU=Specifies by which period amounts are displayed.;
                           RUS=Определяет период, суммы за который должны отображаться.];
                OptionCaptionML=[ENU=Day,Week,Month,Quarter,Year,Accounting Period;
                                 RUS=День,Неделя,Месяц,Квартал,Год,Учетный период];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=PeriodType;
                Importance=Promoted;
                OnValidate=BEGIN
                             AccSchedManagement.FindPeriod(Rec,'',PeriodType);
                             DateFilter := GETFILTER("Date Filter");
                             CurrPage.UPDATE;
                           END;
                            }

    { 7   ;2   ;Field     ;
                Name=DateFilter;
                CaptionML=[ENU=Date Filter;
                           RUS=Фильтр по дате];
                ToolTipML=[ENU=Specifies the dates that will be used to filter the amounts in the window.;
                           RUS=Определяет даты, которые будут использоваться для фильтрации сумм в окне.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=DateFilter;
                Importance=Promoted;
                OnValidate=VAR
                             ApplicationManagement@1002 : Codeunit 1;
                           BEGIN
                             IF ApplicationManagement.MakeDateFilter(DateFilter) = 0 THEN;
                             SETFILTER("Date Filter",DateFilter);
                             DateFilter := GETFILTER("Date Filter");
                             CurrPage.UPDATE;
                           END;
                            }

    { 1900242701;1;Group  ;
                CaptionML=[ENU=Dimension Filters;
                           RUS=Фильтры измерения] }

    { 37  ;2   ;Field     ;
                Name=Dim1Filter;
                CaptionML=[ENU=Dimension 1 Filter;
                           RUS=Фильтр измерения 1];
                ToolTipML=[ENU=Specifies a filter for the Dimension 1 for which entries will be shown in the matrix window.;
                           RUS=Определяет фильтр для измерения 1, операции по которому будут отображаться в окне матрицы.];
                ApplicationArea=#Suite;
                SourceExpr=Dim1Filter;
                CaptionClass=FormGetCaptionClass(1);
                Importance=Promoted;
                Visible=Dim1FilterEnable;
                Enabled=Dim1FilterEnable;
                OnValidate=BEGIN
                             SetDimFilters(1,Dim1Filter);
                           END;

                OnLookup=VAR
                           DimValue@1000 : Record 349;
                         BEGIN
                           //NC NOS-26 > SPA
                           IF AccSchedName."G/L Corr. Analysis View Name" <> '' THEN
                             EXIT(DimValue.LookUpDimFilter(GLCorrAnalysisView."Debit Dimension 1 Code",Text))
                           ELSE
                           //NC NOS-26 < SPA
                           EXIT(DimValue.LookUpDimFilter(AnalysisView."Dimension 1 Code",Text));
                         END;
                          }

    { 36  ;2   ;Field     ;
                Name=Dim2Filter;
                CaptionML=[ENU=Dimension 2 Filter;
                           RUS=Фильтр измерения 2];
                ToolTipML=[ENU=Specifies a filter for the Dimension 2 for which entries will be shown in the matrix window.;
                           RUS=Определяет фильтр для измерения 2, операции по которому будут отображаться в окне матрицы.];
                ApplicationArea=#Suite;
                SourceExpr=Dim2Filter;
                CaptionClass=FormGetCaptionClass(2);
                Importance=Promoted;
                Visible=Dim2FilterEnable;
                Enabled=Dim2FilterEnable;
                OnValidate=BEGIN
                             SetDimFilters(2,Dim2Filter);
                           END;

                OnLookup=VAR
                           DimValue@1000 : Record 349;
                         BEGIN
                           //NC NOS-26 > SPA
                           IF AccSchedName."G/L Corr. Analysis View Name" <> '' THEN
                             EXIT(DimValue.LookUpDimFilter(GLCorrAnalysisView."Debit Dimension 2 Code",Text))
                           ELSE
                           //NC NOS-26 < SPA
                           EXIT(DimValue.LookUpDimFilter(AnalysisView."Dimension 2 Code",Text));
                         END;
                          }

    { 39  ;2   ;Field     ;
                Name=Dim3Filter;
                CaptionML=[ENU=Dimension 3 Filter;
                           RUS=Фильтр измерения 3];
                ToolTipML=[ENU=Specifies a filter for the Dimension 3 for which entries will be shown in the matrix window.;
                           RUS=Определяет фильтр для измерения 3, операции по которому будут отображаться в окне матрицы.];
                ApplicationArea=#Suite;
                SourceExpr=Dim3Filter;
                CaptionClass=FormGetCaptionClass(3);
                Importance=Promoted;
                Visible=Dim3FilterEnable;
                Enabled=Dim3FilterEnable;
                OnValidate=BEGIN
                             SetDimFilters(3,Dim3Filter);
                           END;

                OnLookup=VAR
                           DimValue@1000 : Record 349;
                         BEGIN
                           //NC NOS-26 > SPA
                           IF AccSchedName."G/L Corr. Analysis View Name" <> '' THEN
                             EXIT(DimValue.LookUpDimFilter(GLCorrAnalysisView."Debit Dimension 3 Code",Text))
                           ELSE
                           //NC NOS-26 < SPA
                           EXIT(DimValue.LookUpDimFilter(AnalysisView."Dimension 3 Code",Text));
                         END;
                          }

    { 38  ;2   ;Field     ;
                Name=Dim4Filter;
                CaptionML=[ENU=Dimension 4 Filter;
                           RUS=Фильтр измерения 4];
                ToolTipML=[ENU=Specifies a filter for the Dimension 4 for which entries will be shown in the matrix window.;
                           RUS=Определяет фильтр для измерения 4, операции по которому будут отображаться в окне матрицы.];
                ApplicationArea=#Suite;
                SourceExpr=Dim4Filter;
                CaptionClass=FormGetCaptionClass(4);
                Importance=Promoted;
                Visible=Dim4FilterEnable;
                Enabled=Dim4FilterEnable;
                OnValidate=BEGIN
                             SetDimFilters(4,Dim4Filter);
                           END;

                OnLookup=VAR
                           DimValue@1000 : Record 349;
                         BEGIN
                           EXIT(DimValue.LookUpDimFilter(AnalysisView."Dimension 4 Code",Text));
                         END;
                          }

    { 3   ;2   ;Field     ;
                Name=CostCenterFilter;
                CaptionML=[ENU=Cost Center Filter;
                           RUS=Фильтр по центру затрат];
                SourceExpr=CostCenterFilter;
                Importance=Additional;
                OnValidate=BEGIN
                             IF CostCenterFilter = '' THEN
                               SETRANGE("Cost Center Filter")
                             ELSE
                               SETFILTER("Cost Center Filter",CostCenterFilter);
                             CurrPage.UPDATE;
                           END;

                OnLookup=VAR
                           CostCenter@1000 : Record 1112;
                         BEGIN
                           EXIT(CostCenter.LookupCostCenterFilter(Text));
                         END;
                          }

    { 4   ;2   ;Field     ;
                Name=CostObjectFilter;
                CaptionML=[ENU=Cost Object Filter;
                           RUS=Фильтр по объекту затрат];
                SourceExpr=CostObjectFilter;
                Importance=Additional;
                OnValidate=BEGIN
                             IF CostObjectFilter = '' THEN
                               SETRANGE("Cost Object Filter")
                             ELSE
                               SETFILTER("Cost Object Filter",CostObjectFilter);
                             CurrPage.UPDATE;
                           END;

                OnLookup=VAR
                           CostObject@1000 : Record 1113;
                         BEGIN
                           EXIT(CostObject.LookupCostObjectFilter(Text));
                         END;
                          }

    { 5   ;2   ;Field     ;
                Name=CashFlowFilter;
                CaptionML=[ENU=Cash Flow Filter;
                           RUS=Фильтр по движению денежных средств];
                SourceExpr=CashFlowFilter;
                Importance=Additional;
                OnValidate=BEGIN
                             IF CashFlowFilter = '' THEN
                               SETRANGE("Cash Flow Forecast Filter")
                             ELSE
                               SETFILTER("Cash Flow Forecast Filter",CashFlowFilter);
                             CurrPage.UPDATE;
                           END;

                OnLookup=VAR
                           CashFlowForecast@1000 : Record 840;
                         BEGIN
                           EXIT(CashFlowForecast.LookupCashFlowFilter(Text));
                         END;
                          }

    { 6   ;2   ;Field     ;
                Name=G/LBudgetFilter;
                CaptionML=[ENU=G/L Budget Filter;
                           RUS=Фильтр по бюджету ГК];
                ToolTipML=[ENU=Specifies a code for a general ledger budget that the account schedule line will be filtered on.;
                           RUS=Определяет код бюджета главной книги, по которому будет фильтроваться строка финансового отчета.];
                ApplicationArea=#Suite;
                SourceExpr=GLBudgetFilter;
                Importance=Promoted;
                OnValidate=BEGIN
                             IF GLBudgetFilter = '' THEN
                               SETRANGE("G/L Budget Filter")
                             ELSE
                               SETFILTER("G/L Budget Filter",GLBudgetFilter);
                             CurrPage.UPDATE;
                           END;

                OnLookup=VAR
                           Result@1001 : Boolean;
                         BEGIN
                           Result := LookupGLBudgetFilter(Text);
                           IF Result THEN BEGIN
                             SETFILTER("G/L Budget Filter",Text);
                             Text := GETFILTER("G/L Budget Filter");
                           END;
                           EXIT(Result);
                         END;
                          }

    { 9   ;2   ;Field     ;
                Name=CostBudgetFilter;
                CaptionML=[ENU=Cost Budget Filter;
                           RUS=Фильтр по бюджету затрат];
                ToolTipML=[ENU=Specifies a code for a cost budget that the account schedule line will be filtered on.;
                           RUS=Определяет код бюджета затрат, по которому будет фильтроваться строка финансового отчета.];
                SourceExpr=CostBudgetFilter;
                Importance=Additional;
                OnValidate=BEGIN
                             IF CostBudgetFilter = '' THEN
                               SETRANGE("Cost Budget Filter")
                             ELSE
                               SETFILTER("Cost Budget Filter",CostBudgetFilter);
                             CurrPage.UPDATE;
                           END;

                OnLookup=VAR
                           Result@1001 : Boolean;
                         BEGIN
                           Result := LookupCostBudgetFilter(Text);
                           IF Result THEN BEGIN
                             SETFILTER("Cost Budget Filter",Text);
                             Text := GETFILTER("Cost Budget Filter");
                           END;
                           EXIT(Result);
                         END;
                          }

    { 1101495000;2;Field  ;
                Name=CorrDim1Filter;
                CaptionML=[ENU=Corr. Dimension 1 Filter;
                           RUS=Корр. Фильтр измерения 1];
                ApplicationArea=#Suite;
                SourceExpr=CorrDim1Filter;
                CaptionClass=FormGetCaptionClass(12401);
                Importance=Promoted;
                Visible=CorrDim1FilterEnable;
                Enabled=CorrDim1FilterEnable;
                OnValidate=BEGIN
                             //NC NOS-26 > SPA
                             SetDimFilters(12401,Dim4Filter);
                             //NC NOS-26 < SPA
                           END;

                OnLookup=VAR
                           DimValue@1101495000 : Record 349;
                         BEGIN
                           //NC NOS-26 > SPA
                           EXIT(DimValue.LookUpDimFilter(GLCorrAnalysisView."Credit Dimension 1 Code",Text));
                           //NC NOS-26 < SPA
                         END;
                          }

    { 1101495001;2;Field  ;
                Name=CorrDim2Filter;
                CaptionML=[ENU=Corr. Dimension 2 Filter;
                           RUS=Корр. Фильтр измерения 2];
                ApplicationArea=#Suite;
                SourceExpr=CorrDim2Filter;
                CaptionClass=FormGetCaptionClass(12402);
                Importance=Promoted;
                Visible=CorrDim2FilterEnable;
                Enabled=CorrDim2FilterEnable;
                OnValidate=BEGIN
                             //NC NOS-26 > SPA
                             SetDimFilters(12402,Dim4Filter);
                             //NC NOS-26 < SPA
                           END;

                OnLookup=VAR
                           DimValue@1101495000 : Record 349;
                         BEGIN
                           //NC NOS-26 > SPA
                           EXIT(DimValue.LookUpDimFilter(GLCorrAnalysisView."Credit Dimension 2 Code",Text));
                           //NC NOS-26 < SPA
                         END;
                          }

    { 1101495002;2;Field  ;
                Name=CorrDim3Filter;
                CaptionML=[ENU=Corr. Dimension 3 Filter;
                           RUS=Корр. Фильтр измерения 3];
                ApplicationArea=#Suite;
                SourceExpr=CorrDim3Filter;
                CaptionClass=FormGetCaptionClass(12403);
                Importance=Promoted;
                Visible=CorrDim3FilterEnable;
                Enabled=CorrDim3FilterEnable;
                OnValidate=BEGIN
                             //NC NOS-26 > SPA
                             SetDimFilters(12403,Dim4Filter);
                             //NC NOS-26 < SPA
                           END;

                OnLookup=VAR
                           DimValue@1101495000 : Record 349;
                         BEGIN
                           //NC NOS-26 > SPA
                           EXIT(DimValue.LookUpDimFilter(GLCorrAnalysisView."Credit Dimension 3 Code",Text));
                           //NC NOS-26 < SPA
                         END;
                          }

    { 48  ;1   ;Group     ;
                Editable=FALSE;
                IndentationColumnName=Indentation;
                IndentationControls=Description;
                GroupType=Repeater }

    { 49  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a number for the account schedule line.;
                           RUS=Определяет номер строки финансового отчета.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Row No." }

    { 51  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies text that will appear on the account schedule line.;
                           RUS=Определяет текст, который будет отображаться в строке финансового отчета.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Description;
                Style=Strong;
                StyleExpr=Bold }

    { 53  ;2   ;Field     ;
                Name=ColumnValues1;
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=ColumnValues[1];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr(1);
                CaptionClass='3,' + ColumnCaptions[1];
                StyleExpr=ColumnStyle1;
                OnDrillDown=BEGIN
                              DrillDown(1);
                            END;
                             }

    { 59  ;2   ;Field     ;
                Name=ColumnValues2;
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=ColumnValues[2];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr(2);
                CaptionClass='3,' + ColumnCaptions[2];
                Visible=NoOfColumns >= 2;
                StyleExpr=ColumnStyle2;
                OnDrillDown=BEGIN
                              DrillDown(2);
                            END;
                             }

    { 61  ;2   ;Field     ;
                Name=ColumnValues3;
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=ColumnValues[3];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr(3);
                CaptionClass='3,' + ColumnCaptions[3];
                Visible=NoOfColumns >= 3;
                StyleExpr=ColumnStyle3;
                OnDrillDown=BEGIN
                              DrillDown(3);
                            END;
                             }

    { 63  ;2   ;Field     ;
                Name=ColumnValues4;
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=ColumnValues[4];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr(4);
                CaptionClass='3,' + ColumnCaptions[4];
                Visible=NoOfColumns >= 4;
                StyleExpr=ColumnStyle4;
                OnDrillDown=BEGIN
                              DrillDown(4);
                            END;
                             }

    { 65  ;2   ;Field     ;
                Name=ColumnValues5;
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=ColumnValues[5];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr(5);
                CaptionClass='3,' + ColumnCaptions[5];
                Visible=NoOfColumns >= 5;
                StyleExpr=ColumnStyle5;
                OnDrillDown=BEGIN
                              DrillDown(5);
                            END;
                             }

    { 81  ;2   ;Field     ;
                Name=ColumnValues6;
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=ColumnValues[6];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr(6);
                CaptionClass='3,' + ColumnCaptions[6];
                Visible=NoOfColumns >= 6;
                StyleExpr=ColumnStyle6;
                OnDrillDown=BEGIN
                              DrillDown(6);
                            END;
                             }

    { 79  ;2   ;Field     ;
                Name=ColumnValues7;
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=ColumnValues[7];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr(7);
                CaptionClass='3,' + ColumnCaptions[7];
                Visible=NoOfColumns >= 7;
                StyleExpr=ColumnStyle7;
                OnDrillDown=BEGIN
                              DrillDown(7);
                            END;
                             }

    { 77  ;2   ;Field     ;
                Name=ColumnValues8;
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=ColumnValues[8];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr(8);
                CaptionClass='3,' + ColumnCaptions[8];
                Visible=NoOfColumns >= 8;
                StyleExpr=ColumnStyle8;
                OnDrillDown=BEGIN
                              DrillDown(8);
                            END;
                             }

    { 75  ;2   ;Field     ;
                Name=ColumnValues9;
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=ColumnValues[9];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr(9);
                CaptionClass='3,' + ColumnCaptions[9];
                Visible=NoOfColumns >= 9;
                StyleExpr=ColumnStyle9;
                OnDrillDown=BEGIN
                              DrillDown(9);
                            END;
                             }

    { 73  ;2   ;Field     ;
                Name=ColumnValues10;
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=ColumnValues[10];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr(10);
                CaptionClass='3,' + ColumnCaptions[10];
                Visible=NoOfColumns >= 10;
                StyleExpr=ColumnStyle10;
                OnDrillDown=BEGIN
                              DrillDown(10);
                            END;
                             }

    { 71  ;2   ;Field     ;
                Name=ColumnValues11;
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=ColumnValues[11];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr(11);
                CaptionClass='3,' + ColumnCaptions[11];
                Visible=NoOfColumns >= 11;
                StyleExpr=ColumnStyle11;
                OnDrillDown=BEGIN
                              DrillDown(11);
                            END;
                             }

    { 69  ;2   ;Field     ;
                Name=ColumnValues12;
                ApplicationArea=#Basic,#Suite;
                BlankZero=Yes;
                SourceExpr=ColumnValues[12];
                AutoFormatType=10;
                AutoFormatExpr=FormatStr(12);
                CaptionClass='3,' + ColumnCaptions[12];
                Visible=NoOfColumns >= 12;
                StyleExpr=ColumnStyle12;
                OnDrillDown=BEGIN
                              DrillDown(12);
                            END;
                             }

  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=DEFAULT;RUS=СТАНДАРТ';
      Text005@1021 : TextConst 'ENU=1,6,,Dimension %1 Filter;RUS=1,6,,Фильтр измерения %1';
      TempColumnLayout@1004 : TEMPORARY Record 334;
      ColumnLayoutArr@1018 : ARRAY [12] OF Record 334;
      AccSchedName@1005 : Record 84;
      AnalysisView@1020 : Record 363;
      GLSetup@1016 : Record 98;
      AccSchedManagement@1006 : Codeunit 8;
      MatrixMgt@1029 : Codeunit 9200;
      CurrentSchedName@1007 : Code[10];
      CurrentColumnName@1008 : Code[10];
      NewCurrentSchedName@1009 : Code[10];
      NewCurrentColumnName@1010 : Code[10];
      ColumnValues@1012 : ARRAY [12] OF Decimal;
      ColumnCaptions@1017 : ARRAY [12] OF Text[80];
      PeriodType@1013 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      UseAmtsInAddCurrVisible@1032 : Boolean;
      UseAmtsInAddCurr@1014 : Boolean;
      Dim1Filter@1019 : Text;
      Dim2Filter@1022 : Text;
      Dim3Filter@1023 : Text;
      Dim4Filter@1024 : Text;
      CostCenterFilter@1011 : Text;
      CostObjectFilter@1001 : Text;
      CashFlowFilter@1015 : Text;
      NoOfColumns@1030 : Integer;
      ColumnOffset@1025 : Integer;
      Dim1FilterEnable@19054192 : Boolean INDATASET;
      Dim2FilterEnable@19062512 : Boolean INDATASET;
      Dim3FilterEnable@19011605 : Boolean INDATASET;
      Dim4FilterEnable@19064250 : Boolean INDATASET;
      GLBudgetFilter@1026 : Text;
      CostBudgetFilter@1027 : Text;
      DateFilter@1028 : Text;
      ModifiedPeriodType@1002 : Option;
      NewPeriodTypeSet@1003 : Boolean;
      ColumnStyle1@1031 : Text INDATASET;
      ColumnStyle2@1043 : Text INDATASET;
      ColumnStyle3@1042 : Text INDATASET;
      ColumnStyle4@1041 : Text INDATASET;
      ColumnStyle5@1040 : Text INDATASET;
      ColumnStyle6@1039 : Text INDATASET;
      ColumnStyle7@1038 : Text INDATASET;
      ColumnStyle8@1037 : Text INDATASET;
      ColumnStyle9@1036 : Text INDATASET;
      ColumnStyle10@1035 : Text INDATASET;
      ColumnStyle11@1034 : Text INDATASET;
      ColumnStyle12@1033 : Text INDATASET;
      "//NCV"@1101495000 : Integer;
      CorrDim1Filter@1101495005 : Text;
      CorrDim2Filter@1101495006 : Text;
      CorrDim3Filter@1101495007 : Text;
      CorrDim1FilterEnable@1101495003 : Boolean INDATASET;
      CorrDim2FilterEnable@1101495002 : Boolean INDATASET;
      CorrDim3FilterEnable@1101495001 : Boolean INDATASET;
      GLCorrAnalysisView@1101495004 : Record 14940;
      Text50001@1101495013 : TextConst 'ENU=1,6,,Debit Dimension 1 Filter;RUS=1,6,,Дебет Измерение 1 Фильтр';
      Text50002@1101495012 : TextConst 'ENU=1,6,,Debit Dimension 2 Filter;RUS=1,6,,Дебет Измерение 2 Фильтр';
      Text50003@1101495011 : TextConst 'ENU=1,6,,Debit Dimension 3 Filter;RUS=1,6,,Дебет Измерение 3 Фильтр';
      Text50011@1101495010 : TextConst 'ENU=1,6,,Credit Dimension 1 Filter;RUS=1,6,,Кредит Измерение 1 Корр. Фильтр';
      Text50012@1101495009 : TextConst 'ENU=1,6,,Credit Dimension 2 Filter;RUS=1,6,,Кредит Измерение 2 Корр. Фильтр';
      Text50013@1101495008 : TextConst 'ENU=1,6,,Credit Dimension 3 Filter;RUS=1,6,,Кредит Измерение 3 Корр. Фильтр';

    PROCEDURE SetAccSchedName@6(NewAccSchedName@1000 : Code[10]);
    VAR
      AccSchedName@1001 : Record 84;
    BEGIN
      NewCurrentSchedName := NewAccSchedName;
      IF AccSchedName.GET(NewCurrentSchedName) THEN
        IF AccSchedName."Default Column Layout" <> '' THEN
          NewCurrentColumnName := AccSchedName."Default Column Layout";
    END;

    PROCEDURE SetPeriodType@1(NewPeriodType@1000 : Option);
    BEGIN
      ModifiedPeriodType := NewPeriodType;
      NewPeriodTypeSet := TRUE;
    END;

    LOCAL PROCEDURE SetDimFilters@2(DimNo@1000 : Integer;DimValueFilter@1001 : Text);
    BEGIN
      //NC NOS-26 > SPA
      IF AccSchedName."G/L Corr. Analysis View Name" <> '' THEN BEGIN
        CASE DimNo OF
          1:
            IF DimValueFilter = '' THEN
              SETRANGE("Dimension 1 Filter")
            ELSE BEGIN
              GetDimValueTotaling(DimValueFilter,GLCorrAnalysisView."Debit Dimension 1 Code");
              SETFILTER("Dimension 1 Filter",DimValueFilter);
            END;
          2:
            IF DimValueFilter = '' THEN
              SETRANGE("Dimension 2 Filter")
            ELSE BEGIN
              GetDimValueTotaling(DimValueFilter,GLCorrAnalysisView."Debit Dimension 2 Code");
              SETFILTER("Dimension 2 Filter",DimValueFilter);
            END;
          3:
            IF DimValueFilter = '' THEN
              SETRANGE("Dimension 3 Filter")
            ELSE BEGIN
              GetDimValueTotaling(DimValueFilter,GLCorrAnalysisView."Debit Dimension 3 Code");
              SETFILTER("Dimension 3 Filter",DimValueFilter);
            END;
          4:;
          12401:
            IF DimValueFilter = '' THEN
              SETRANGE("Corr. Dimension 1 Filter")
            ELSE BEGIN
              GetDimValueTotaling(DimValueFilter,GLCorrAnalysisView."Credit Dimension 1 Code");
              SETFILTER("Corr. Dimension 1 Filter",DimValueFilter);
            END;
          12402:
            IF DimValueFilter = '' THEN
              SETRANGE("Corr. Dimension 2 Filter")
            ELSE BEGIN
              GetDimValueTotaling(DimValueFilter,GLCorrAnalysisView."Credit Dimension 2 Code");
              SETFILTER("Corr. Dimension 2 Filter",DimValueFilter);
            END;
          12403:
            IF DimValueFilter = '' THEN
              SETRANGE("Corr. Dimension 3 Filter")
            ELSE BEGIN
              GetDimValueTotaling(DimValueFilter,GLCorrAnalysisView."Credit Dimension 3 Code");
              SETFILTER("Corr. Dimension 3 Filter",DimValueFilter);
            END;
        END;
        CurrPage.UPDATE;
        EXIT;
      END;
      //NC NOS-26 < SPA

      CASE DimNo OF
        1:
          IF DimValueFilter = '' THEN
            SETRANGE("Dimension 1 Filter")
          ELSE BEGIN
            GetDimValueTotaling(DimValueFilter,AnalysisView."Dimension 1 Code");
            SETFILTER("Dimension 1 Filter",DimValueFilter);
          END;
        2:
          IF DimValueFilter = '' THEN
            SETRANGE("Dimension 2 Filter")
          ELSE BEGIN
            GetDimValueTotaling(DimValueFilter,AnalysisView."Dimension 2 Code");
            SETFILTER("Dimension 2 Filter",DimValueFilter);
          END;
        3:
          IF DimValueFilter = '' THEN
            SETRANGE("Dimension 3 Filter")
          ELSE BEGIN
            GetDimValueTotaling(DimValueFilter,AnalysisView."Dimension 3 Code");
            SETFILTER("Dimension 3 Filter",DimValueFilter);
          END;
        4:
          IF DimValueFilter = '' THEN
            SETRANGE("Dimension 4 Filter")
          ELSE BEGIN
            GetDimValueTotaling(DimValueFilter,AnalysisView."Dimension 4 Code");
            SETFILTER("Dimension 4 Filter",DimValueFilter);
          END;
      END;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE GetDimValueTotaling@3(VAR DimValueFilter@1002 : Text;DimensionCode@1000 : Code[20]);
    VAR
      DimensionValue@1001 : Record 349;
    BEGIN
      IF DimensionCode <> '' THEN BEGIN
        DimensionValue.SETRANGE("Dimension Code",DimensionCode);
        DimensionValue.SETFILTER(Code,DimValueFilter);
        IF DimensionValue.FINDFIRST THEN
          IF DimensionValue.Totaling <> '' THEN
            DimValueFilter := DimensionValue.Totaling;
      END;
    END;

    LOCAL PROCEDURE FormGetCaptionClass@12(DimNo@1000 : Integer) : Text[250];
    BEGIN
      //NC NCS-1631 > DP
      IF AccSchedName."G/L Corr. Analysis View Name" <> '' THEN
        CASE DimNo OF
        1:
          BEGIN
            IF GLCorrAnalysisView."Debit Dimension 1 Code" <> '' THEN
              EXIT('1,6,' + GLCorrAnalysisView."Debit Dimension 1 Code");

            EXIT(Text50001);
          END;
        2:
          BEGIN
            IF GLCorrAnalysisView."Debit Dimension 2 Code" <> '' THEN
              EXIT('1,6,' + GLCorrAnalysisView."Debit Dimension 2 Code");

            EXIT(Text50002);
          END;
        3:
          BEGIN
            IF GLCorrAnalysisView."Debit Dimension 3 Code" <> '' THEN
              EXIT('1,6,' + GLCorrAnalysisView."Debit Dimension 3 Code");

            EXIT(Text50003);
          END;
        4:
          BEGIN
            IF AnalysisView."Dimension 4 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 4 Code");

            EXIT(STRSUBSTNO(Text005,DimNo));
          END;
        12401:
          BEGIN
            IF GLCorrAnalysisView."Credit Dimension 1 Code" <> '' THEN
              EXIT('1,6,' + GLCorrAnalysisView."Credit Dimension 1 Code");

            EXIT(Text50011);
          END;
        12402:
          BEGIN
            IF GLCorrAnalysisView."Credit Dimension 2 Code" <> '' THEN
              EXIT('1,6,' + GLCorrAnalysisView."Credit Dimension 2 Code");

            EXIT(Text50012);
          END;
        12403:
          BEGIN
            IF GLCorrAnalysisView."Credit Dimension 3 Code" <> '' THEN
              EXIT('1,6,' + GLCorrAnalysisView."Credit Dimension 3 Code");

            EXIT(Text50013);
          END;
        END;
      //NC NCS-1631 < DP

      CASE DimNo OF
        1:
          BEGIN
            IF AnalysisView."Dimension 1 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 1 Code");

            EXIT(STRSUBSTNO(Text005,DimNo));
          END;
        2:
          BEGIN
            IF AnalysisView."Dimension 2 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 2 Code");

            EXIT(STRSUBSTNO(Text005,DimNo));
          END;
        3:
          BEGIN
            IF AnalysisView."Dimension 3 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 3 Code");

            EXIT(STRSUBSTNO(Text005,DimNo));
          END;
        4:
          BEGIN
            IF AnalysisView."Dimension 4 Code" <> '' THEN
              EXIT('1,6,' + AnalysisView."Dimension 4 Code");

            EXIT(STRSUBSTNO(Text005,DimNo));
          END;
        5:
          EXIT(FIELDCAPTION("Date Filter"));
        6:
          EXIT(FIELDCAPTION("Cash Flow Forecast Filter"));
        //NC NOS-26 > SPA
        12401:
          EXIT(Text50011);
        12402:
          EXIT(Text50012);
        12403:
          EXIT(Text50013);
        //NC NOS-26 < SPA
      END;
    END;

    LOCAL PROCEDURE DrillDown@5(ColumnNo@1003 : Integer);
    BEGIN
      TempColumnLayout := ColumnLayoutArr[ColumnNo];
      //NC NOS-26 > SPA
      IF "Column Ledger Entry Type" <> "Column Ledger Entry Type"::" " THEN
        TempColumnLayout."Ledger Entry Type" := "Column Ledger Entry Type";
      //NC NOS-26 < SPA
      AccSchedManagement.DrillDownFromOverviewPage(TempColumnLayout,Rec,PeriodType);
    END;

    LOCAL PROCEDURE UpdateColumnCaptions@19();
    VAR
      ColumnNo@1000 : Integer;
      i@1001 : Integer;
    BEGIN
      CLEAR(ColumnCaptions);
      IF TempColumnLayout.FINDSET THEN
        REPEAT
          ColumnNo := ColumnNo + 1;
          IF (ColumnNo > ColumnOffset) AND (ColumnNo - ColumnOffset <= ARRAYLEN(ColumnCaptions)) THEN
            ColumnCaptions[ColumnNo - ColumnOffset] := TempColumnLayout."Column Header";
        UNTIL (ColumnNo - ColumnOffset = ARRAYLEN(ColumnCaptions)) OR (TempColumnLayout.NEXT = 0);
      // Set unused columns to blank to prevent RTC to display control ID as caption
      FOR i := ColumnNo - ColumnOffset + 1 TO ARRAYLEN(ColumnCaptions) DO
        ColumnCaptions[i] := ' ';
      NoOfColumns := ColumnNo;
    END;

    LOCAL PROCEDURE AdjustColumnOffset@18(Delta@1000 : Integer);
    VAR
      OldColumnOffset@1001 : Integer;
    BEGIN
      OldColumnOffset := ColumnOffset;
      ColumnOffset := ColumnOffset + Delta;
      IF ColumnOffset + 12 > TempColumnLayout.COUNT THEN
        ColumnOffset := TempColumnLayout.COUNT - 12;
      IF ColumnOffset < 0 THEN
        ColumnOffset := 0;
      IF ColumnOffset <> OldColumnOffset THEN BEGIN
        UpdateColumnCaptions;
        CurrPage.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE UpdateDimFilterControls@4();
    BEGIN
      Dim1Filter := GETFILTER("Dimension 1 Filter");
      Dim2Filter := GETFILTER("Dimension 2 Filter");
      Dim3Filter := GETFILTER("Dimension 3 Filter");
      Dim4Filter := GETFILTER("Dimension 4 Filter");
      //NC NOS-26 > SPA
      CorrDim1Filter := GETFILTER("Corr. Dimension 1 Filter");
      CorrDim2Filter := GETFILTER("Corr. Dimension 2 Filter");
      CorrDim3Filter := GETFILTER("Corr. Dimension 3 Filter");
      //NC NOS-26 < SPA
      CostCenterFilter := '';
      CostObjectFilter := '';
      CashFlowFilter := '';
      Dim1FilterEnable := AnalysisView."Dimension 1 Code" <> '';
      Dim2FilterEnable := AnalysisView."Dimension 2 Code" <> '';
      Dim3FilterEnable := AnalysisView."Dimension 3 Code" <> '';
      Dim4FilterEnable := AnalysisView."Dimension 4 Code" <> '';

      //NC NCS-1631 > DP
      IF AccSchedName."G/L Corr. Analysis View Name"<>'' THEN BEGIN
        Dim1FilterEnable := GLCorrAnalysisView."Debit Dimension 1 Code" <> '';
        Dim2FilterEnable := GLCorrAnalysisView."Debit Dimension 2 Code" <> '';
        Dim3FilterEnable := GLCorrAnalysisView."Debit Dimension 3 Code" <> '';
        CorrDim1FilterEnable := GLCorrAnalysisView."Credit Dimension 1 Code" <> '';
        CorrDim2FilterEnable := GLCorrAnalysisView."Credit Dimension 2 Code" <> '';
        CorrDim3FilterEnable := GLCorrAnalysisView."Credit Dimension 3 Code" <> '';
      END;
      //NC NCS-1631 < DP
      GLBudgetFilter := '';
      CostBudgetFilter := '';
    END;

    LOCAL PROCEDURE CurrentSchedNameOnAfterValidate@19053875();
    VAR
      AccSchedName@1001 : Record 84;
      PrevAnalysisView@1002 : Record 363;
      PrevGLCorrAnalysisView@1101495000 : Record 14940;
    BEGIN
      CurrPage.SAVERECORD;
      AccSchedManagement.SetName(CurrentSchedName,Rec);
      IF AccSchedName.GET(CurrentSchedName) THEN
        IF (AccSchedName."Default Column Layout" <> '') AND
           (CurrentColumnName <> AccSchedName."Default Column Layout")
        THEN BEGIN
          CurrentColumnName := AccSchedName."Default Column Layout";
          AccSchedManagement.CopyColumnsToTemp(CurrentColumnName,TempColumnLayout);
          AccSchedManagement.SetColumnName(CurrentColumnName,TempColumnLayout);
        END;
      AccSchedManagement.CheckAnalysisView(CurrentSchedName,CurrentColumnName,TRUE);

      IF AccSchedName."Analysis View Name" <> AnalysisView.Code THEN BEGIN
        PrevAnalysisView := AnalysisView;
        //NC NOS-26 > SPA
        PrevGLCorrAnalysisView := GLCorrAnalysisView;
        //NC NOS-26 < SPA
        IF AccSchedName."Analysis View Name" <> '' THEN
          AnalysisView.GET(AccSchedName."Analysis View Name")
        //NC NOS-26 > SPA
        ELSE IF AccSchedName."G/L Corr. Analysis View Name" <> '' THEN
          GLCorrAnalysisView.GET(AccSchedName."G/L Corr. Analysis View Name")
        //NC NOS-26 < SPA
        ELSE BEGIN
          CLEAR(AnalysisView);
          AnalysisView."Dimension 1 Code" := GLSetup."Global Dimension 1 Code";
          AnalysisView."Dimension 2 Code" := GLSetup."Global Dimension 2 Code";
          //NC NOS-26 > SPA
          CLEAR(GLCorrAnalysisView);
          GLCorrAnalysisView."Credit Dimension 1 Code" := GLSetup."Global Dimension 1 Code";
          GLCorrAnalysisView."Credit Dimension 2 Code" := GLSetup."Global Dimension 2 Code";
          //NC NOS-26 < SPA
        END;
        IF PrevAnalysisView."Dimension 1 Code" <> AnalysisView."Dimension 1 Code" THEN
          SETRANGE("Dimension 1 Filter");
        IF PrevAnalysisView."Dimension 2 Code" <> AnalysisView."Dimension 2 Code" THEN
          SETRANGE("Dimension 2 Filter");
        IF PrevAnalysisView."Dimension 3 Code" <> AnalysisView."Dimension 3 Code" THEN
          SETRANGE("Dimension 3 Filter");
        IF PrevAnalysisView."Dimension 4 Code" <> AnalysisView."Dimension 4 Code" THEN
          SETRANGE("Dimension 4 Filter");

        //NC NOS-26 > SPA
        IF GLCorrAnalysisView.Code <> '' THEN BEGIN
          IF PrevGLCorrAnalysisView."Debit Dimension 1 Code" <> GLCorrAnalysisView."Debit Dimension 1 Code" THEN
            SETRANGE("Dimension 1 Filter");
          IF PrevGLCorrAnalysisView."Debit Dimension 2 Code" <> GLCorrAnalysisView."Debit Dimension 2 Code" THEN
            SETRANGE("Dimension 2 Filter");
          IF PrevGLCorrAnalysisView."Debit Dimension 3 Code" <> GLCorrAnalysisView."Debit Dimension 3 Code" THEN
            SETRANGE("Dimension 3 Filter");
          IF PrevGLCorrAnalysisView."Credit Dimension 1 Code" <> GLCorrAnalysisView."Credit Dimension 1 Code" THEN
            SETRANGE("Corr. Dimension 1 Filter");
          IF PrevGLCorrAnalysisView."Credit Dimension 2 Code" <> GLCorrAnalysisView."Credit Dimension 2 Code" THEN
            SETRANGE("Corr. Dimension 2 Filter");
          IF PrevGLCorrAnalysisView."Credit Dimension 3 Code" <> GLCorrAnalysisView."Credit Dimension 3 Code" THEN
            SETRANGE("Corr. Dimension 3 Filter");
        END;
        //NC NOS-26 < SPA
      END;
      UpdateDimFilterControls;

      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE CurrentColumnNameOnAfterValidate@19064415();
    BEGIN
      AccSchedManagement.CopyColumnsToTemp(CurrentColumnName,TempColumnLayout);
      AccSchedManagement.SetColumnName(CurrentColumnName,TempColumnLayout);
      AccSchedManagement.CheckAnalysisView(CurrentSchedName,CurrentColumnName,TRUE);
      UpdateColumnCaptions;
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE FormatStr@8(ColumnNo@1000 : Integer) : Text;
    BEGIN
      EXIT(MatrixMgt.GetFormatString(ColumnLayoutArr[ColumnNo]."Rounding Factor",UseAmtsInAddCurr));
    END;

    PROCEDURE RoundNone@9(Value@1000 : Decimal;RoundingFactor@1002 : 'None,1,1000,1000000') : Decimal;
    BEGIN
      IF RoundingFactor <> RoundingFactor::None THEN
        EXIT(Value);

      EXIT(ROUND(Value));
    END;

    LOCAL PROCEDURE GetStyle@7(ColumnNo@1000 : Integer;RowLineNo@1001 : Integer;ColumnLineNo@1003 : Integer);
    VAR
      ColumnStyle@1005 : Text;
      ErrorType@1004 : 'None,Division by Zero,Period Error,Both';
    BEGIN
      AccSchedManagement.CalcFieldError(ErrorType,RowLineNo,ColumnLineNo);
      IF ErrorType > ErrorType::None THEN
        ColumnStyle := 'Unfavorable'
      ELSE
        IF Bold THEN
          ColumnStyle := 'Strong'
        ELSE
          ColumnStyle := 'Standard';

      CASE ColumnNo OF
        1:
          ColumnStyle1 := ColumnStyle;
        2:
          ColumnStyle2 := ColumnStyle;
        3:
          ColumnStyle3 := ColumnStyle;
        4:
          ColumnStyle4 := ColumnStyle;
        5:
          ColumnStyle5 := ColumnStyle;
        6:
          ColumnStyle6 := ColumnStyle;
        7:
          ColumnStyle7 := ColumnStyle;
        8:
          ColumnStyle8 := ColumnStyle;
        9:
          ColumnStyle9 := ColumnStyle;
        10:
          ColumnStyle10 := ColumnStyle;
        11:
          ColumnStyle11 := ColumnStyle;
        12:
          ColumnStyle12 := ColumnStyle;
      END;
    END;

    BEGIN
    END.
  }
}

