OBJECT Page 5052 Contact List
{
  OBJECT-PROPERTIES
  {
    Date=25.10.16;
    Time=12:00:00;
    Version List=NAVW110.00;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Contact List;
               RUS=Список контактов];
    SourceTable=Table5050;
    SourceTableView=SORTING(Company Name,Company No.,Type,Name);
    DataCaptionFields=Company No.;
    PageType=List;
    CardPageID=Contact Card;
    OnInit=BEGIN
             ActionVisible := CURRENTCLIENTTYPE = CLIENTTYPE::Windows;
           END;

    OnOpenPage=VAR
                 CRMIntegrationManagement@1000 : Codeunit 5330;
               BEGIN
                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;
               END;

    OnAfterGetRecord=VAR
                       CRMCouplingManagement@1001 : Codeunit 5331;
                     BEGIN
                       EnableFields;
                       StyleIsStrong := Type = Type::Company;

                       IF CRMIntegrationEnabled THEN
                         CRMIsCoupledToRecord := CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[ENU=C&ontact;
                                 RUS=К&онтакт];
                      Image=ContactPerson }
      { 34      ;2   ;ActionGroup;
                      CaptionML=[ENU=Comp&any;
                                 RUS=Орг&анизация];
                      Enabled=CompanyGroupEnabled;
                      Image=Company }
      { 35      ;3   ;Action    ;
                      CaptionML=[ENU=Business Relations;
                                 RUS=Деловые отношения];
                      ToolTipML=[ENU=View or edit the contact's business relations, such as customers, vendors, banks, lawyers, consultants, competitors, and so on.;
                                 RUS=Просмотр или изменение деловых отношений контакта, таких как клиенты, поставщики, банки, юристы, консультанты, конкуренты и т. д.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5061;
                      RunPageLink=Contact No.=FIELD(Company No.);
                      Image=BusinessRelation }
      { 36      ;3   ;Action    ;
                      CaptionML=[ENU=Industry Groups;
                                 RUS=Отраслевые группы];
                      ToolTipML=[ENU=View or edit the industry groups, such as Retail or Automobile, that the contact belongs to.;
                                 RUS=Просмотр или изменение отраслевых групп (например, "Розница" или "Автомобили"), к которым принадлежит контакт.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5067;
                      RunPageLink=Contact No.=FIELD(Company No.);
                      Image=IndustryGroups }
      { 37      ;3   ;Action    ;
                      CaptionML=[ENU=Web Sources;
                                 RUS=Веб-источники];
                      ToolTipML=[ENU=View a list of the web sites with information about the contacts.;
                                 RUS=Просмотр списка веб-сайтов с информацией о контактах.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5070;
                      RunPageLink=Contact No.=FIELD(Company No.);
                      Image=Web }
      { 38      ;2   ;ActionGroup;
                      CaptionML=[ENU=P&erson;
                                 RUS=С&отрудник];
                      Enabled=PersonGroupEnabled;
                      Image=User }
      { 39      ;3   ;Action    ;
                      CaptionML=[ENU=Job Responsibilities;
                                 RUS=Должностные обязанности];
                      ToolTipML=[ENU=View or edit the contact's job responsibilities.;
                                 RUS=Просмотр или изменение должностных обязанностей контакта.];
                      ApplicationArea=#RelationshipMgmt;
                      Image=Job;
                      OnAction=VAR
                                 ContJobResp@1001 : Record 5067;
                               BEGIN
                                 TESTFIELD(Type,Type::Person);
                                 ContJobResp.SETRANGE("Contact No.","No.");
                                 PAGE.RUNMODAL(PAGE::"Contact Job Responsibilities",ContJobResp);
                               END;
                                }
      { 41      ;2   ;Action    ;
                      CaptionML=[ENU=Pro&files;
                                 RUS=Проф&или];
                      ToolTipML=[ENU=Open the Profile Questionnaires window.;
                                 RUS=Открытие окна "Анкеты профиля".];
                      ApplicationArea=#RelationshipMgmt;
                      Visible=ActionVisible;
                      Image=Answers;
                      OnAction=VAR
                                 ProfileManagement@1001 : Codeunit 5059;
                               BEGIN
                                 ProfileManagement.ShowContactQuestionnaireCard(Rec,'',0);
                               END;
                                }
      { 43      ;2   ;Action    ;
                      CaptionML=[ENU=&Picture;
                                 RUS=&Изображение];
                      ToolTipML=[ENU=View or add a picture of the contact person, or for example, the company's logo.;
                                 RUS=Просмотр или добавление изображения контактного лица, например логотипа организации.];
                      ApplicationArea=#Suite,#RelationshipMgmt;
                      RunObject=Page 5104;
                      RunPageLink=No.=FIELD(No.);
                      Visible=ActionVisible;
                      Image=Picture }
      { 44      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 RUS=Ко&мментарии];
                      ToolTipML=[ENU=View or add comments.;
                                 RUS=Просмотр или добавление комментариев.];
                      RunObject=Page 5072;
                      RunPageLink=Table Name=CONST(Contact),
                                  No.=FIELD(No.),
                                  Sub No.=CONST(0);
                      Image=ViewComments }
      { 45      ;2   ;ActionGroup;
                      CaptionML=[ENU=Alternati&ve Address;
                                 RUS=Альтернатив&ный адрес];
                      Image=Addresses }
      { 46      ;3   ;Action    ;
                      CaptionML=[ENU=Card;
                                 RUS=Карточка];
                      ToolTipML=[ENU=View or change detailed information about the contact.;
                                 RUS=Просмотр или изменение подробных сведений о контакте.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5057;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=EditLines }
      { 47      ;3   ;Action    ;
                      CaptionML=[ENU=Date Ranges;
                                 RUS=Диапазоны дат];
                      ToolTipML=[ENU=Specify date ranges that apply to the contact's alternate address.;
                                 RUS=Определяет диапазон дат для применения к альтернативному адресу контакта.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5059;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=DateRange }
      { 25      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=[ENU=Dynamics CRM;
                                 RUS=Dynamics CRM];
                      Visible=CRMIntegrationEnabled }
      { 23      ;2   ;Action    ;
                      Name=CRMGotoContact;
                      CaptionML=[ENU=Contact;
                                 RUS=Контакт];
                      ToolTipML=[ENU=Open the coupled Dynamics CRM contact.;
                                 RUS=Открытие связанного контакта Dynamics CRM.];
                      ApplicationArea=#All;
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=CoupledContactPerson;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 27      ;2   ;Action    ;
                      Name=CRMSynchronizeNow;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Synchronize Now;
                                 RUS=Синхронизировать сейчас];
                      ToolTipML=[ENU=Send or get updated data to or from Microsoft Dynamics CRM.;
                                 RUS=Отправка данных в Microsoft Dynamics CRM или получение обновленных данных.];
                      ApplicationArea=#All;
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=Refresh;
                      OnAction=VAR
                                 Contact@1000 : Record 5050;
                                 CRMIntegrationManagement@1001 : Codeunit 5330;
                                 ContactRecordRef@1002 : RecordRef;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Contact);
                                 Contact.NEXT;

                                 IF Contact.COUNT = 1 THEN
                                   CRMIntegrationManagement.UpdateOneNow(Contact.RECORDID)
                                 ELSE BEGIN
                                   ContactRecordRef.GETTABLE(Contact);
                                   CRMIntegrationManagement.UpdateMultipleNow(ContactRecordRef);
                                 END
                               END;
                                }
      { 26      ;2   ;ActionGroup;
                      Name=Coupling;
                      CaptionML=[@@@=Coupling is a noun;
                                 ENU=Coupling;
                                 RUS=Связывание];
                      ToolTipML=[ENU=Create, change, or delete a coupling between the Microsoft Dynamics NAV record and a Microsoft Dynamics CRM record.;
                                 RUS=Создание, изменение или удаление связи между записью Microsoft Dynamics NAV и записью Microsoft Dynamics CRM.];
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=LinkAccount }
      { 21      ;3   ;Action    ;
                      Name=ManageCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Set Up Coupling;
                                 RUS=Настроить связывание];
                      ToolTipML=[ENU=Create or modify the coupling to a Microsoft Dynamics CRM contact.;
                                 RUS=Создание или изменение связи с контактом Microsoft Dynamics CRM.];
                      ApplicationArea=#All;
                      Image=LinkAccount;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.DefineCoupling(RECORDID);
                               END;
                                }
      { 19      ;3   ;Action    ;
                      Name=DeleteCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Delete Coupling;
                                 RUS=Удалить связывание];
                      ToolTipML=[ENU=Delete the coupling to a Microsoft Dynamics CRM contact.;
                                 RUS=Удаление связи с контактом Microsoft Dynamics CRM.];
                      ApplicationArea=#All;
                      Enabled=CRMIsCoupledToRecord;
                      Image=UnLinkAccount;
                      OnAction=VAR
                                 CRMCouplingManagement@1000 : Codeunit 5331;
                               BEGIN
                                 CRMCouplingManagement.RemoveCoupling(RECORDID);
                               END;
                                }
      { 17      ;2   ;ActionGroup;
                      Name=Create;
                      CaptionML=[ENU=Create;
                                 RUS=Создать];
                      Image=NewCustomer }
      { 15      ;3   ;Action    ;
                      Name=CreateInCRM;
                      CaptionML=[ENU=Create Contact in Dynamics CRM;
                                 RUS=Создать контакт в Dynamics CRM];
                      ToolTipML=[ENU=Create a contact in Dynamics CRM that is linked to a contact in your company.;
                                 RUS=Создание в Dynamics CRM контакта, связанного с контактом в вашей организации.];
                      ApplicationArea=#Suite,#RelationshipMgmt;
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=NewCustomer;
                      OnAction=VAR
                                 Contact@1001 : Record 5050;
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                                 ContactRecordRef@1002 : RecordRef;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Contact);
                                 Contact.NEXT;

                                 IF Contact.COUNT = 1 THEN
                                   CRMIntegrationManagement.CreateNewRecordInCRM(RECORDID,FALSE)
                                 ELSE BEGIN
                                   ContactRecordRef.GETTABLE(Contact);
                                   CRMIntegrationManagement.CreateNewRecordsInCRM(ContactRecordRef);
                                 END
                               END;
                                }
      { 13      ;3   ;Action    ;
                      Name=CreateFromCRM;
                      CaptionML=[ENU=Create Contact in Dynamics NAV;
                                 RUS=Создать контакт в Dynamics NAV];
                      ToolTipML=[ENU=Create a contact here in your company that is linked to the Dynamics CRM contact.;
                                 RUS=Создание в вашей организации контакта, связанного с контактом в Dynamics CRM.];
                      ApplicationArea=#Suite,#RelationshipMgmt;
                      Image=NewCustomer;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ManageCreateNewRecordFromCRM(DATABASE::Contact);
                               END;
                                }
      { 5       ;1   ;ActionGroup;
                      CaptionML=[ENU=Related Information;
                                 RUS=Связанные сведения];
                      Image=Users }
      { 33      ;2   ;Action    ;
                      CaptionML=[ENU=Relate&d Contacts;
                                 RUS=Св&язанные контакты];
                      ToolTipML=[ENU=View a list of all contacts.;
                                 RUS=Просмотр списка контактов.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5052;
                      RunPageLink=Company No.=FIELD(Company No.);
                      Image=Users }
      { 55      ;2   ;Action    ;
                      CaptionML=[ENU=Segmen&ts;
                                 RUS=Сегмен&ты];
                      ToolTipML=[ENU=View the segments that are related to the contact.;
                                 RUS=Просмотр сегментов, связанных с контактом.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5150;
                      RunPageView=SORTING(Contact No.,Segment No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=Segment }
      { 40      ;2   ;Action    ;
                      CaptionML=[ENU=Mailing &Groups;
                                 RUS=&Группы рассылки];
                      ToolTipML=[ENU=View or edit the mailing groups that the contact is assigned to, for example, for sending price lists or Christmas cards.;
                                 RUS=Просмотр или изменение групп рассылки, которым назначен контакт, например для рассылки прайс-листов или рождественских открыток.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5064;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=DistributionGroup }
      { 53      ;2   ;Action    ;
                      CaptionML=[ENU=C&ustomer/Vendor/Bank Acc.;
                                 RUS=Счет к&лиента/поставщика/банковский];
                      ToolTipML=[ENU=View the related customer, vendor, or bank account that is associated with the current record.;
                                 RUS=Просмотр клиента, поставщика или банковского счета, связанного с текущей записью.];
                      ApplicationArea=#Basic,#Suite;
                      Image=ContactReference;
                      OnAction=BEGIN
                                 ShowCustVendBank;
                               END;
                                }
      { 7       ;1   ;ActionGroup;
                      CaptionML=[ENU=Tasks;
                                 RUS=Задачи];
                      Image=Task }
      { 50      ;2   ;Action    ;
                      CaptionML=[ENU=T&o-dos;
                                 RUS=Зада&чи];
                      ToolTipML=[ENU=View the list of to-dos.;
                                 RUS=Просмотр списка задач.];
                      RunObject=Page 5096;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                  System To-do Type=FILTER(Contact Attendee);
                      Image=TaskList }
      { 3       ;2   ;Action    ;
                      CaptionML=[ENU=Open Oppo&rtunities;
                                 RUS=Открытые &возможности];
                      ToolTipML=[ENU=View the open sales opportunities that are handled by salespeople for the contact. Opportunities must involve a contact and can be linked to campaigns.;
                                 RUS=Просмотр открытых возможностей продаж, обрабатываемых менеджерами по продажам для контакта. Возможности должны включать контакт и быть связанными с кампаниями.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5123;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                  Status=FILTER(Not Started|In Progress);
                      Promoted=Yes;
                      Image=OpportunityList;
                      PromotedCategory=Process;
                      Scope=Repeater }
      { 76      ;2   ;Action    ;
                      CaptionML=[ENU=Postponed &Interactions;
                                 RUS=Отложенные &взаимодействия];
                      ToolTipML=[ENU=View postponed interactions for the contact.;
                                 RUS=Просмотр отложенных взаимодействий для контакта.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5082;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=PostponedInteractions }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 RUS=Документы];
                      Image=Documents }
      { 68      ;2   ;Action    ;
                      CaptionML=[ENU=Sales &Quotes;
                                 RUS=&Предложения по продаже];
                      ToolTipML=[ENU=View sales quotes that exist for the contact.;
                                 RUS=Просмотр предложений по продаже для контакта.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 9300;
                      RunPageView=SORTING(Document Type,Sell-to Contact No.);
                      RunPageLink=Sell-to Contact No.=FIELD(No.);
                      Image=Quote }
      { 11      ;1   ;ActionGroup;
                      CaptionML=[ENU=History;
                                 RUS=История];
                      Image=History }
      { 67      ;2   ;Action    ;
                      CaptionML=[ENU=Closed Oppo&rtunities;
                                 RUS=Закрытые в&озможности];
                      ToolTipML=[ENU=View the closed sales opportunities that are handled by salespeople for the contact. Opportunities must involve a contact and can be linked to campaigns.;
                                 RUS=Просмотр закрытых возможностей продаж, обрабатываемых менеджерами по продажам для контакта. Возможности должны включать контакт и быть связанными с кампаниями.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5123;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                  Status=FILTER(Won|Lost);
                      Image=OpportunityList }
      { 49      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Interaction Log E&ntries;
                                 RUS=Журналы &взаимодействий];
                      ToolTipML=[ENU=View a list of the interactions that you have logged, for example, when you create an interaction, print a cover sheet, a sales order, and so on.;
                                 RUS=Просмотр списка зафиксированных взаимодействий, например времени создания взаимодействия, печати титульного листа, создания заказа на продажу и т. д.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5076;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=InteractionLog }
      { 42      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 RUS=Статистика];
                      ToolTipML=[ENU=View statistical information, such as the value of posted entries, for the record.;
                                 RUS=Просмотр статистических сведений, например суммы учтенных операций для записи.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5053;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 30      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 RUS=Ф&ункции];
                      Image=Action }
      { 54      ;2   ;Action    ;
                      Name=MakePhoneCall;
                      CaptionML=[ENU=Make &Phone Call;
                                 RUS=&Позвонить];
                      ToolTipML=[ENU=Call the selected contact.;
                                 RUS=Телефонный звонок выбранному контакту.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Image=Calls;
                      PromotedCategory=Process;
                      Scope=Repeater;
                      OnAction=VAR
                                 TAPIManagement@1001 : Codeunit 5053;
                               BEGIN
                                 TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.",GetDefaultPhoneNo,'');
                               END;
                                }
      { 56      ;2   ;Action    ;
                      CaptionML=[ENU=Launch &Web Source;
                                 RUS=Открыть &веб-источник];
                      ToolTipML=[ENU=Search for information about the contact online.;
                                 RUS=Поиск информации о контакте в Интернете.];
                      ApplicationArea=#RelationshipMgmt;
                      Visible=ActionVisible;
                      Image=LaunchWeb;
                      OnAction=VAR
                                 ContactWebSource@1001 : Record 5060;
                               BEGIN
                                 ContactWebSource.SETRANGE("Contact No.","Company No.");
                                 IF PAGE.RUNMODAL(PAGE::"Web Source Launch",ContactWebSource) = ACTION::LookupOK THEN
                                   ContactWebSource.Launch;
                               END;
                                }
      { 58      ;2   ;ActionGroup;
                      CaptionML=[ENU=Create as;
                                 RUS=Создать как];
                      Visible=ActionVisible;
                      Image=CustomerContact }
      { 59      ;3   ;Action    ;
                      CaptionML=[ENU=Customer;
                                 RUS=Клиент];
                      ToolTipML=[ENU=Create the contact as a customer.;
                                 RUS=Создание контакта в качестве клиента.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Customer;
                      OnAction=BEGIN
                                 CreateCustomer(ChooseCustomerTemplate);
                               END;
                                }
      { 60      ;3   ;Action    ;
                      Name=Vendor;
                      CaptionML=[ENU=Vendor;
                                 RUS=Поставщик];
                      ToolTipML=[ENU=Create the contact as a vendor.;
                                 RUS=Создание контакта в качестве поставщика.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Vendor;
                      OnAction=BEGIN
                                 CreateVendor;
                               END;
                                }
      { 61      ;3   ;Action    ;
                      AccessByPermission=TableData 270=R;
                      CaptionML=[ENU=Bank;
                                 RUS=Банк];
                      ToolTipML=[ENU=Create the contact as a bank.;
                                 RUS=Создание контакта в качестве банка.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Bank;
                      OnAction=BEGIN
                                 CreateBankAccount;
                               END;
                                }
      { 62      ;2   ;ActionGroup;
                      CaptionML=[ENU=Link with existing;
                                 RUS=Связать с существующим];
                      Image=Links }
      { 63      ;3   ;Action    ;
                      CaptionML=[ENU=Customer;
                                 RUS=Клиент];
                      ToolTipML=[ENU=Link the contact to an existing customer.;
                                 RUS=Связывание контакта с имеющимся клиентом.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Customer;
                      OnAction=BEGIN
                                 CreateCustomerLink;
                               END;
                                }
      { 64      ;3   ;Action    ;
                      CaptionML=[ENU=Vendor;
                                 RUS=Поставщик];
                      ToolTipML=[ENU=Link the contact to an existing vendor.;
                                 RUS=Связывание контакта с имеющимся поставщиком.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Vendor;
                      OnAction=BEGIN
                                 CreateVendorLink;
                               END;
                                }
      { 65      ;3   ;Action    ;
                      AccessByPermission=TableData 270=R;
                      CaptionML=[ENU=Bank;
                                 RUS=Банк];
                      ToolTipML=[ENU=Link the contact to an existing bank.;
                                 RUS=Связывание контакта с имеющимся банком.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Bank;
                      OnAction=BEGIN
                                 CreateBankAccountLink;
                               END;
                                }
      { 31      ;1   ;Action    ;
                      AccessByPermission=TableData 5062=R;
                      CaptionML=[ENU=Create &Interact;
                                 RUS=Создать &взаимодействие];
                      ToolTipML=[ENU=Create an interaction with a specified contact.;
                                 RUS=Создание взаимодействия с указанным контактом.];
                      ApplicationArea=#RelationshipMgmt;
                      Promoted=Yes;
                      Image=CreateInteraction;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInteraction;
                               END;
                                }
      { 51      ;1   ;Action    ;
                      CaptionML=[ENU=Create Oportunity;
                                 RUS=Создание возможной сделки];
                      ToolTipML=[ENU=Register a sales opportunity for the contact.;
                                 RUS=Регистрация возможности продажи для контакта.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Page 5124;
                      RunPageLink=Contact No.=FIELD(No.),
                                  Contact Company No.=FIELD(Company No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NewOpportunity;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 28      ;1   ;Action    ;
                      Name=SyncWithExchange;
                      CaptionML=[ENU=Sync with Office 365;
                                 RUS=Синхронизация с Office 365];
                      ToolTipML=[ENU=Synchronize with Office 365 based on last sync date and last modified date. All changes in Office 365 since the last sync date will be synchronized back.;
                                 RUS=Синхронизация с Office 365 на основании даты последней синхронизации и даты последнего изменения. Все изменения в Office 365, произошедшие с момента последней синхронизации, будут заново синхронизированы.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Refresh;
                      OnAction=BEGIN
                                 SyncExchangeContacts(FALSE);
                               END;
                                }
      { 32      ;1   ;Action    ;
                      Name=FullSyncWithExchange;
                      CaptionML=[ENU=Full Sync with Office 365;
                                 RUS=Полная синхронизация с Office 365];
                      ToolTipML=[ENU=Synchronize, but ignore the last synchronized and last modified dates. All changes will be pushed to Office 365 and take all contacts from your Exchange folder and sync back.;
                                 RUS=Синхронизация без учета дат последней синхронизации и последнего изменения. Все изменения будут отправлены в Office 365, а все контакты из вашей папки Exchange будут снова синхронизированы.];
                      ApplicationArea=#Basic,#Suite;
                      Image=RefreshLines;
                      OnAction=BEGIN
                                 SyncExchangeContacts(TRUE);
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1900900305;1 ;Action    ;
                      CaptionML=[ENU=New Sales Quote;
                                 RUS=Новое предложение по продаже];
                      ToolTipML=[ENU=Create a new sales quote.;
                                 RUS=Создание предложения по продаже.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 41;
                      RunPageLink=Sell-to Contact No.=FIELD(No.);
                      Promoted=Yes;
                      Image=NewSalesQuote;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1904205506;1 ;Action    ;
                      CaptionML=[ENU=Contact Labels;
                                 RUS=Этикетки контактов];
                      ToolTipML=[ENU=View mailing labels with names and addresses of your contacts. For example, you can use the report to review contact information before you send sales and marketing campaign letters.;
                                 RUS=Просмотр почтовых этикеток с именами и адресами контактов. Например, с помощью этого отчета можно проверить информацию о контактах перед отправкой писем в рамках кампании продаж или маркетинговой кампании.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Report 5056;
                      Image=Report }
      { 1905922906;1 ;Action    ;
                      CaptionML=[ENU=Questionnaire Handout;
                                 RUS=Анкета - распечатка];
                      ToolTipML=[ENU=View your profile questionnaire for the contact. You can print this report to have a printed copy of the questions that are within the profile questionnaire.;
                                 RUS=Просмотр анкеты профиля контакта. Этот отчет можно распечатать, если требуется печатный экземпляр вопросов анкеты профиля.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Report 5066;
                      Image=Report }
      { 1900800206;1 ;Action    ;
                      CaptionML=[ENU=Sales Cycle Analysis;
                                 RUS=Цикл продаж - анализ];
                      ToolTipML=[ENU=View information about your sales cycles. The report includes details about the sales cycle, such as the number of opportunities currently at that stage, the estimated and calculated current values of opportunities created using the sales cycle, and so on.;
                                 RUS=Просмотр информации о циклах продаж. Отчет содержит подробные сведения о цикле продаж, такие как количество возможностей, имеющихся в настоящее время на этой стадии, оценочное и расчетное значения возможностей, созданных с использованием цикла продаж и т. д.];
                      ApplicationArea=#RelationshipMgmt;
                      RunObject=Report 5062;
                      Image=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the contact number.;
                           RUS=Определяет номер контакта.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Style=Strong;
                StyleExpr=StyleIsStrong }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the contact. If the contact is a person, you can click the field to see the Name Details window.;
                           RUS=Определяет имя контакта. Если контактом является сотрудник, можно щелкнуть поле, чтобы открыть окно "Подробности названия".];
                ApplicationArea=#All;
                SourceExpr=Name;
                Style=Strong;
                StyleExpr=StyleIsStrong }

    { 66  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the company. If the contact is a person, Specifies the name of the company for which this contact works. This field is not editable.;
                           RUS=Определяет название организации. Если контактом является сотрудник, задает название организации, в которой работает этот контакт. Это поле является нередактируемым.];
                ApplicationArea=#All;
                SourceExpr="Company Name";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the post code for the contact.;
                           RUS=Определяет почтовый индекс контакта.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region code for the contact.;
                           RUS=Определяет код страны/региона для контакта.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the contact's phone number.;
                           RUS=Определяет номер телефона контакта.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Phone No." }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the contact's mobile telephone number.;
                           RUS=Определяет номер мобильного телефона контакта.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Mobile Phone No.";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the contact's email.;
                           RUS=Определяет адрес электронной почты контакта.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="E-Mail" }

    { 12  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the contact's fax number.;
                           RUS=Определяет номер факса контакта.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code of the salesperson who normally handles this contact.;
                           RUS=Определяет код менеджера по продажам, который обычно работает с этим контактом.];
                ApplicationArea=#Suite;
                SourceExpr="Salesperson Code" }

    { 16  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the territory code for the contact.;
                           RUS=Определяет код территории контакта.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Territory Code" }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code for the contact.;
                           RUS=Определяет код валюты контакта.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the language code for the contact.;
                           RUS=Определяет код языка контакта.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Language Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the search name of the contact. You can use this field to search for a contact when you cannot remember the contact number.;
                           RUS=Определяет имя поиска контакта. Это поле можно использовать для поиска контакта, если вы забыли его контактный номер.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Search Name";
                Visible=FALSE }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 128 ;1   ;Part      ;
                ApplicationArea=#RelationshipMgmt;
                SubPageLink=No.=FIELD(No.),
                            Date Filter=FIELD(Date Filter);
                PagePartID=Page9130;
                PartType=Page }

    { 1900383207;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      StyleIsStrong@1001 : Boolean INDATASET;
      CompanyGroupEnabled@1004 : Boolean;
      PersonGroupEnabled@1003 : Boolean;
      CRMIntegrationEnabled@1006 : Boolean;
      CRMIsCoupledToRecord@1005 : Boolean;
      ActionVisible@1007 : Boolean;

    LOCAL PROCEDURE EnableFields@1();
    BEGIN
      CompanyGroupEnabled := Type = Type::Company;
      PersonGroupEnabled := Type = Type::Person;
    END;

    PROCEDURE SyncExchangeContacts@2(FullSync@1001 : Boolean);
    VAR
      ExchangeSync@1002 : Record 6700;
      O365SyncManagement@1000 : Codeunit 6700;
      ExchangeContactSync@1003 : Codeunit 6703;
    BEGIN
      IF O365SyncManagement.IsO365Setup(TRUE) THEN
        IF ExchangeSync.GET(USERID) THEN BEGIN
          ExchangeContactSync.GetRequestParameters(ExchangeSync);
          O365SyncManagement.SyncExchangeContacts(ExchangeSync,FullSync);
        END;
    END;

    BEGIN
    END.
  }
}

