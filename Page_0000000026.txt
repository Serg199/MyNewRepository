OBJECT Page 26 Vendor Card
{
  OBJECT-PROPERTIES
  {
    Date=11.07.17;
    Time=14:18:33;
    Modified=Yes;
    Version List=NAVW110.00.00.15601,NAVRU10.00.00.15601,NOS-26;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Vendor Card;
               RUS=Карточка поставщика];
    SourceTable=Table23;
    SourceTableView=SORTING(Vendor Type)
                    WHERE(Vendor Type=CONST(Vendor));
    PageType=Card;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Approve,Request Approval,New Document,Navigate,Incoming Documents;
                                RUS=Создать,Обработать,Отчет,Утвердить,Запросить утверждение,Создать документ,Навигатор,Входящие документы];
    OnInit=BEGIN
             SetVendorNoVisibilityOnFactBoxes;

             ContactEditable := TRUE;
             TotalBalanceVisible := TRUE;
             CustomerBalanceVisible := TRUE;
             CustomerNameVisible := TRUE;
             IF "No." <> '' THEN
               CurrPage.AgedAccPayableChart.PAGE.SetPerVendor;
           END;

    OnOpenPage=BEGIN
                 ActivateFields;
                 IsOfficeAddin := OfficeMgt.IsAvailable;

                 //NC NOS-26 SPA Кастомизация перенесена в CU 50085 на событие OnOpenPage
               END;

    OnAfterGetRecord=BEGIN
                       ActivateFields;
                     END;

    OnNewRecord=VAR
                  DocumentNoVisibility@1003 : Codeunit 1400;
                BEGIN
                  IF GUIALLOWED THEN
                    IF "No." = '' THEN
                      IF DocumentNoVisibility.VendorNoSeriesIsDefault THEN
                        NewMode := TRUE;
                END;

    OnAfterGetCurrRecord=BEGIN
                           CreateVendorFromTemplate;
                           ActivateFields;
                           OpenApprovalEntriesExistCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
                           OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);
                           CanCancelApprovalForRecord := ApprovalsMgmt.CanCancelApprovalForRecord(RECORDID);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 64      ;1   ;ActionGroup;
                      CaptionML=[ENU=Ven&dor;
                                 RUS=Пос&тавщик];
                      Image=Vendor }
      { 184     ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 RUS=Измерения];
                      ToolTipML=[ENU=View or edits dimensions, such as area, project, or department, that you can assign to sales and purchase documents to distribute costs and analyze transaction history.;
                                 RUS=Просмотр или изменение измерений, например области, проекта или отдела, которые можно назначать документам покупки и продажи для распределения себестоимости и анализа истории транзакций.];
                      ApplicationArea=#Suite;
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(23),
                                  No.=FIELD(No.);
                      Image=Dimensions }
      { 87      ;2   ;Action    ;
                      CaptionML=[ENU=Bank Accounts;
                                 RUS=Банковские счета];
                      ToolTipML=[ENU=View or set up the vendor's bank accounts. You can set up any number of bank accounts for each vendor.;
                                 RUS=Просмотр или настройка банковских счетов поставщиков. Для каждого из поставщиков можно настроить любой номер банковского счета.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 426;
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=BankAccount }
      { 1470019 ;2   ;Action    ;
                      CaptionML=[ENU=Agreements;
                                 RUS=Договоры];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 14913;
                      RunPageLink=Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Agreement;
                      PromotedCategory=Process }
      { 14      ;2   ;Action    ;
                      Name=ContactBtn;
                      AccessByPermission=TableData 5050=R;
                      CaptionML=[ENU=C&ontact;
                                 RUS=К&онтакт];
                      ToolTipML=[ENU=View or edit detailed information about the contact person at the customer.;
                                 RUS=Просмотр или изменение подробных сведений о контактном лице клиента.];
                      ApplicationArea=#Basic,#Suite;
                      PromotedIsBig=Yes;
                      Image=ContactPerson;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 54      ;2   ;Action    ;
                      Name=OrderAddresses;
                      CaptionML=[ENU=Order &Addresses;
                                 RUS=&Адреса заказов];
                      ToolTipML=[ENU=View a list of alternate order addresses for the vendor.;
                                 RUS=Просмотр списка альтернативных адресов заказа для поставщика.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 369;
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=Addresses }
      { 68      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 RUS=Ко&мментарии];
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Vendor),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 76      ;2   ;Action    ;
                      Name=ApprovalEntries;
                      AccessByPermission=TableData 454=R;
                      CaptionML=[ENU=Approvals;
                                 RUS=Утверждения];
                      ToolTipML=[ENU=View a list of the records that are waiting to be approved. For example, you can see who requested the record to be approved, when it was sent, and when it is due to be approved.;
                                 RUS=Просмотр списка записей, ожидающих утверждения. Например, вы можете видеть имя пользователя, запросившего утверждение записи, время отправки запроса и время, когда он должен быть утвержден.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Image=Approvals;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 ApprovalsMgmt.OpenApprovalEntriesPage(RECORDID);
                               END;
                                }
      { 84      ;2   ;Action    ;
                      CaptionML=[ENU=Cross References;
                                 RUS=Перекрестные ссылки];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 5723;
                      RunPageView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                      RunPageLink=Cross-Reference Type=CONST(Vendor),
                                  Cross-Reference Type No.=FIELD(No.);
                      Image=Change }
      { 1470016 ;2   ;Separator  }
      { 1470017 ;2   ;Action    ;
                      CaptionML=[ENU=Copy from Customer;
                                 RUS=Копировать из данных клиента];
                      ApplicationArea=#Basic,#Suite;
                      Image=Customer;
                      OnAction=BEGIN
                                 CopyFromCustomer(Rec);
                               END;
                                }
      { 1470018 ;2   ;Action    ;
                      CaptionML=[ENU=Combine Vendors;
                                 RUS=Объединить поставщиков];
                      ApplicationArea=#Basic,#Suite;
                      Image=Action;
                      OnAction=VAR
                                 JoinEntries@1470001 : Report 12465;
                               BEGIN
                                 JoinEntries.ChangeVendor(Rec);
                                 JoinEntries.RUN;
                               END;
                                }
      { 225     ;2   ;Action    ;
                      Name=VendorReportSelections;
                      CaptionML=[ENU=Document Layouts;
                                 RUS=Макеты документа];
                      ToolTipML=[ENU=Set up a layout for different types of documents such as invoices, quotes, and credit memos.;
                                 RUS=Настройка макета для различных типов документов, например для счетов, предложений и кредит-нот.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Quote;
                      OnAction=VAR
                                 CustomReportSelection@1001 : Record 9657;
                               BEGIN
                                 CustomReportSelection.SETRANGE("Source Type",DATABASE::Vendor);
                                 CustomReportSelection.SETRANGE("Source No.","No.");
                                 PAGE.RUNMODAL(PAGE::"Vendor Report Selections",CustomReportSelection);
                               END;
                                }
      { 1101495016;2 ;Action    ;
                      CaptionML=[ENU=Fields mapping;
                                 RUS=Соответствия полей];
                      Image=Table;
                      OnAction=VAR
                                 ComFieldsSetupForm@1101495000 : Page 50038;
                               BEGIN
                                 //NC MTF01 > PCH
                                 ComFieldsSetupForm.SetNewRecord(DATABASE::"Buffer Vendor", DATABASE::Vendor);
                                 ComFieldsSetupForm.RUN;
                                 //NC MTF01 > PCH
                               END;
                                }
      { 1101495017;2 ;Action    ;
                      CaptionML=RUS=Изменить статус блокировки;
                      Image=Change;
                      OnAction=VAR
                                 ChangeBlockCounterpartyForm@1101495000 : Page 50161;
                               BEGIN
                                 //NC TR225 > DP
                                 CLEAR(ChangeBlockCounterpartyForm);
                                 ChangeBlockCounterpartyForm.SetCounterparty(23,"No.");
                                 ChangeBlockCounterpartyForm.RUNMODAL;
                                 //NC TR225 < DP
                               END;
                                }
      { 1101495018;2 ;Action    ;
                      CaptionML=RUS=История изменений блокировки;
                      RunObject=Page 50162;
                      RunPageLink=Source Table ID=CONST(23),
                                  Source No.=FIELD(No.);
                      Image=Log }
      { 71      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Purchases;
                                 RUS=&Покупки];
                      Image=Purchasing }
      { 118     ;2   ;Action    ;
                      CaptionML=[ENU=Items;
                                 RUS=Товары];
                      RunObject=Page 297;
                      RunPageView=SORTING(Vendor No.,Item No.);
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=Item }
      { 73      ;2   ;Action    ;
                      CaptionML=[ENU=Invoice &Discounts;
                                 RUS=&Скидки по счету];
                      ToolTipML=[ENU=View or set up conditions for invoice discounts and service charges for the vendor.;
                                 RUS=Просмотр или настройка условий применения скидок по счетам и сервисных сборов для поставщика.];
                      ApplicationArea=#Suite;
                      RunObject=Page 28;
                      RunPageLink=Code=FIELD(Invoice Disc. Code);
                      Image=CalculateInvoiceDiscount }
      { 72      ;2   ;Action    ;
                      CaptionML=[ENU=Prices;
                                 RUS=Цены];
                      ToolTipML=[ENU=View or set up different prices for items that you buy from the vendor. An item price is automatically granted on invoice lines when the specified criteria are met, such as vendor, quantity, or ending date.;
                                 RUS=Просмотр или настройка различных цен для товаров, которые вы покупаете у поставщика. Цена товара автоматически задается для строк счета при выполнении определенных условий, например по поставщику, количеству или дате окончания.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 7012;
                      RunPageView=SORTING(Vendor No.);
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=Price }
      { 116     ;2   ;Action    ;
                      CaptionML=[ENU=Line Discounts;
                                 RUS=Скидки строки];
                      ToolTipML=[ENU=View or set up purchase line discounts.;
                                 RUS=Просмотр или настройка скидок строки покупки.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 7014;
                      RunPageView=SORTING(Vendor No.);
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=LineDiscount }
      { 129     ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Percentages;
                                 RUS=Пр&оценты предоплаты];
                      RunObject=Page 665;
                      RunPageView=SORTING(Vendor No.);
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=PrepaymentPercentages }
      { 123     ;2   ;Action    ;
                      CaptionML=[ENU=S&td. Vend. Purchase Codes;
                                 RUS=С&тандартные коды покупки];
                      RunObject=Page 178;
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=CodesList }
      { 78      ;2   ;Action    ;
                      CaptionML=[ENU=Mapping Text to Account;
                                 RUS=Сопоставление текста со счетами];
                      ToolTipML=[ENU=Page mapping text to account;
                                 RUS=Сопоставление текста страниц со счетами];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1254;
                      RunPageLink=Vendor No.=FIELD(No.);
                      Image=MapAccounts }
      { 5       ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 RUS=Документы];
                      Image=Administration }
      { 74      ;2   ;Action    ;
                      CaptionML=[ENU=Quotes;
                                 RUS=Предложения];
                      RunObject=Page 9306;
                      RunPageView=SORTING(Document Type,Buy-from Vendor No.);
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Image=Quote }
      { 75      ;2   ;Action    ;
                      CaptionML=[ENU=Orders;
                                 RUS=Заказы];
                      RunObject=Page 9307;
                      RunPageView=SORTING(Document Type,Buy-from Vendor No.);
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Image=Document }
      { 99      ;2   ;Action    ;
                      CaptionML=[ENU=Return Orders;
                                 RUS=Возвраты];
                      RunObject=Page 9311;
                      RunPageView=SORTING(Document Type,Buy-from Vendor No.);
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Image=ReturnOrder }
      { 21      ;2   ;Action    ;
                      CaptionML=[ENU=Blanket Orders;
                                 RUS=Общие заказы];
                      RunObject=Page 9310;
                      RunPageView=SORTING(Document Type,Buy-from Vendor No.);
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Image=BlanketOrder }
      { 7       ;1   ;ActionGroup;
                      CaptionML=[ENU=History;
                                 RUS=История];
                      Image=History }
      { 70      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 RUS=&Книга операций];
                      ToolTipML=[ENU=View the history of transactions that have been posted for the selected record.;
                                 RUS=Просмотр истории транзакций, которые были учтены для выбранной записи.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 29;
                      RunPageView=SORTING(Vendor No.)
                                  ORDER(Descending);
                      RunPageLink=Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=VendorLedger;
                      PromotedCategory=Process }
      { 66      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 RUS=Статистика];
                      RunObject=Page 152;
                      RunPageLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 69      ;2   ;Action    ;
                      CaptionML=[ENU=Purchases;
                                 RUS=Покупки];
                      RunObject=Page 156;
                      RunPageLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Image=Purchase }
      { 67      ;2   ;Action    ;
                      CaptionML=[ENU=Entry Statistics;
                                 RUS=Статистика операций];
                      RunObject=Page 303;
                      RunPageLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Image=EntryStatistics }
      { 20      ;2   ;Action    ;
                      CaptionML=[ENU=Statistics by C&urrencies;
                                 RUS=Статистика по в&алютам];
                      RunObject=Page 487;
                      RunPageLink=Vendor Filter=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                  Date Filter=FIELD(Date Filter);
                      Image=Currencies }
      { 6500    ;2   ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 RUS=Операции трассир&овки товара];
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingDocMgt@1000 : Codeunit 6503;
                               BEGIN
                                 ItemTrackingDocMgt.ShowItemTrackingForMasterData(2,"No.",'','','','','','');
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1903213705;1 ;Action    ;
                      Name=NewBlanketPurchaseOrder;
                      CaptionML=[ENU=Blanket Purchase Order;
                                 RUS=Общий заказ на покупку];
                      RunObject=Page 509;
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=BlanketOrder;
                      PromotedCategory=Category6;
                      RunPageMode=Create }
      { 1901469405;1 ;Action    ;
                      Name=NewPurchaseQuote;
                      CaptionML=[ENU=Purchase Quote;
                                 RUS=Предложение по покупке];
                      RunObject=Page 49;
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=Quote;
                      PromotedCategory=Category6;
                      RunPageMode=Create }
      { 1907709505;1 ;Action    ;
                      Name=NewPurchaseInvoice;
                      CaptionML=[ENU=Purchase Invoice;
                                 RUS=Счет покупки];
                      ToolTipML=[ENU=Create a new purchase invoice for items or services.;
                                 RUS=Создание счета покупки товаров или услуг.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 51;
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=NewPurchaseInvoice;
                      PromotedCategory=Category6;
                      PromotedOnly=Yes;
                      RunPageMode=Create }
      { 1907375405;1 ;Action    ;
                      Name=NewPurchaseOrder;
                      CaptionML=[ENU=Purchase Order;
                                 RUS=Заказ на покупку];
                      ToolTipML=[ENU=Create a new purchase order.;
                                 RUS=Создание заказа на покупку.];
                      ApplicationArea=#Suite;
                      RunObject=Page 50;
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Category6;
                      PromotedOnly=Yes;
                      RunPageMode=Create }
      { 1905024805;1 ;Action    ;
                      Name=NewPurchaseCrMemo;
                      CaptionML=[ENU=Purchase Credit Memo;
                                 RUS=Кредит-нота покупки];
                      ToolTipML=[ENU=Create a new purchase credit memo to revert a posted purchase invoice.;
                                 RUS=Создание кредит-ноты покупки для сторнирования учтенного счета покупки.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 52;
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=Yes;
                      Image=CreditMemo;
                      PromotedCategory=Category6;
                      PromotedOnly=Yes;
                      RunPageMode=Create }
      { 1904749705;1 ;Action    ;
                      Name=NewPurchaseReturnOrder;
                      CaptionML=[ENU=Purchase Return Order;
                                 RUS=Возврат покупки];
                      RunObject=Page 6640;
                      RunPageLink=Buy-from Vendor No.=FIELD(No.);
                      Promoted=No;
                      Image=ReturnOrder;
                      PromotedCategory=Category6;
                      RunPageMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 39      ;1   ;ActionGroup;
                      CaptionML=[ENU=Approval;
                                 RUS=Утверждение] }
      { 37      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 RUS=Утвердить];
                      ToolTipML=[ENU=Approve the requested changes.;
                                 RUS=Утверждение запрошенных изменений.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 35      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=[ENU=Reject;
                                 RUS=Отклонить];
                      ToolTipML=[ENU=Reject the approval request.;
                                 RUS=Отклонение запроса на утверждение.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 33      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=[ENU=Delegate;
                                 RUS=Делегировать];
                      ToolTipML=[ENU=Delegate the approval to a substitute approver.;
                                 RUS=Делегирование утверждения заместителю утверждающего лица.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID);
                               END;
                                }
      { 77      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=[ENU=Comments;
                                 RUS=Комментарии];
                      ToolTipML=[ENU=View or add comments.;
                                 RUS=Просмотр или добавление комментариев.];
                      ApplicationArea=#All;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.GetApprovalComment(Rec);
                               END;
                                }
      { 31      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 RUS=Утверждение запросов];
                      Image=SendApprovalRequest }
      { 29      ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 RUS=Отправить &запрос на утверждение];
                      ToolTipML=[ENU=Send an approval request.;
                                 RUS=Отправка запроса на утверждение.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckVendorApprovalsWorkflowEnabled(Rec) THEN
                                   ApprovalsMgmt.OnSendVendorForApproval(Rec);
                               END;
                                }
      { 27      ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 RUS=Отменить за&прос на утверждение];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 RUS=Отмена запроса на утверждение.];
                      ApplicationArea=#Suite;
                      Promoted=Yes;
                      Enabled=CanCancelApprovalForRecord;
                      Image=CancelApprovalRequest;
                      PromotedCategory=Category5;
                      PromotedOnly=Yes;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelVendorApprovalRequest(Rec);
                               END;
                                }
      { 130     ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 RUS=Ф&ункции];
                      Image=Action }
      { 59      ;2   ;Action    ;
                      Name=Templates;
                      CaptionML=[ENU=Templates;
                                 RUS=Шаблоны];
                      ToolTipML=[ENU=View or edit vendor templates.;
                                 RUS=Просмотр или изменение шаблонов поставщиков.];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 1340;
                      RunPageLink=Table ID=CONST(23);
                      PromotedIsBig=Yes;
                      Image=Template }
      { 131     ;2   ;Action    ;
                      Name=ApplyTemplate;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Apply Template;
                                 RUS=Заполнить по шаблону];
                      ToolTipML=[ENU=Cancel the approval request.;
                                 RUS=Отмена запроса на утверждение.];
                      ApplicationArea=#Basic,#Suite;
                      PromotedIsBig=Yes;
                      Image=ApplyTemplate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 MiniVendorTemplate@1002 : Record 1303;
                               BEGIN
                                 MiniVendorTemplate.UpdateVendorFromTemplate(Rec);
                               END;
                                }
      { 51      ;2   ;Action    ;
                      Name=SaveAsTemplate;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Save as Template;
                                 RUS=Сохранить как шаблон];
                      ToolTipML=[ENU=Save the vendor card as a template that can be reused to create new vendor cards. Vendor templates contain preset information to help you fill fields on vendor cards.;
                                 RUS=Сохранение карточки поставщика в качестве шаблона, который можно повторно использовать при создании новых карточек поставщиков. Шаблоны поставщиков содержат заготовленные сведения, помогающие заполнять поля в карточках поставщиков.];
                      ApplicationArea=#Basic,#Suite;
                      Image=Save;
                      OnAction=VAR
                                 TempMiniVendorTemplate@1000 : TEMPORARY Record 1303;
                               BEGIN
                                 TempMiniVendorTemplate.SaveAsTemplate(Rec);
                               END;
                                }
      { 1902327104;1 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create Payments;
                                 RUS=Создать платежи];
                      ToolTipML=[ENU=View or edit the payment journal where you can register payments to vendors.;
                                 RUS=Просмотр или изменение журнала платежей, в котором можно регистрировать платежи поставщикам.];
                      RunObject=Page 256;
                      Image=PaymentJournal;
                      PromotedCategory=Process }
      { 1906371704;1 ;Action    ;
                      CaptionML=[ENU=Purchase Journal;
                                 RUS=Журнал покупок];
                      RunObject=Page 254;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1101495019;1 ;Action    ;
                      CaptionML=[ENU=Change Segment;
                                 RUS=Изменить Сегмент];
                      Image=ChangeCustomer;
                      OnAction=VAR
                                 UserSetup@1101495003 : Record 91;
                                 Segment@1101495002 : Record 50190;
                                 SegmentTemp@1101495001 : TEMPORARY Record 50190;
                                 MovingDataSetup@1101495004 : Record 50064;
                                 DimValue@1101495005 : Record 349;
                                 IsAddGlobal@1101495000 : Boolean;
                               BEGIN
                                 //NC S1883 > PCH
                                 UserSetup.GET(USERID);
                                 UserSetup.TESTFIELD("Data Admin",TRUE);

                                 SegmentTemp.RESET;
                                 SegmentTemp.DELETEALL;
                                 Segment.RESET;
                                 IF Segment.FINDSET THEN REPEAT
                                   SegmentTemp := Segment;
                                   SegmentTemp.INSERT;
                                   IF SegmentTemp."Is General" THEN
                                     IsAddGlobal := TRUE;
                                 UNTIL Segment.NEXT = 0;

                                 IF NOT IsAddGlobal THEN BEGIN
                                   SegmentTemp.INIT;
                                   SegmentTemp.Code := '<EMPTY>';
                                   SegmentTemp.Name := 'Empty';
                                   SegmentTemp."Is General" := TRUE;
                                   SegmentTemp.INSERT;
                                 END;

                                 IF "Segment Code" <> '' THEN
                                   IF SegmentTemp.GET("Segment Code") THEN ;

                                 IF ACTION::LookupOK = PAGE.RUNMODAL(PAGE::Segments,SegmentTemp) THEN BEGIN
                                   IF SegmentTemp."Is General" THEN
                                     "Segment Code" := ''
                                   ELSE
                                     "Segment Code" := SegmentTemp.Code;
                                   MODIFY;

                                   MovingDataSetup.GET;
                                   IF DimValue.GET(MovingDataSetup."Customer Dimension Code","No.") THEN BEGIN
                                     DimValue."Segment Code" := "Segment Code";
                                     DimValue.MODIFY;
                                   END;
                                   IF DimValue.GET(MovingDataSetup."Real Counterparty Dim. Code","No.") THEN BEGIN
                                     DimValue."Segment Code" := "Segment Code";
                                     DimValue.MODIFY;
                                   END;

                                   CurrPage.UPDATE(FALSE);
                                 END;
                                 //NC S1883 < PCH
                               END;
                                }
      { 1101495020;1 ;Action    ;
                      CaptionML=[ENU=Edit Group;
                                 RUS=Редактировать Группу];
                      Promoted=Yes;
                      Image=EditCustomer;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //NC #TODO# перенести Report 50227
                                 {
                                 //TDRANCS-2273>
                                 CLEAR(l_repICCor);
                                 l_repICCor.fn_SetParam(23,"No.");
                                 l_repICCor.RUNMODAL;
                                 }
                               END;
                                }
      { 63      ;1   ;ActionGroup;
                      CaptionML=[ENU=Incoming Documents;
                                 RUS=Входящие документы];
                      Image=SendApprovalRequest }
      { 65      ;2   ;Action    ;
                      Name=SendToIncomingDocuments;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Send to Incoming Documents;
                                 RUS=Отправить во входящие документы];
                      ToolTipML=[ENU=Send to Incoming Documents;
                                 RUS=Отправить во входящие документы];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=SendToIncomingDocumentVisible;
                      Enabled=SendToIncomingDocEnabled;
                      PromotedIsBig=Yes;
                      Image=SendElectronicDocument;
                      PromotedCategory=Category8;
                      OnAction=BEGIN
                                 OfficeMgt.InitiateSendToIncomingDocuments("No.");
                               END;
                                }
      { 61      ;2   ;Action    ;
                      Name=SendToOCR;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Send To OCR;
                                 RUS=Отправить в службу OCR];
                      ToolTipML=[ENU=Send To OCR;
                                 RUS=Отправить в службу OCR];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=SendToOCRVisible;
                      Enabled=SendToOCREnabled;
                      PromotedIsBig=Yes;
                      Image=SendElectronicDocument;
                      PromotedCategory=Category8;
                      OnAction=BEGIN
                                 OfficeMgt.InitiateSendToOCR("No.");
                               END;
                                }
      { 62      ;2   ;Action    ;
                      Name=SendIncomingDocApprovalRequest;
                      AccessByPermission=TableData 454=I;
                      CaptionML=[ENU=Send A&pproval Request;
                                 RUS=Отправить &запрос на утверждение];
                      ToolTipML=[ENU=Send an approval request.;
                                 RUS=Отправка запроса на утверждение.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Visible=SendIncomingDocApprovalRequestVisible;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category8;
                      PromotedOnly=Yes;
                      OnAction=BEGIN
                                 OfficeMgt.InitiateSendApprovalRequest("No.");
                               END;
                                }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 57      ;1   ;Action    ;
                      CaptionML=[ENU=Vendor - Summary Aging;
                                 RUS=Поставщик - сводка задолженности с распределением по срокам];
                      ToolTipML=[ENU=View a summary of the payables owed to each vendor, divided into three time periods.;
                                 RUS=Просмотр сводки кредиторской задолженности по каждому из поставщиков, разделенной на три периода.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 RunReport(REPORT::"Vendor - Summary Aging");
                               END;
                                }
      { 1905916106;1 ;Action    ;
                      CaptionML=[ENU=Vendor - Labels;
                                 RUS=Поставщик - этикетки];
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 RunReport(REPORT::"Vendor - Labels");
                               END;
                                }
      { 1904504206;1 ;Action    ;
                      CaptionML=[ENU=Vendor - Balance to Date;
                                 RUS=Поставщик - баланс на дату];
                      ToolTipML=[ENU=View a detail balance for selected vendors.;
                                 RUS=Просмотр подробного баланса для выбранных поставщиков.];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 RunReport(REPORT::"Vendor - Balance to Date");
                               END;
                                }
      { 1901242306;1 ;Action    ;
                      CaptionML=[ENU=Vendor - Reconciliation Act;
                                 RUS=Поставщик - акт выверки];
                      ApplicationArea=#Basic,#Suite;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 RunReport(REPORT::"Vendor - Reconciliation Act");
                               END;
                                }
      { 1907548306;1 ;Action    ;
                      CaptionML=[ENU=Vendor G/L Turnover;
                                 RUS=Поставщики - оборотная ведомость по ГК];
                      ApplicationArea=#Basic,#Suite;
                      RunObject=Page 12407;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           RUS=Общее] }

    { 2   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the vendor. The field is either filled automatically from a defined number series, or you enter the number manually because you have enabled manual number entry in the number-series setup.;
                           RUS=Определяет номер поставщика. Либо поле заполняется автоматически из заданной серии номеров, либо пользователь вводит номер вручную, если в параметрах серий номеров выбран ввод номеров вручную.];
                ApplicationArea=#All;
                SourceExpr="No.";
                Importance=Additional;
                Visible=NoFieldVisible;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's name. You can enter a maximum of 30 characters, both numbers and letters.;
                           RUS=Определяет имя поставщика. Длина имени не должна превышать 30 символов (букв или цифр).];
                ApplicationArea=#All;
                SourceExpr=Name;
                Importance=Promoted;
                ShowMandatory=TRUE }

    { 1210002;2;Field     ;
                ToolTipML=[ENU=Specifies the full name of the vendor.;
                           RUS=Определяет полное имя поставщика.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Full Name" }

    { 24  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies which transactions with the vendor that cannot be posted.;
                           RUS=Определяет транзакции с поставщиком, которые не могут быть учтены.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Blocked }

    { 26  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies when the vendor card was last modified.;
                           RUS=Определяет дату последнего изменения карточки поставщика.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Last Date Modified";
                Importance=Additional }

    { 92  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total value of your completed purchases from the vendor in the current fiscal year. It is calculated from amounts excluding VAT on all completed purchase invoices and credit memos.;
                           RUS=Определяет общую сумму совершенных покупок у поставщика в текущем финансовом году. Это значение вычисляется на основании сумм без НДС по всем завершенным счетам и кредит-нотам покупки.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Balance (LCY)";
                OnDrillDown=BEGIN
                              OpenVendorLedgerEntries(FALSE);
                            END;
                             }

    { 1101495008;2;Field  ;
                SourceExpr="Balance at Date (LCY)" }

    { 45  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the total value of your unpaid purchases from the vendor in the current fiscal year. It is calculated from amounts excluding VAT on all open purchase invoices and credit memos.;
                           RUS=Определяет общую сумму неоплаченных покупок у поставщика в текущем финансовом году. Это значение вычисляется на основании сумм без НДС по всем открытым счетам и кредит-нотам покупки.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Balance Due (LCY)";
                OnDrillDown=BEGIN
                              OpenVendorLedgerEntries(TRUE);
                            END;
                             }

    { 80  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the preferred method of sending documents to this vendor, so that you do not have to select a sending option every time that you post and send a document to the vendor. Documents to this vendor will be sent using the specified sending profile and will override the default document sending profile.;
                           RUS=Определяет предпочитаемый метод отправки документов этому поставщику, чтобы не выбирать вариант отправки каждый раз при учете и отправке документа поставщику. Документы этому поставщику будут отправляться с использованием указанного профиля отправки и будут переопределять профиль отправки документов по умолчанию.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Document Sending Profile";
                Importance=Additional }

    { 18  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a search name.;
                           RUS=Определяет имя поиска.];
                SourceExpr="Search Name";
                Importance=Additional }

    { 22  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code to specify the purchaser who normally handles this vendor's account.;
                           RUS=Определяет код менеджера, который обычно обрабатывает счета этого поставщика.];
                SourceExpr="Purchaser Code";
                Importance=Additional }

    { 55  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the code for the responsibility center that will administer this vendor by default.;
                           RUS=Определяет код центра ответственности, который будет заниматься этим поставщиком по умолчанию.];
                SourceExpr="Responsibility Center";
                Importance=Additional }

    { 1101495000;2;Field  ;
                SourceExpr="Relationship to the Group";
                OnValidate=BEGIN
                             //TDRANCS-2273>
                             g_recUserSetup.GET(USERID);
                             IF NOT g_recUserSetup."Allow Edit Count. IC Code" THEN
                               ERROR(Text50003,g_recUserSetup.FIELDCAPTION(g_recUserSetup."Allow Edit Count. IC Code"));
                             //TDRANCS-2273<

                             //NC NOS-26 > SPA
                             ICCounterpartyEditable := "Relationship to the Group";
                             //NC NOS-26 < SPA
                           END;
                            }

    { 1101495004;2;Field  ;
                SourceExpr="IC Dimension Value Code";
                Editable=ICCounterpartyEditable;
                OnValidate=BEGIN
                             //TDRANCS-2273>
                             g_recUserSetup.GET(USERID);
                             IF NOT g_recUserSetup."Allow Edit Count. IC Code" THEN
                               ERROR(Text50003,g_recUserSetup.FIELDCAPTION(g_recUserSetup."Allow Edit Count. IC Code"));
                             //TDRANCS-2273<

                             //NC MDB05.1 > DP
                             ICCounterparty := "IC Dimension Value Code";
                             SetICCode;
                             //NC MDB05.1 < DP
                           END;

                OnLookup=VAR
                           ConsSetup@1101495001 : Record 50000;
                           DimValue@1101495000 : Record 349;
                         BEGIN

                           //NC MDB05.1 > DP
                           ConsSetup.GET;
                           ConsSetup.TESTFIELD("IC Dimension Code");
                           DimValue.RESET;
                           DimValue.SETRANGE("Dimension Code",ConsSetup."IC Dimension Code");
                           IF PAGE.RUNMODAL(0, DimValue) = ACTION::LookupOK THEN BEGIN
                             VALIDATE("IC Dimension Value Code", DimValue.Code);
                             ICCounterparty := DimValue.Code;
                             SetICCode;
                           END;
                           //NC MDB05.1 < DP
                         END;
                          }

    { 1101495009;2;Field  ;
                SourceExpr="Related Counterparty Type Code" }

    { 1101495007;2;Field  ;
                SourceExpr="Resident/Non-resident" }

    { 1101495001;2;Field  ;
                SourceExpr="Counterparty Category" }

    { 1101495002;2;Field  ;
                SourceExpr="Counterparty Type" }

    { 1101495003;2;Field  ;
                SourceExpr=Industry }

    { 1101495005;2;Field  ;
                SourceExpr="Vendor ID";
                Editable=FALSE }

    { 1101495006;2;Field  ;
                SourceExpr="Vendor Segment" }

    { 1101495010;2;Field  ;
                SourceExpr="Segment Code";
                Editable=FALSE }

    { 1902768601;1;Group  ;
                CaptionML=[ENU=Address & Contact;
                           RUS=Адрес и контакты];
                GroupType=Group }

    { 43  ;2   ;Group     ;
                CaptionML=[ENU=Address;
                           RUS=Адрес];
                GroupType=Group }

    { 6   ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's address.;
                           RUS=Определяет адрес поставщика.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Address }

    { 8   ;3   ;Field     ;
                ToolTipML=[ENU=Specifies additional address information.;
                           RUS=Определяет дополнительные сведения адреса.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Address 2" }

    { 79  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the postal code.;
                           RUS=Определяет почтовый индекс.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Post Code";
                Importance=Promoted }

    { 10  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's city.;
                           RUS=Определяет город поставщика.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=City }

    { 81  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the country/region of the address.;
                           RUS=Определяет страну/регион для адреса.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Country/Region Code" }

    { 49  ;3   ;Field     ;
                Name=ShowMap;
                ToolTipML=[ENU=Specifies you can view the customer's address on your preferred map website.;
                           RUS=Указывает, что вы можете посмотреть адрес клиента на предпочитаемом вами веб-сайте с картами.];
                SourceExpr=ShowMapLbl;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE;
                OnDrillDown=BEGIN
                              CurrPage.UPDATE(TRUE);
                              DisplayMap;
                            END;

                ShowCaption=No }

    { 44  ;2   ;Group     ;
                CaptionML=[ENU=Contact;
                           RUS=Контакт];
                GroupType=Group }

    { 11  ;3   ;Field     ;
                CaptionML=[ENU=Primary Contact Code;
                           RUS=Код основного контакта];
                ToolTipML=[ENU=Specifies the primary contact number for the customer.;
                           RUS=Определяет основной номер контакта для клиента.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Primary Contact No." }

    { 16  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person you regularly contact when you do business with this vendor.;
                           RUS=Определяет имя лица, с которым регулярно осуществляется контакт при ведении бизнеса с этим поставщиком.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Contact;
                Importance=Promoted;
                Editable=ContactEditable;
                OnValidate=BEGIN
                             ContactOnAfterValidate;
                           END;
                            }

    { 12  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's telephone number.;
                           RUS=Определяет номер телефона поставщика.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Phone No." }

    { 48  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's email address.;
                           RUS=Определяет адрес электронной почты поставщика.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="E-Mail";
                Importance=Promoted }

    { 58  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's fax number.;
                           RUS=Определяет номер факса клиента.];
                SourceExpr="Fax No.";
                Importance=Additional }

    { 86  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's home page address.;
                           RUS=Определяет адрес сайта поставщика.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Home Page" }

    { 50  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies your account number with the vendor, if you have one.;
                           RUS=Определяет ваш номер счета у поставщика, если он у вас есть.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Our Account No." }

    { 56  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the language on printouts for this vendor.;
                           RUS=Определяет язык, используемый при печати для этого поставщика.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Language Code";
                Importance=Additional }

    { 1905885101;1;Group  ;
                CaptionML=[ENU=Invoicing;
                           RUS=Счет] }

    { 23  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's VAT registration number.;
                           RUS=Определяет ИНН поставщика.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Registration No.";
                OnDrillDown=VAR
                              VATRegistrationLogMgt@1000 : Codeunit 249;
                            BEGIN
                              VATRegistrationLogMgt.AssistEditVendorVATReg(Rec);
                            END;
                             }

    { 25  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor in connection with electronic document receiving.;
                           RUS=Определяет поставщика в связи с электронным получением документов.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=GLN;
                Importance=Additional }

    { 1470000;2;Field     ;
                ToolTipML=[ENU=Specifies the federation-wide organizational classification associated with the vendor.;
                           RUS=Определяет общую организационную классификацию, связанную с поставщиком.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="OKPO Code" }

    { 1470002;2;Field     ;
                ToolTipML=[ENU=Specifies the federation-wide national economy sector associated with the vendor.;
                           RUS=Определяет общий организационный экономический сектор, связанный с поставщиком.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="OKONX Code" }

    { 1470004;2;Field     ;
                ToolTipML=[ENU=Specifies the company registration code associated with the vendor.;
                           RUS=Определяет код регистрации компании, связанный с поставщиком.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="KPP Code" }

    { 30  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the number of a different vendor whom you pay for products delivered by the vendor on the vendor card.;
                           RUS=Определяет номер другого поставщика, которому организация направляет платеж за продукцию, доставленную поставщиком, указанным в карточке поставщика.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Pay-to Vendor No.";
                Importance=Additional }

    { 34  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's invoice discount code. When you set up a new vendor card, the number you have entered in the No. field is automatically inserted.;
                           RUS=Определяет код скидки по счетам поставщика. При настройке карточки нового поставщика в это поле автоматически подставляется номер, введенный в поле "Номер".];
                ApplicationArea=#Basic,#Suite;
                NotBlank=Yes;
                SourceExpr="Invoice Disc. Code";
                Importance=Additional }

    { 94  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the Direct Unit Cost and Line Amount fields on the purchase lines and in purchase reports should be shown with or without VAT.;
                           RUS=Определяет, должны ли поля "Прямая себестоимость единицы" и "Сумма строки" в строках покупки и отчетах о покупках содержать значения с НДС или без НДС.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Prices Including VAT" }

    { 46  ;2   ;Group     ;
                CaptionML=[ENU=Posting Details;
                           RUS=Подробные сведения учета];
                GroupType=Group }

    { 60  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's trade type to link transactions made for this vendor with the appropriate general ledger account according to the general posting setup.;
                           RUS=Определяет тип торговых операций поставщика, чтобы связать транзакции, сделанные для этого поставщика, с соответствующим счетом главной книги согласно настройке общего учета.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Gen. Bus. Posting Group";
                Importance=Additional;
                ShowMandatory=TRUE }

    { 90  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's VAT specification to link transactions made for this vendor with the appropriate general ledger account according to the VAT posting setup.;
                           RUS=Определяет спецификацию НДС поставщика, чтобы связать транзакции, сделанные для этого поставщика, с соответствующим счетом главной книги согласно настройке учета НДС.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Bus. Posting Group";
                Importance=Additional }

    { 32  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor's market type to link business transactions made for the vendor with the appropriate account in the general ledger.;
                           RUS=Определяет тип рынка поставщика, чтобы связать бизнес-транзакции, сделанные для этого поставщика, с соответствующим счетом главной книги.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Vendor Posting Group";
                Importance=Additional;
                ShowMandatory=TRUE }

    { 47  ;2   ;Group     ;
                CaptionML=[ENU=Foreign Trade;
                           RUS=Внешняя торговля];
                GroupType=Group }

    { 52  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the currency code that is inserted by default when you create purchase documents or journal lines for the vendor.;
                           RUS=Определяет код валюты, который по умолчанию подставляется при создании документов покупки или строк журнала для поставщика.];
                ApplicationArea=#Suite;
                SourceExpr="Currency Code";
                Importance=Additional }

    { 1903289601;1;Group  ;
                CaptionML=[ENU=Customer;
                           RUS=Клиент] }

    { 1470008;2;Field     ;
                ToolTipML=[ENU=Specifies the customer number associated with the vendor.;
                           RUS=Определяет номер клиента, связанный с поставщиком.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Customer No.";
                OnValidate=BEGIN
                             CustomerNoOnAfterValidate;
                           END;
                            }

    { 1470010;2;Field     ;
                Name=CustomerName;
                ToolTipML=[ENU=Specifies the customer name associated with the vendor.;
                           RUS=Определяет имя клиента, связанное с поставщиком.];
                ApplicationArea=#All;
                SourceExpr="Customer Name";
                Visible=CustomerNameVisible }

    { 1470012;2;Field     ;
                Name=CustomerBalance;
                CaptionML=[ENU=Customer Balance (LCY);
                           RUS=Баланс клиента (руб.)];
                ApplicationArea=#All;
                SourceExpr=Cust."Balance (LCY)";
                Visible=CustomerBalanceVisible;
                Editable=FALSE }

    { 1470015;2;Field     ;
                Name=TotalBalance;
                CaptionML=[ENU=Total Balance (LCY);
                           RUS=Общее сальдо (руб.)];
                ApplicationArea=#All;
                SourceExpr=Cust."Balance (LCY)" - "Balance (LCY)";
                Visible=TotalBalanceVisible;
                Editable=FALSE }

    { 1905596001;1;Group  ;
                CaptionML=[ENU=Agreements;
                           RUS=Договоры] }

    { 1210006;2;Field     ;
                ToolTipML=[ENU=Specifies the agreement posting associated with the vendor.;
                           RUS=Определяет учет договоров, связанный с поставщиком.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Agreement Posting" }

    { 1210000;2;Field     ;
                ToolTipML=[ENU=Specifies the agreement number associated with the vendor.;
                           RUS=Определяет номер соглашения, связанный с поставщиком.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Agreement Nos." }

    { 1902930801;1;Group  ;
                CaptionML=[ENU=VAT Agent;
                           RUS=Налоговый агент] }

    { 1210004;2;Field     ;
                ToolTipML=[ENU=Specifies the VAT agent associated with the vendor.;
                           RUS=Определяет налогового агента, связанного с поставщиком.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Agent" }

    { 1210012;2;Field     ;
                ToolTipML=[ENU=Specifies the VAT agent type associated with the vendor.;
                           RUS=Определяет тип налогового агента, связанный с поставщиком.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Agent Type" }

    { 1210010;2;Field     ;
                ToolTipML=[ENU=Specifies the VAT payment source type associated with the vendor.;
                           RUS=Определяет тип источника оплаты НДС, связанный с поставщиком.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Payment Source Type" }

    { 1210008;2;Field     ;
                ToolTipML=[ENU=Specifies the VAT agent product posting group associated with the vendor.;
                           RUS=Определяет товарную группу налогового агента, связанную с поставщиком.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="VAT Agent Prod. Posting Group" }

    { 1210014;2;Field     ;
                ToolTipML=[ENU=Specifies the tax authority number associated with the vendor.;
                           RUS=Определяет номер налогового органа, связанный с поставщиком.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Tax Authority No.";
                LookupPageID=Tax Authorities }

    { 1901677601;1;Group  ;
                CaptionML=[ENU=Payments;
                           RUS=Платежи] }

    { 36  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how to apply payments to entries for this vendor.;
                           RUS=Определяет порядок применения платежей к операциям этого поставщика.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Application Method" }

    { 38  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code that indicates the payment terms that the vendor usually requires.;
                           RUS=Определяет код, указывающий условия оплаты, которые обычно требует поставщик.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 40  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how the vendor requires you to submit payment, such as bank transfer or check.;
                           RUS=Определяет требуемый способ отправки платежа поставщику: например, с помощью банковского перевода или чека.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Payment Method Code";
                Importance=Promoted }

    { 42  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the importance of the vendor when suggesting payments using the Suggest Vendor Payments function.;
                           RUS=Определяет степень важности поставщика при предложении платежей с помощью функции "Предлож. оплаты поставщикам".];
                ApplicationArea=#Basic,#Suite;
                SourceExpr=Priority }

    { 119 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the vendor allows payment tolerance.;
                           RUS=Определяет, допустимо для поставщика отклонение в оплате.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Block Payment Tolerance";
                OnValidate=BEGIN
                             IF "Block Payment Tolerance" THEN BEGIN
                               IF CONFIRM(Text002,FALSE) THEN
                                 PaymentToleranceMgt.DelTolVendLedgEntry(Rec);
                             END ELSE BEGIN
                               IF CONFIRM(Text001,FALSE) THEN
                                 PaymentToleranceMgt.CalcTolVendLedgEntry(Rec);
                             END;
                           END;
                            }

    { 9   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the vendor bank account that will be used by default on payment journal lines for export to a payment bank file.;
                           RUS=Определяет банковский счет поставщика, который будет использоваться по умолчанию в строках журнала платежей для экспорта в файл банковских платежей.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Preferred Bank Account Code" }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies if the vendor is a person or a company.;
                           RUS=Определяет, является поставщик физическим лицом или организацией.];
                SourceExpr="Partner Type" }

    { 3   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a payment term that will be used for calculating cash flow.;
                           RUS=Определяет условия оплаты для расчета движения денежных средств.];
                SourceExpr="Cash Flow Payment Terms Code" }

    { 1470006;2;Field     ;
                ToolTipML=[ENU=Specifies the default bank code associated with the vendor.;
                           RUS=Определяет код банка по умолчанию, который связан с поставщиком.];
                ApplicationArea=#Basic,#Suite;
                SourceExpr="Default Bank Code" }

    { 13  ;2   ;Field     ;
                ToolTipML=[ENU=Identifies the vendor who sent the purchase invoice.;
                           RUS=Идентифицирует поставщика, который отправил счет покупки.];
                SourceExpr="Creditor No." }

    { 1901075901;1;Group  ;
                CaptionML=[ENU=Receiving;
                           RUS=Получение] }

    { 100 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the warehouse location where items from the vendor must be received by default.;
                           RUS=Определяет склад, на который должны по умолчанию поступать товары от поставщика.];
                SourceExpr="Location Code";
                Importance=Promoted }

    { 28  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how the vendor must ship items to you.;
                           RUS=Определяет способ, которым поставщик должен доставлять вам товары.];
                SourceExpr="Shipment Method Code";
                Importance=Promoted }

    { 96  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a date formula for the time that it takes to replenish the item.;
                           RUS=Определяет формулу даты для расчета времени, необходимого для пополнения товара.];
                SourceExpr="Lead Time Calculation";
                Importance=Promoted }

    { 112 ;2   ;Field     ;
                DrillDown=No;
                ToolTipML=[ENU=Specifies the code for the vendor's customized calendar.;
                           RUS=Определяет код настроенного календаря поставщика.];
                SourceExpr="Base Calendar Code" }

    { 121 ;2   ;Field     ;
                Name=Customized Calendar;
                CaptionML=[ENU=Customized Calendar;
                           RUS=Настроенный календарь];
                ToolTipML=[ENU=Specifies if you have set up a customized calendar for the vendor.;
                           RUS=Определяет наличие настроенного календаря поставщика.];
                SourceExpr=CalendarMgmt.CustomizedCalendarExistText(CustomizedCalendar."Source Type"::Vendor,"No.",'',"Base Calendar Code");
                Editable=FALSE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD;
                              TESTFIELD("Base Calendar Code");
                              CalendarMgmt.ShowCustomizedCalendar(CustomizedCalEntry."Source Type"::Vendor,"No.",'',"Base Calendar Code");
                            END;
                             }

    { 1101495011;1;Group  ;
                CaptionML=[ENU=Specific;
                           RUS=Специфика];
                GroupType=Group }

    { 1101495012;2;Field  ;
                SourceExpr="CH Counterparty Type" }

    { 1101495013;2;Field  ;
                SourceExpr="Group No." }

    { 1101495014;2;Field  ;
                SourceExpr="Number of Employees" }

    { 1101495015;2;Field  ;
                SourceExpr="NOGA code" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 82  ;1   ;Part      ;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page786;
                Visible=NOT IsOfficeAddin;
                PartType=Page }

    { 1904651607;1;Part   ;
                Name=VendorStatisticsFactBox;
                ApplicationArea=#All;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9094;
                PartType=Page }

    { 53  ;1   ;Part      ;
                Name=AgedAccPayableChart;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page769;
                Visible=IsOfficeAddin;
                PartType=Page }

    { 17  ;1   ;Part      ;
                ApplicationArea=#All;
                SubPageLink=Source Type=CONST(Vendor),
                            Source No.=FIELD(No.);
                PagePartID=Page875;
                Visible=SocialListeningVisible;
                PartType=Page }

    { 19  ;1   ;Part      ;
                ApplicationArea=#All;
                SubPageLink=Source Type=CONST(Vendor),
                            Source No.=FIELD(No.);
                PagePartID=Page876;
                Visible=SocialListeningSetupVisible;
                PartType=Page;
                UpdatePropagation=Both }

    { 1903435607;1;Part   ;
                Name=VendorHistBuyFromFactBox;
                ApplicationArea=#Basic,#Suite;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9095;
                PartType=Page }

    { 1906949207;1;Part   ;
                Name=VendorHistPayToFactBox;
                ApplicationArea=#All;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 41  ;1   ;Part      ;
                Name=WorkflowStatus;
                ApplicationArea=#All;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1900383207;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      CustomizedCalEntry@1003 : Record 7603;
      CustomizedCalendar@1001 : Record 7602;
      Cust@1470000 : Record 18;
      OfficeMgt@1015 : Codeunit 1630;
      CalendarMgmt@1000 : Codeunit 7600;
      PaymentToleranceMgt@1002 : Codeunit 426;
      ApprovalsMgmt@1010 : Codeunit 1535;
      Text001@1005 : TextConst 'ENU=Do you want to allow payment tolerance for entries that are currently open?;RUS=Разрешить отклонения в оплате для открытых на данный момент операций?';
      Text002@1004 : TextConst 'ENU=Do you want to remove payment tolerance from entries that are currently open?;RUS=Удалить отклонения в оплате из открытых на данный момент операций?';
      CustomerNameVisible@19071882 : Boolean INDATASET;
      CustomerBalanceVisible@19048469 : Boolean INDATASET;
      TotalBalanceVisible@19063333 : Boolean INDATASET;
      ContactEditable@19051436 : Boolean INDATASET;
      SocialListeningSetupVisible@1007 : Boolean INDATASET;
      SocialListeningVisible@1006 : Boolean INDATASET;
      OpenApprovalEntriesExistCurrUser@1009 : Boolean;
      OpenApprovalEntriesExist@1008 : Boolean;
      ShowWorkflowStatus@1011 : Boolean;
      ShowMapLbl@1014 : TextConst 'ENU=Show on Map;RUS=Показать на карте';
      IsOfficeAddin@1012 : Boolean;
      CanCancelApprovalForRecord@1013 : Boolean;
      SendToOCREnabled@1016 : Boolean;
      SendToOCRVisible@1017 : Boolean;
      SendToIncomingDocEnabled@1018 : Boolean;
      SendIncomingDocApprovalRequestVisible@1019 : Boolean;
      SendToIncomingDocumentVisible@1020 : Boolean;
      NoFieldVisible@1021 : Boolean;
      NewMode@1022 : Boolean;
      ICCounterparty@1101495001 : Code[20];
      ICCounterpartyEditable@1101495000 : Boolean INDATASET;
      Text50001@1101495002 : TextConst 'ENU=Not found Default Dimension %1;RUS=Не найдено стандартное измерение %1';
      g_recUserSetup@1101495003 : Record 91;
      Text50003@1101495004 : TextConst 'ENU=You have no permission to edit IC Code. Check User Setup.;RUS=У вас нет разрешения редактировать Код Группы Контрагента. Проверьте Пользователь Настройка, поле %1';

    LOCAL PROCEDURE ActivateFields@3();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
    BEGIN
      SetSocialListeningFactboxVisibility;
      NoFieldVisible := DocumentNoVisibility.VendorNoIsVisible;
      ContactEditable := "Primary Contact No." = '';
      CustomerNameVisible := "Customer No." <> '';
      CustomerBalanceVisible := "Customer No." <> '';
      TotalBalanceVisible := "Customer No." <> '';

      CLEAR(Cust);
      IF Cust.GET("Customer No.") THEN
        Cust.CALCFIELDS("Balance (LCY)");

      IF OfficeMgt.IsAvailable THEN
        ActivateIncomingDocumentsFields;

      //NC MDB05.1 > DP
      ICCounterparty := GetICCode;
      //NC MDB05.1 < DP
    END;

    LOCAL PROCEDURE ContactOnAfterValidate@19013243();
    BEGIN
      ActivateFields;
    END;

    LOCAL PROCEDURE CustomerNoOnAfterValidate@19016267();
    BEGIN
      ActivateFields;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SetSocialListeningFactboxVisibility@1();
    VAR
      SocialListeningMgt@1000 : Codeunit 871;
    BEGIN
      SocialListeningMgt.GetVendFactboxVisibility(Rec,SocialListeningSetupVisible,SocialListeningVisible);
    END;

    LOCAL PROCEDURE SetVendorNoVisibilityOnFactBoxes@2();
    BEGIN
      CurrPage.VendorHistBuyFromFactBox.PAGE.SetVendorNoVisibility(FALSE);
      CurrPage.VendorHistPayToFactBox.PAGE.SetVendorNoVisibility(FALSE);
      CurrPage.VendorStatisticsFactBox.PAGE.SetVendorNoVisibility(FALSE);
    END;

    LOCAL PROCEDURE RunReport@4(ReportNumber@1000 : Integer);
    VAR
      Vendor@1001 : Record 23;
    BEGIN
      Vendor.SETRANGE("No.","No.");
      REPORT.RUNMODAL(ReportNumber,TRUE,TRUE,Vendor);
    END;

    LOCAL PROCEDURE ActivateIncomingDocumentsFields@11();
    VAR
      IncomingDocument@1001 : Record 130;
    BEGIN
      IF OfficeMgt.OCRAvailable THEN BEGIN
        SendToIncomingDocumentVisible := TRUE;
        SendToIncomingDocEnabled := OfficeMgt.EmailHasAttachments;
        SendToOCREnabled := OfficeMgt.EmailHasAttachments;
        SendToOCRVisible := IncomingDocument.OCRIsEnabled AND NOT IsIncomingDocApprovalsWorkflowEnabled;
        SendIncomingDocApprovalRequestVisible := IsIncomingDocApprovalsWorkflowEnabled;
      END;
    END;

    LOCAL PROCEDURE IsIncomingDocApprovalsWorkflowEnabled@30() : Boolean;
    VAR
      WorkflowEventHandling@1000 : Codeunit 1520;
      WorkflowDefinition@1005 : Query 1502;
    BEGIN
      WorkflowDefinition.SETRANGE(Table_ID,DATABASE::"Incoming Document");
      WorkflowDefinition.SETRANGE(Entry_Point,TRUE);
      WorkflowDefinition.SETRANGE(Enabled,TRUE);
      WorkflowDefinition.SETRANGE(Type,WorkflowDefinition.Type::"Event");
      WorkflowDefinition.SETRANGE(Function_Name,WorkflowEventHandling.RunWorkflowOnSendIncomingDocForApprovalCode);
      WorkflowDefinition.OPEN;
      WHILE WorkflowDefinition.READ DO
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE CreateVendorFromTemplate@10();
    VAR
      MiniVendorTemplate@1001 : Record 1303;
      Vendor@1000 : Record 23;
    BEGIN
      IF NewMode THEN BEGIN
        IF MiniVendorTemplate.NewVendorFromTemplate(Vendor) THEN BEGIN
          COPY(Vendor);
          CurrPage.UPDATE;
        END;
        NewMode := FALSE;
      END;
    END;

    PROCEDURE GetICCode@1000000000() : Code[20];
    VAR
      MovingDataSetup@1101495004 : Record 50064;
      ConsSetup@1101495003 : Record 50000;
      DimValue@1101495002 : Record 349;
      LinkedDim@1101495001 : Record 50016;
      DefDim@1101495005 : Record 352;
      ICCode@1101495000 : Code[20];
    BEGIN
      //NC MDB05.1 > DP
      ICCode :='';
      MovingDataSetup.GET;
      MovingDataSetup.TESTFIELD("Customer Dimension Code");
      ConsSetup.GET;
      ConsSetup.TESTFIELD("IC Dimension Code");

      //для оффшорных компаний через Станд. Измерения

      DefDim.RESET;
      DefDim.SETRANGE("Table ID",23);
      DefDim.SETRANGE("No.","No.");
      DefDim.SETRANGE("Dimension Code",MovingDataSetup."Customer Dimension Code");
      IF DefDim.FINDFIRST THEN BEGIN
        LinkedDim.RESET;
        LinkedDim.SETRANGE("Dimension Code",DefDim."Dimension Code");
        LinkedDim.SETRANGE("Dimension Value",DefDim."Dimension Value Code");
        LinkedDim.SETRANGE("Linked Dimension Code",ConsSetup."IC Dimension Code");
        IF LinkedDim.FINDFIRST THEN
          ICCode := LinkedDim."Linked Dimension Value";

      END;
      EXIT(ICCode);
      //NC MDB05.1 < DP
    END;

    PROCEDURE SetICCode@1000000001();
    VAR
      MovingDataSetup@1101495004 : Record 50064;
      ConsSetup@1101495003 : Record 50000;
      DimValue@1101495002 : Record 349;
      LinkedDim@1101495001 : Record 50016;
      DefDim@1101495000 : Record 352;
    BEGIN
      //NC MDB05.1 > DP
      MovingDataSetup.GET;
      MovingDataSetup.TESTFIELD("Customer Dimension Code");
      ConsSetup.GET;
      ConsSetup.TESTFIELD("IC Dimension Code");
      IF ICCounterparty<>'' THEN BEGIN
        //для оффшорных компаний через Станд. Измерения

        DefDim.RESET;
        DefDim.SETRANGE("Table ID",23);
        DefDim.SETRANGE("No.","No.");
        DefDim.SETRANGE("Dimension Code",MovingDataSetup."Customer Dimension Code");
        IF DefDim.FINDFIRST THEN BEGIN
          LinkedDim.RESET;
          LinkedDim.SETRANGE("Dimension Code",DefDim."Dimension Code");
          LinkedDim.SETRANGE("Dimension Value",DefDim."Dimension Value Code");
          LinkedDim.SETRANGE("Linked Dimension Code",ConsSetup."IC Dimension Code");
          IF NOT LinkedDim.FINDFIRST THEN BEGIN
            LinkedDim.INIT;
            LinkedDim."Dimension Code" :=DefDim."Dimension Code";
            LinkedDim."Dimension Value" := DefDim."Dimension Value Code";
            LinkedDim."Linked Dimension Code" :=ConsSetup."IC Dimension Code";
            LinkedDim."Linked Dimension Value" :=ICCounterparty;
            LinkedDim.INSERT;
          END ELSE BEGIN
            LinkedDim."Linked Dimension Value" :=ICCounterparty;
            LinkedDim.MODIFY;
          END;
        END ELSE
          ERROR(Text50001,MovingDataSetup."Customer Dimension Code");

      END ELSE BEGIN
        //для оффшорных компаний через Станд. Измерения

        DefDim.RESET;
        DefDim.SETRANGE("Table ID",23);
        DefDim.SETRANGE("No.","No.");
        DefDim.SETRANGE("Dimension Code",MovingDataSetup."Customer Dimension Code");
        IF DefDim.FINDFIRST THEN BEGIN
          LinkedDim.RESET;
          LinkedDim.SETRANGE("Dimension Code",DefDim."Dimension Code");
          LinkedDim.SETRANGE("Dimension Value",DefDim."Dimension Value Code");
          LinkedDim.SETRANGE("Linked Dimension Code",ConsSetup."IC Dimension Code");
          IF LinkedDim.FINDFIRST THEN
            LinkedDim.DELETE;
        END ELSE
          ERROR(Text50001,MovingDataSetup."Customer Dimension Code");
      END;
      //NC MDB05.1 < DP
    END;

    BEGIN
    {
      NC TR177 DP Функции установки и просмотра статуса блокировки
      NC NCS-660 RD Вынесено поле "Related Counterparty Type Code"
      NC S1883 PCH Добавлено поле Segment Code, пункт меню "Change Segment"
      NC S1881 SPA Новая вкладка "Specific"
                   Выведены поля "CH Counterparty Code", "Group No.", "Number of Employees"
      NC NCS-1881 PCH Добавлено поле NOGA Code
      TDRANCS-2308 added field Resident/Non-resident on tab General
      TDRANCS-2273 Modified Relationship to the Group - OnValidate(),ICCounterparty - OnValidate()
      -----------------------------------
      NC NOS-26 SPA Миграция кода на новую функциональность
    }
    END.
  }
}

